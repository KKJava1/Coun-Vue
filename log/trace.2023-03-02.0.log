2023-03-02 14:57:58.564 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2023-03-02 14:57:58.581 INFO  com.jiawa.wiki.WikiApplication             :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_271 on LAPTOP-TLCI2GAA with PID 15796 (D:\work\jiawawiki\target\classes started by k in D:\work\jiawawiki)
2023-03-02 14:57:58.581 INFO  com.jiawa.wiki.WikiApplication             :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2023-03-02 14:57:58.660 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2023-03-02 14:57:58.661 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2023-03-02 14:57:59.339 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2023-03-02 14:57:59.341 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2023-03-02 14:57:59.357 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2023-03-02 14:57:59.525 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.apache.rocketmq.spring.autoconfigure.RocketMQAutoConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQAutoConfiguration$$EnhancerBySpringCGLIB$$80980612] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:57:59.533 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.016 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'defaultMQProducer' of type [org.apache.rocketmq.client.producer.DefaultMQProducer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.018 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonConfig' of type [com.jiawa.wiki.config.JacksonConfig$$EnhancerBySpringCGLIB$$22d27b13] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.019 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.022 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.025 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties' of type [org.springframework.boot.autoconfigure.jackson.JacksonProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.026 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'standardJacksonObjectMapperBuilderCustomizer' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration$StandardJackson2ObjectMapperBuilderCustomizer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.028 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.030 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'parameterNamesModule' of type [com.fasterxml.jackson.module.paramnames.ParameterNamesModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.031 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.048 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jsonComponentModule' of type [org.springframework.boot.jackson.JsonComponentModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.048 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.data.web.config.SpringDataJacksonConfiguration' of type [org.springframework.data.web.config.SpringDataJacksonConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.052 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonGeoModule' of type [org.springframework.data.geo.GeoModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.054 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonObjectMapperBuilder' of type [org.springframework.http.converter.json.Jackson2ObjectMapperBuilder] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:00.068 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonObjectMapper' of type [com.fasterxml.jackson.databind.ObjectMapper] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:01.446 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'rocketMQTemplate' of type [org.apache.rocketmq.spring.core.RocketMQTemplate] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:01.448 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'transactionHandlerRegistry' of type [org.apache.rocketmq.spring.config.TransactionHandlerRegistry] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-02 14:58:01.930 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2023-03-02 14:58:01.936 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2023-03-02 14:58:01.936 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2023-03-02 14:58:01.936 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2023-03-02 14:58:02.022 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2023-03-02 14:58:02.022 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 3360 ms
2023-03-02 14:58:02.794 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2023-03-02 14:58:03.119 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2023-03-02 14:58:03.161 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2023-03-02 14:58:03.699 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:03.707 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:05.739 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:07.800 INFO  o.a.r.s.support.DefaultRocketMQListenerContainer  :243  [32m                  [0;39m running container: DefaultRocketMQListenerContainer{consumerGroup='default', nameServer='127.0.0.1:9876', topic='VOTE_TOPIC', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING}
2023-03-02 14:58:07.800 INFO  o.a.r.s.a.ListenerContainerConfiguration          :107  [32m                  [0;39m Register the listener to container, listenerBeanName:voteTopicConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2023-03-02 14:58:07.801 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:07.811 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2023-03-02 14:58:07.827 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2023-03-02 14:58:07.846 INFO  com.jiawa.wiki.WikiApplication             :61   [32m                  [0;39m Started WikiApplication in 9.797 seconds (JVM running for 10.971)
2023-03-02 14:58:07.849 INFO  com.jiawa.wiki.WikiApplication             :26   [32m                  [0;39m å¯åŠ¨æˆåŠŸï¼ï¼
2023-03-02 14:58:07.850 INFO  com.jiawa.wiki.WikiApplication             :27   [32m                  [0;39m åœ°å€: 	http://127.0.0.1:8880
2023-03-02 14:58:11.840 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:32.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:33.518 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:58:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12146808188964864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 14:58:35.034 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m12146808188964864 [0;39m HikariPool-1 - Starting...
2023-03-02 14:58:35.138 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m12146808188964864 [0;39m HikariPool-1 - Start completed.
2023-03-02 14:58:35.143 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12146808188964864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 14:58:35.157 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12146808188964864 [0;39m ==> Parameters:
2023-03-02 14:58:35.159 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12146808188964864 [0;39m <==    Updates: 1
2023-03-02 14:58:35.161 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12146808188964864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š155æ¯«ç§’
2023-03-02 14:58:39.094 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12146913059147776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 14:59:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12146913059147776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 14:59:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12146913059147776 [0;39m ==> Parameters:
2023-03-02 14:59:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12146913059147776 [0;39m <==    Updates: 5
2023-03-02 14:59:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12146913059147776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-02 14:59:01.165 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:03.208 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:03.520 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12146934055833600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 14:59:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12146934055833600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 14:59:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12146934055833600 [0;39m ==> Parameters:
2023-03-02 14:59:05.025 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12146934055833600 [0;39m <==    Updates: 1
2023-03-02 14:59:05.026 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12146934055833600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 14:59:05.265 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:07.312 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:09.342 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:25.280 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:27.323 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:32.956 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147059838816256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 14:59:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147059838816256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 14:59:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147059838816256 [0;39m ==> Parameters:
2023-03-02 14:59:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147059838816256 [0;39m <==    Updates: 1
2023-03-02 14:59:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147059838816256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 14:59:37.033 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:49.387 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 14:59:51.431 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12147164696416256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:00:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147164696416256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:00:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147164696416256 [0;39m ==> Parameters:
2023-03-02 15:00:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147164696416256 [0;39m <==    Updates: 0
2023-03-02 15:00:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12147164696416256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:00:02.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:03.498 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147185688907776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:00:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147185688907776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:00:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147185688907776 [0;39m ==> Parameters:
2023-03-02 15:00:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147185688907776 [0;39m <==    Updates: 1
2023-03-02 15:00:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147185688907776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:00:07.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:13.457 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:15.504 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:33.765 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147311505444864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:00:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147311505444864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:00:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147311505444864 [0;39m ==> Parameters:
2023-03-02 15:00:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147311505444864 [0;39m <==    Updates: 1
2023-03-02 15:00:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147311505444864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:00:38.347 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:40.743 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:00:42.784 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12147416413376512 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:01:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147416413376512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:01:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147416413376512 [0;39m ==> Parameters:
2023-03-02 15:01:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147416413376512 [0;39m <==    Updates: 0
2023-03-02 15:01:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12147416413376512 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 15:01:03.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147437368119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:01:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147437368119296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:01:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147437368119296 [0;39m ==> Parameters:
2023-03-02 15:01:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147437368119296 [0;39m <==    Updates: 1
2023-03-02 15:01:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147437368119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:01:05.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:07.972 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:10.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:33.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:34.128 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147563142713344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:01:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147563142713344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:01:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147563142713344 [0;39m ==> Parameters:
2023-03-02 15:01:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147563142713344 [0;39m <==    Updates: 1
2023-03-02 15:01:35.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147563142713344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:01:36.190 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:38.233 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:56.193 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:01:58.238 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12147668063227904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:02:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147668063227904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:02:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147668063227904 [0;39m ==> Parameters:
2023-03-02 15:02:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147668063227904 [0;39m <==    Updates: 0
2023-03-02 15:02:00.027 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12147668063227904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:02:02.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:03.516 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147689005387776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:02:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147689005387776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:02:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147689005387776 [0;39m ==> Parameters:
2023-03-02 15:02:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147689005387776 [0;39m <==    Updates: 1
2023-03-02 15:02:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147689005387776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:02:07.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:20.298 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:22.331 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:32.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:33.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147814855479296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:02:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147814855479296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:02:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147814855479296 [0;39m ==> Parameters:
2023-03-02 15:02:35.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147814855479296 [0;39m <==    Updates: 1
2023-03-02 15:02:35.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147814855479296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:02:37.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:44.382 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:02:46.413 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12147919696302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:03:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147919696302080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:03:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147919696302080 [0;39m ==> Parameters:
2023-03-02 15:03:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12147919696302080 [0;39m <==    Updates: 0
2023-03-02 15:03:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12147919696302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:03:02.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:03.489 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12147940684599296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:03:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147940684599296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:03:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147940684599296 [0;39m ==> Parameters:
2023-03-02 15:03:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12147940684599296 [0;39m <==    Updates: 1
2023-03-02 15:03:05.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12147940684599296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:03:07.024 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:09.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:11.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:33.515 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:34.982 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148066505330688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:03:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148066505330688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:03:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148066505330688 [0;39m ==> Parameters:
2023-03-02 15:03:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148066505330688 [0;39m <==    Updates: 1
2023-03-02 15:03:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148066505330688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:03:37.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:03:39.098 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12148171367124992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:04:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148171367124992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:04:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148171367124992 [0;39m ==> Parameters:
2023-03-02 15:04:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148171367124992 [0;39m <==    Updates: 0
2023-03-02 15:04:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12148171367124992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:04:01.150 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:03.184 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:03.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148192338644992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:04:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148192338644992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:04:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148192338644992 [0;39m ==> Parameters:
2023-03-02 15:04:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148192338644992 [0;39m <==    Updates: 1
2023-03-02 15:04:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148192338644992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:04:05.230 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:07.265 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:09.293 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:25.233 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:27.254 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:32.951 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:33.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148318134210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:04:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148318134210560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:04:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148318134210560 [0;39m ==> Parameters:
2023-03-02 15:04:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148318134210560 [0;39m <==    Updates: 1
2023-03-02 15:04:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148318134210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:04:37.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:04:51.313 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12148423029559296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:05:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148423029559296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:05:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148423029559296 [0;39m ==> Parameters:
2023-03-02 15:05:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148423029559296 [0;39m <==    Updates: 0
2023-03-02 15:05:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12148423029559296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:05:02.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:03.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:04.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148443992690688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:05:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148443992690688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:05:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148443992690688 [0;39m ==> Parameters:
2023-03-02 15:05:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148443992690688 [0;39m <==    Updates: 1
2023-03-02 15:05:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148443992690688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:05:07.013 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:13.387 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:15.419 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:32.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:33.497 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148569821810688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:05:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148569821810688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:05:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148569821810688 [0;39m ==> Parameters:
2023-03-02 15:05:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148569821810688 [0;39m <==    Updates: 1
2023-03-02 15:05:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148569821810688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:05:37.045 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:05:41.119 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12148674654244864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:06:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148674654244864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:06:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148674654244864 [0;39m ==> Parameters:
2023-03-02 15:06:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148674654244864 [0;39m <==    Updates: 0
2023-03-02 15:06:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12148674654244864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:06:02.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:03.517 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148695608987648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:06:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148695608987648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:06:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148695608987648 [0;39m ==> Parameters:
2023-03-02 15:06:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148695608987648 [0;39m <==    Updates: 1
2023-03-02 15:06:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148695608987648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:06:07.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:09.075 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:33.168 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:33.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148821454884864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:06:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148821454884864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:06:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148821454884864 [0;39m ==> Parameters:
2023-03-02 15:06:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148821454884864 [0;39m <==    Updates: 1
2023-03-02 15:06:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148821454884864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:06:35.224 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:37.254 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:39.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:55.213 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:06:57.242 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12148926291513344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:07:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148926291513344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:07:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148926291513344 [0;39m ==> Parameters:
2023-03-02 15:07:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12148926291513344 [0;39m <==    Updates: 0
2023-03-02 15:07:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12148926291513344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:07:03.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:04.984 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12148947321753600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:07:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148947321753600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:07:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148947321753600 [0;39m ==> Parameters:
2023-03-02 15:07:05.028 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12148947321753600 [0;39m <==    Updates: 1
2023-03-02 15:07:05.028 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12148947321753600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-02 15:07:07.016 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:19.275 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:21.309 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:32.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:33.500 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149073138290688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:07:35.013 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149073138290688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:07:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149073138290688 [0;39m ==> Parameters:
2023-03-02 15:07:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149073138290688 [0;39m <==    Updates: 1
2023-03-02 15:07:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149073138290688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:07:37.047 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:43.357 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:07:45.384 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12149177962336256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:08:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149177962336256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:08:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149177962336256 [0;39m ==> Parameters:
2023-03-02 15:08:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149177962336256 [0;39m <==    Updates: 0
2023-03-02 15:08:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12149177962336256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:08:02.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:03.531 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149198942244864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:08:05.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149198942244864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:08:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149198942244864 [0;39m ==> Parameters:
2023-03-02 15:08:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149198942244864 [0;39m <==    Updates: 1
2023-03-02 15:08:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149198942244864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:08:07.050 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:09.082 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:11.127 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:32.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:33.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149324750393344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:08:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149324750393344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:08:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149324750393344 [0;39m ==> Parameters:
2023-03-02 15:08:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149324750393344 [0;39m <==    Updates: 1
2023-03-02 15:08:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149324750393344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:08:37.018 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:08:39.080 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12149429666713600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:09:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149429666713600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:09:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149429666713600 [0;39m ==> Parameters:
2023-03-02 15:09:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149429666713600 [0;39m <==    Updates: 0
2023-03-02 15:09:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12149429666713600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:09:01.127 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:03.186 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:03.515 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149450621456384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:09:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149450621456384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:09:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149450621456384 [0;39m ==> Parameters:
2023-03-02 15:09:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149450621456384 [0;39m <==    Updates: 1
2023-03-02 15:09:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149450621456384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:09:05.200 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:07.225 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:09.272 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:25.235 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:27.293 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:32.942 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:33.505 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149576412827648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:09:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149576412827648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:09:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149576412827648 [0;39m ==> Parameters:
2023-03-02 15:09:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149576412827648 [0;39m <==    Updates: 1
2023-03-02 15:09:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149576412827648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:09:37.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:49.353 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:09:51.401 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12149681324953600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:10:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149681324953600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:10:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149681324953600 [0;39m ==> Parameters:
2023-03-02 15:10:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149681324953600 [0;39m <==    Updates: 0
2023-03-02 15:10:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12149681324953600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:10:02.953 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:03.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:04.983 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149702292279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:10:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149702292279296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:10:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149702292279296 [0;39m ==> Parameters:
2023-03-02 15:10:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149702292279296 [0;39m <==    Updates: 1
2023-03-02 15:10:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149702292279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:10:07.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:13.451 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:15.474 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:32.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:33.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:34.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149828096233472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:10:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149828096233472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:10:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149828096233472 [0;39m ==> Parameters:
2023-03-02 15:10:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149828096233472 [0;39m <==    Updates: 1
2023-03-02 15:10:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149828096233472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:10:37.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:39.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:10:41.107 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12149932966416384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:11:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149932966416384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:11:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149932966416384 [0;39m ==> Parameters:
2023-03-02 15:11:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12149932966416384 [0;39m <==    Updates: 0
2023-03-02 15:11:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12149932966416384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:11:03.507 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12149953954713600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:11:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149953954713600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:11:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149953954713600 [0;39m ==> Parameters:
2023-03-02 15:11:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12149953954713600 [0;39m <==    Updates: 1
2023-03-02 15:11:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12149953954713600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:11:07.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:09.071 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:31.105 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:33.151 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:33.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150079762862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:11:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150079762862080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:11:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150079762862080 [0;39m ==> Parameters:
2023-03-02 15:11:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150079762862080 [0;39m <==    Updates: 1
2023-03-02 15:11:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150079762862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:11:35.183 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:37.231 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:39.261 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:11:57.226 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12150184595296256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:12:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150184595296256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:12:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150184595296256 [0;39m ==> Parameters:
2023-03-02 15:12:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150184595296256 [0;39m <==    Updates: 0
2023-03-02 15:12:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12150184595296256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:12:02.968 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:03.516 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150205600370688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:12:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150205600370688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:12:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150205600370688 [0;39m ==> Parameters:
2023-03-02 15:12:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150205600370688 [0;39m <==    Updates: 1
2023-03-02 15:12:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150205600370688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:12:05.027 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:07.071 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:19.291 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:21.329 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:32.918 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:33.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:34.952 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150331437879296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:12:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150331437879296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:12:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150331437879296 [0;39m ==> Parameters:
2023-03-02 15:12:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150331437879296 [0;39m <==    Updates: 1
2023-03-02 15:12:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150331437879296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:12:37.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:12:45.433 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12150436274507776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:13:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150436274507776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:13:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150436274507776 [0;39m ==> Parameters:
2023-03-02 15:13:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150436274507776 [0;39m <==    Updates: 0
2023-03-02 15:13:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12150436274507776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:13:03.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150457250222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:13:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150457250222080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:13:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150457250222080 [0;39m ==> Parameters:
2023-03-02 15:13:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150457250222080 [0;39m <==    Updates: 1
2023-03-02 15:13:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150457250222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:13:07.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:09.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:11.119 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:32.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:33.516 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150583096119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:13:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150583096119296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:13:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150583096119296 [0;39m ==> Parameters:
2023-03-02 15:13:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150583096119296 [0;39m <==    Updates: 1
2023-03-02 15:13:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150583096119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:13:37.045 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:13:39.087 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12150687903387648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:14:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150687903387648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:14:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150687903387648 [0;39m ==> Parameters:
2023-03-02 15:14:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150687903387648 [0;39m <==    Updates: 0
2023-03-02 15:14:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12150687903387648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:14:01.128 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:03.189 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:03.487 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150708883296256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:14:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150708883296256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:14:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150708883296256 [0;39m ==> Parameters:
2023-03-02 15:14:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150708883296256 [0;39m <==    Updates: 1
2023-03-02 15:14:05.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150708883296256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:14:07.249 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:09.287 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:25.235 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:27.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:32.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:33.488 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:34.985 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150834758553600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:14:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150834758553600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:14:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150834758553600 [0;39m ==> Parameters:
2023-03-02 15:14:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150834758553600 [0;39m <==    Updates: 1
2023-03-02 15:14:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150834758553600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:14:37.028 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:49.322 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:14:51.339 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12150939607764992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:15:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150939607764992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:15:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150939607764992 [0;39m ==> Parameters:
2023-03-02 15:15:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12150939607764992 [0;39m <==    Updates: 0
2023-03-02 15:15:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12150939607764992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:15:02.938 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:03.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:04.973 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12150960537341952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:15:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150960537341952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:15:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150960537341952 [0;39m ==> Parameters:
2023-03-02 15:15:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12150960537341952 [0;39m <==    Updates: 1
2023-03-02 15:15:05.006 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12150960537341952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:15:07.018 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:13.401 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:15.449 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:32.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:33.521 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151086366461952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:15:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151086366461952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:15:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151086366461952 [0;39m ==> Parameters:
2023-03-02 15:15:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151086366461952 [0;39m <==    Updates: 1
2023-03-02 15:15:35.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151086366461952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 15:15:37.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:39.094 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:15:41.149 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12151191253422080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:16:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151191253422080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:16:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151191253422080 [0;39m ==> Parameters:
2023-03-02 15:16:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151191253422080 [0;39m <==    Updates: 0
2023-03-02 15:16:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12151191253422080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:16:02.950 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:03.484 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:04.974 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151212203970560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:16:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151212203970560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:16:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151212203970560 [0;39m ==> Parameters:
2023-03-02 15:16:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151212203970560 [0;39m <==    Updates: 1
2023-03-02 15:16:05.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151212203970560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:16:07.005 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:09.061 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:31.089 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:33.115 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:33.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151338070839296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:16:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151338070839296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:16:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151338070839296 [0;39m ==> Parameters:
2023-03-02 15:16:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151338070839296 [0;39m <==    Updates: 1
2023-03-02 15:16:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151338070839296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:16:37.161 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:39.226 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:16:57.201 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12151442928439296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:17:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151442928439296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:17:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151442928439296 [0;39m ==> Parameters:
2023-03-02 15:17:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151442928439296 [0;39m <==    Updates: 0
2023-03-02 15:17:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12151442928439296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:17:02.933 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:03.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:04.992 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151463874793472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:17:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151463874793472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:17:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151463874793472 [0;39m ==> Parameters:
2023-03-02 15:17:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151463874793472 [0;39m <==    Updates: 1
2023-03-02 15:17:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151463874793472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 15:17:07.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:19.231 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:21.264 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:32.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:33.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:34.983 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151589724884992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:17:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151589724884992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:17:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151589724884992 [0;39m ==> Parameters:
2023-03-02 15:17:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151589724884992 [0;39m <==    Updates: 1
2023-03-02 15:17:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151589724884992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:17:37.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:43.311 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:17:45.341 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12151694582484992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:18:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151694582484992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:18:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151694582484992 [0;39m ==> Parameters:
2023-03-02 15:18:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151694582484992 [0;39m <==    Updates: 0
2023-03-02 15:18:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12151694582484992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:18:02.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:03.520 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:04.985 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151715562393600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:18:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151715562393600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:18:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151715562393600 [0;39m ==> Parameters:
2023-03-02 15:18:05.024 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151715562393600 [0;39m <==    Updates: 1
2023-03-02 15:18:05.025 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151715562393600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:18:07.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:09.083 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:11.127 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:32.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:33.500 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:34.983 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151841378930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:18:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151841378930688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:18:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151841378930688 [0;39m ==> Parameters:
2023-03-02 15:18:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151841378930688 [0;39m <==    Updates: 1
2023-03-02 15:18:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151841378930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:18:37.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:18:39.087 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12151946240724992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:19:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151946240724992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:19:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151946240724992 [0;39m ==> Parameters:
2023-03-02 15:19:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12151946240724992 [0;39m <==    Updates: 0
2023-03-02 15:19:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12151946240724992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:19:01.137 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:03.195 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:03.523 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12151967178690560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:19:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151967178690560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:19:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151967178690560 [0;39m ==> Parameters:
2023-03-02 15:19:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12151967178690560 [0;39m <==    Updates: 1
2023-03-02 15:19:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12151967178690560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:19:05.241 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:07.276 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:09.317 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:25.257 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:27.314 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:32.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:33.519 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152092991033344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:19:35.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152092991033344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:19:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152092991033344 [0;39m ==> Parameters:
2023-03-02 15:19:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152092991033344 [0;39m <==    Updates: 1
2023-03-02 15:19:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152092991033344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:19:37.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:49.362 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:19:51.406 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12152197848633344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:20:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152197848633344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:20:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152197848633344 [0;39m ==> Parameters:
2023-03-02 15:20:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152197848633344 [0;39m <==    Updates: 0
2023-03-02 15:20:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12152197848633344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:20:02.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:03.507 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152218845319168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:20:05.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152218845319168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:20:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152218845319168 [0;39m ==> Parameters:
2023-03-02 15:20:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152218845319168 [0;39m <==    Updates: 1
2023-03-02 15:20:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152218845319168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:20:07.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:13.460 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:15.502 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:32.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:33.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152344657661952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:20:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152344657661952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:20:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152344657661952 [0;39m ==> Parameters:
2023-03-02 15:20:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152344657661952 [0;39m <==    Updates: 1
2023-03-02 15:20:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152344657661952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:20:35.018 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:37.071 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:39.114 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:20:41.145 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12152449561399296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:21:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152449561399296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:21:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152449561399296 [0;39m ==> Parameters:
2023-03-02 15:21:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152449561399296 [0;39m <==    Updates: 0
2023-03-02 15:21:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12152449561399296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:21:02.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:03.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152470499364864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:21:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152470499364864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:21:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152470499364864 [0;39m ==> Parameters:
2023-03-02 15:21:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152470499364864 [0;39m <==    Updates: 1
2023-03-02 15:21:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152470499364864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:21:05.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:07.068 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:09.116 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:33.187 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:33.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152596366233600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:21:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152596366233600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:21:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152596366233600 [0;39m ==> Parameters:
2023-03-02 15:21:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152596366233600 [0;39m <==    Updates: 1
2023-03-02 15:21:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152596366233600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 15:21:35.233 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:39.322 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:21:57.259 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12152701186084864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:22:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152701186084864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:22:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152701186084864 [0;39m ==> Parameters:
2023-03-02 15:22:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152701186084864 [0;39m <==    Updates: 0
2023-03-02 15:22:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12152701186084864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-02 15:22:02.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:03.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:04.996 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152722178576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:22:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152722178576384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:22:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152722178576384 [0;39m ==> Parameters:
2023-03-02 15:22:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152722178576384 [0;39m <==    Updates: 1
2023-03-02 15:22:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152722178576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:22:07.050 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:21.342 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:32.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:33.520 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152848007696384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:22:35.012 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152848007696384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:22:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152848007696384 [0;39m ==> Parameters:
2023-03-02 15:22:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152848007696384 [0;39m <==    Updates: 1
2023-03-02 15:22:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152848007696384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:22:37.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:43.408 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:22:45.467 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12152952873684992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:23:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152952873684992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:23:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152952873684992 [0;39m ==> Parameters:
2023-03-02 15:23:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12152952873684992 [0;39m <==    Updates: 0
2023-03-02 15:23:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12152952873684992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:23:02.931 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:03.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12152973811650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:23:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152973811650560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:23:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152973811650560 [0;39m ==> Parameters:
2023-03-02 15:23:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12152973811650560 [0;39m <==    Updates: 1
2023-03-02 15:23:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12152973811650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:23:07.028 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:09.085 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:11.123 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:32.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:33.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:34.988 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153099636576256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:23:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153099636576256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:23:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153099636576256 [0;39m ==> Parameters:
2023-03-02 15:23:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153099636576256 [0;39m <==    Updates: 1
2023-03-02 15:23:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153099636576256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 15:23:37.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:23:39.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12153204531924992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:24:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153204531924992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:24:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153204531924992 [0;39m ==> Parameters:
2023-03-02 15:24:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153204531924992 [0;39m <==    Updates: 0
2023-03-02 15:24:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12153204531924992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:24:01.105 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:03.122 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:03.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153225482473472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:24:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153225482473472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:24:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153225482473472 [0;39m ==> Parameters:
2023-03-02 15:24:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153225482473472 [0;39m <==    Updates: 1
2023-03-02 15:24:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153225482473472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:24:07.210 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:09.245 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:25.186 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:27.228 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:33.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:34.982 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153351332564992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:24:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153351332564992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:24:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153351332564992 [0;39m ==> Parameters:
2023-03-02 15:24:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153351332564992 [0;39m <==    Updates: 1
2023-03-02 15:24:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153351332564992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:24:37.016 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:49.285 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:24:51.331 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12153456156610560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:25:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153456156610560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:25:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153456156610560 [0;39m ==> Parameters:
2023-03-02 15:25:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153456156610560 [0;39m <==    Updates: 0
2023-03-02 15:25:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12153456156610560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:25:02.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:03.488 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:04.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153477157490688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:25:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153477157490688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:25:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153477157490688 [0;39m ==> Parameters:
2023-03-02 15:25:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153477157490688 [0;39m <==    Updates: 1
2023-03-02 15:25:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153477157490688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:25:06.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:13.394 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:15.441 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:34.984 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153602994999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:25:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153602994999296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:25:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153602994999296 [0;39m ==> Parameters:
2023-03-02 15:25:35.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153602994999296 [0;39m <==    Updates: 1
2023-03-02 15:25:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153602994999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:25:37.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:25:41.105 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12153707852599296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:26:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153707852599296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:26:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153707852599296 [0;39m ==> Parameters:
2023-03-02 15:26:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153707852599296 [0;39m <==    Updates: 0
2023-03-02 15:26:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12153707852599296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:26:02.918 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:03.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:04.958 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153728786370560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:26:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153728786370560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:26:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153728786370560 [0;39m ==> Parameters:
2023-03-02 15:26:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153728786370560 [0;39m <==    Updates: 1
2023-03-02 15:26:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153728786370560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:26:06.994 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:09.028 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:31.070 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:33.114 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:33.505 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153854632267776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:26:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153854632267776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:26:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153854632267776 [0;39m ==> Parameters:
2023-03-02 15:26:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153854632267776 [0;39m <==    Updates: 1
2023-03-02 15:26:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153854632267776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:26:35.149 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:37.193 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:56.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:26:58.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12153959473090560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:27:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153959473090560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:27:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153959473090560 [0;39m ==> Parameters:
2023-03-02 15:27:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12153959473090560 [0;39m <==    Updates: 0
2023-03-02 15:27:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12153959473090560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:27:02.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:03.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:04.988 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12153980440416256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:27:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153980440416256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:27:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153980440416256 [0;39m ==> Parameters:
2023-03-02 15:27:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12153980440416256 [0;39m <==    Updates: 1
2023-03-02 15:27:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12153980440416256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:27:07.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:20.211 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:22.253 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:32.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:33.507 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154106286313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:27:35.009 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154106286313472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:27:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154106286313472 [0;39m ==> Parameters:
2023-03-02 15:27:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154106286313472 [0;39m <==    Updates: 1
2023-03-02 15:27:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154106286313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:27:37.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:44.271 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:27:46.326 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12154211143913472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:28:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154211143913472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:28:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154211143913472 [0;39m ==> Parameters:
2023-03-02 15:28:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154211143913472 [0;39m <==    Updates: 0
2023-03-02 15:28:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12154211143913472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:28:02.956 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:03.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154232132210688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:28:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154232132210688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:28:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154232132210688 [0;39m ==> Parameters:
2023-03-02 15:28:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154232132210688 [0;39m <==    Updates: 1
2023-03-02 15:28:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154232132210688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:28:07.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:11.118 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:32.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:33.489 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154357927776256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:28:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154357927776256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:28:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154357927776256 [0;39m ==> Parameters:
2023-03-02 15:28:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154357927776256 [0;39m <==    Updates: 1
2023-03-02 15:28:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154357927776256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:28:37.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:28:39.086 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12154462823124992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:29:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154462823124992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:29:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154462823124992 [0;39m ==> Parameters:
2023-03-02 15:29:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154462823124992 [0;39m <==    Updates: 0
2023-03-02 15:29:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12154462823124992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:29:01.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:03.191 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:03.519 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154483765284864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:29:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154483765284864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:29:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154483765284864 [0;39m ==> Parameters:
2023-03-02 15:29:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154483765284864 [0;39m <==    Updates: 1
2023-03-02 15:29:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154483765284864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:29:05.225 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:07.255 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:09.291 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:25.256 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:27.290 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:32.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:35.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154609598599168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:29:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154609598599168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:29:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154609598599168 [0;39m ==> Parameters:
2023-03-02 15:29:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154609598599168 [0;39m <==    Updates: 1
2023-03-02 15:29:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154609598599168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:29:37.052 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:49.345 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:29:51.404 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12154714485559296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:30:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154714485559296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:30:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154714485559296 [0;39m ==> Parameters:
2023-03-02 15:30:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154714485559296 [0;39m <==    Updates: 0
2023-03-02 15:30:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12154714485559296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:30:02.936 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:03.504 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:04.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154735431913472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:30:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154735431913472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:30:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154735431913472 [0;39m ==> Parameters:
2023-03-02 15:30:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154735431913472 [0;39m <==    Updates: 1
2023-03-02 15:30:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154735431913472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:30:06.994 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:13.431 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:15.477 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:32.929 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:33.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154861256839168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:30:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154861256839168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:30:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154861256839168 [0;39m ==> Parameters:
2023-03-02 15:30:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154861256839168 [0;39m <==    Updates: 1
2023-03-02 15:30:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154861256839168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 15:30:37.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:39.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:30:41.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12154966122827776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:31:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154966122827776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:31:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154966122827776 [0;39m ==> Parameters:
2023-03-02 15:31:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12154966122827776 [0;39m <==    Updates: 0
2023-03-02 15:31:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12154966122827776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:31:02.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:03.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:04.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12154987094347776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:31:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154987094347776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:31:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154987094347776 [0;39m ==> Parameters:
2023-03-02 15:31:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12154987094347776 [0;39m <==    Updates: 1
2023-03-02 15:31:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12154987094347776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:31:07.010 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:09.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:33.122 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:33.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155112894107648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:31:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155112894107648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:31:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155112894107648 [0;39m ==> Parameters:
2023-03-02 15:31:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155112894107648 [0;39m <==    Updates: 1
2023-03-02 15:31:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155112894107648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 15:31:37.192 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:39.224 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:31:57.204 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12155217755901952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:32:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155217755901952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:32:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155217755901952 [0;39m ==> Parameters:
2023-03-02 15:32:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155217755901952 [0;39m <==    Updates: 0
2023-03-02 15:32:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12155217755901952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:32:02.920 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:03.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:04.966 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155238765170688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:32:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155238765170688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:32:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155238765170688 [0;39m ==> Parameters:
2023-03-02 15:32:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155238765170688 [0;39m <==    Updates: 1
2023-03-02 15:32:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155238765170688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:32:06.998 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:21.281 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:32.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:33.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155364560736256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:32:35.005 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155364560736256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:32:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155364560736256 [0;39m ==> Parameters:
2023-03-02 15:32:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155364560736256 [0;39m <==    Updates: 1
2023-03-02 15:32:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155364560736256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:32:37.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:43.338 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:32:45.396 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12155469447696384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:33:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155469447696384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:33:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155469447696384 [0;39m ==> Parameters:
2023-03-02 15:33:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155469447696384 [0;39m <==    Updates: 0
2023-03-02 15:33:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12155469447696384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:33:02.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:03.514 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155490431799296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:33:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155490431799296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:33:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155490431799296 [0;39m ==> Parameters:
2023-03-02 15:33:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155490431799296 [0;39m <==    Updates: 1
2023-03-02 15:33:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155490431799296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:33:07.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:09.085 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:11.125 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:32.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:33.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:34.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155616227364864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:33:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155616227364864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:33:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155616227364864 [0;39m ==> Parameters:
2023-03-02 15:33:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155616227364864 [0;39m <==    Updates: 1
2023-03-02 15:33:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155616227364864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:33:37.043 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:33:39.092 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12155721097547776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:34:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155721097547776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:34:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155721097547776 [0;39m ==> Parameters:
2023-03-02 15:34:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155721097547776 [0;39m <==    Updates: 0
2023-03-02 15:34:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12155721097547776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:34:01.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:03.182 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:03.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155742064873472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:34:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155742064873472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:34:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155742064873472 [0;39m ==> Parameters:
2023-03-02 15:34:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155742064873472 [0;39m <==    Updates: 1
2023-03-02 15:34:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155742064873472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:34:05.225 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:07.256 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:26.204 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:28.239 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:32.952 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:33.514 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:34.992 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155867885604864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:34:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155867885604864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:34:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155867885604864 [0;39m ==> Parameters:
2023-03-02 15:34:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155867885604864 [0;39m <==    Updates: 1
2023-03-02 15:34:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155867885604864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:34:37.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:50.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:34:52.293 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12155972751593472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:35:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155972751593472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:35:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155972751593472 [0;39m ==> Parameters:
2023-03-02 15:35:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12155972751593472 [0;39m <==    Updates: 0
2023-03-02 15:35:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12155972751593472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:35:03.522 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:04.990 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12155993718919168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:35:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155993718919168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:35:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155993718919168 [0;39m ==> Parameters:
2023-03-02 15:35:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12155993718919168 [0;39m <==    Updates: 1
2023-03-02 15:35:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12155993718919168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:35:07.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:14.352 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:16.402 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:32.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:33.516 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:34.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156119522873344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:35:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156119522873344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:35:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156119522873344 [0;39m ==> Parameters:
2023-03-02 15:35:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156119522873344 [0;39m <==    Updates: 1
2023-03-02 15:35:35.004 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156119522873344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:35:37.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:39.050 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:35:41.094 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12156224443387904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:36:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156224443387904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:36:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156224443387904 [0;39m ==> Parameters:
2023-03-02 15:36:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156224443387904 [0;39m <==    Updates: 0
2023-03-02 15:36:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12156224443387904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:36:02.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:03.512 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:04.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156245381353472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:36:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156245381353472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:36:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156245381353472 [0;39m ==> Parameters:
2023-03-02 15:36:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156245381353472 [0;39m <==    Updates: 1
2023-03-02 15:36:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156245381353472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:36:07.019 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:09.048 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:33.153 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:33.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156371197890560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:36:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156371197890560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:36:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156371197890560 [0;39m ==> Parameters:
2023-03-02 15:36:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156371197890560 [0;39m <==    Updates: 1
2023-03-02 15:36:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156371197890560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:36:35.191 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:37.222 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:39.250 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:55.166 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:36:57.196 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12156476063879168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:37:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156476063879168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:37:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156476063879168 [0;39m ==> Parameters:
2023-03-02 15:37:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156476063879168 [0;39m <==    Updates: 0
2023-03-02 15:37:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12156476063879168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:37:02.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:03.479 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:04.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156497039593472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:37:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156497039593472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:37:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156497039593472 [0;39m ==> Parameters:
2023-03-02 15:37:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156497039593472 [0;39m <==    Updates: 1
2023-03-02 15:37:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156497039593472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:37:07.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:19.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:21.259 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:32.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:33.479 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156622860324864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:37:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156622860324864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:37:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156622860324864 [0;39m ==> Parameters:
2023-03-02 15:37:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156622860324864 [0;39m <==    Updates: 1
2023-03-02 15:37:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156622860324864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:37:37.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:43.322 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:37:45.371 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12156727701147648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:38:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156727701147648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:38:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156727701147648 [0;39m ==> Parameters:
2023-03-02 15:38:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156727701147648 [0;39m <==    Updates: 0
2023-03-02 15:38:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12156727701147648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:38:02.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:03.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156748731387904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:38:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156748731387904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:38:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156748731387904 [0;39m ==> Parameters:
2023-03-02 15:38:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156748731387904 [0;39m <==    Updates: 1
2023-03-02 15:38:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156748731387904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:38:06.967 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:09.011 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:11.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:32.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:33.499 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:34.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12156874518564864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:38:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156874518564864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:38:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156874518564864 [0;39m ==> Parameters:
2023-03-02 15:38:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12156874518564864 [0;39m <==    Updates: 1
2023-03-02 15:38:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12156874518564864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:38:36.980 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:38:38.998 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12156979380359168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:39:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156979380359168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:39:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156979380359168 [0;39m ==> Parameters:
2023-03-02 15:39:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12156979380359168 [0;39m <==    Updates: 0
2023-03-02 15:39:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12156979380359168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:39:01.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:03.082 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:03.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157000360267776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:39:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157000360267776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:39:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157000360267776 [0;39m ==> Parameters:
2023-03-02 15:39:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157000360267776 [0;39m <==    Updates: 1
2023-03-02 15:39:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157000360267776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:39:05.118 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:09.206 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:25.134 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:27.179 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:32.931 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:33.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:34.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157126201970688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:39:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157126201970688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:39:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157126201970688 [0;39m ==> Parameters:
2023-03-02 15:39:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157126201970688 [0;39m <==    Updates: 1
2023-03-02 15:39:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157126201970688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:39:37.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:49.226 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:39:51.242 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12157231046987776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:40:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157231046987776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:40:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157231046987776 [0;39m ==> Parameters:
2023-03-02 15:40:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157231046987776 [0;39m <==    Updates: 0
2023-03-02 15:40:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12157231046987776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:40:02.935 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:03.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:04.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157252026896384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:40:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157252026896384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:40:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157252026896384 [0;39m ==> Parameters:
2023-03-02 15:40:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157252026896384 [0;39m <==    Updates: 1
2023-03-02 15:40:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157252026896384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:40:06.983 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:13.267 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:15.275 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:32.938 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157377847627776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:40:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157377847627776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:40:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157377847627776 [0;39m ==> Parameters:
2023-03-02 15:40:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157377847627776 [0;39m <==    Updates: 1
2023-03-02 15:40:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157377847627776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 15:40:36.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:39.024 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:40:41.047 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12157482722004992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:41:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157482722004992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:41:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157482722004992 [0;39m ==> Parameters:
2023-03-02 15:41:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157482722004992 [0;39m <==    Updates: 0
2023-03-02 15:41:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12157482722004992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:41:02.924 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:03.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:04.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157503676747776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:41:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157503676747776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:41:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157503676747776 [0;39m ==> Parameters:
2023-03-02 15:41:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157503676747776 [0;39m <==    Updates: 1
2023-03-02 15:41:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157503676747776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:41:06.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:09.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:31.071 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:33.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:33.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157629489090560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:41:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157629489090560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:41:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157629489090560 [0;39m ==> Parameters:
2023-03-02 15:41:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157629489090560 [0;39m <==    Updates: 1
2023-03-02 15:41:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157629489090560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:41:37.196 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:39.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:55.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:41:57.199 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12157734355079168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:42:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157734355079168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:42:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157734355079168 [0;39m ==> Parameters:
2023-03-02 15:42:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157734355079168 [0;39m <==    Updates: 0
2023-03-02 15:42:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12157734355079168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:42:02.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:03.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157755322404864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:42:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157755322404864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:42:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157755322404864 [0;39m ==> Parameters:
2023-03-02 15:42:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157755322404864 [0;39m <==    Updates: 1
2023-03-02 15:42:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157755322404864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:42:07.024 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:19.243 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:21.279 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:33.519 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:34.989 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12157881147330560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:42:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157881147330560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:42:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157881147330560 [0;39m ==> Parameters:
2023-03-02 15:42:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12157881147330560 [0;39m <==    Updates: 1
2023-03-02 15:42:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12157881147330560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:42:37.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:42:45.351 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12157986017513472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:43:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157986017513472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:43:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157986017513472 [0;39m ==> Parameters:
2023-03-02 15:43:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12157986017513472 [0;39m <==    Updates: 0
2023-03-02 15:43:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12157986017513472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:43:02.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:03.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:04.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158007001616384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:43:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158007001616384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:43:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158007001616384 [0;39m ==> Parameters:
2023-03-02 15:43:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158007001616384 [0;39m <==    Updates: 1
2023-03-02 15:43:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158007001616384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:43:07.012 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:09.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:11.112 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:32.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:33.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:34.990 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158132809764864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:43:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158132809764864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:43:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158132809764864 [0;39m ==> Parameters:
2023-03-02 15:43:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158132809764864 [0;39m <==    Updates: 1
2023-03-02 15:43:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158132809764864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:43:37.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:39.101 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:43:59.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12158237679947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:44:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158237679947776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:44:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158237679947776 [0;39m ==> Parameters:
2023-03-02 15:44:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158237679947776 [0;39m <==    Updates: 0
2023-03-02 15:44:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12158237679947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:44:01.120 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:03.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158258659856384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:44:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158258659856384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:44:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158258659856384 [0;39m ==> Parameters:
2023-03-02 15:44:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158258659856384 [0;39m <==    Updates: 1
2023-03-02 15:44:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158258659856384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:44:05.213 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:07.255 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:23.166 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:25.205 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:32.931 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:33.497 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:34.950 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158384497364992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:44:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158384497364992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:44:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158384497364992 [0;39m ==> Parameters:
2023-03-02 15:44:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158384497364992 [0;39m <==    Updates: 1
2023-03-02 15:44:35.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158384497364992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:44:36.971 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:47.244 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:44:49.277 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12158489329799168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:45:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158489329799168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:45:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158489329799168 [0;39m ==> Parameters:
2023-03-02 15:45:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158489329799168 [0;39m <==    Updates: 0
2023-03-02 15:45:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12158489329799168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:45:02.974 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:03.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158510309707776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:45:05.009 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158510309707776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:45:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158510309707776 [0;39m ==> Parameters:
2023-03-02 15:45:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158510309707776 [0;39m <==    Updates: 1
2023-03-02 15:45:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158510309707776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:45:07.038 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:11.351 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:13.382 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:32.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:33.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:34.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158636143022080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:45:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158636143022080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:45:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158636143022080 [0;39m ==> Parameters:
2023-03-02 15:45:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158636143022080 [0;39m <==    Updates: 1
2023-03-02 15:45:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158636143022080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:45:37.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:45:39.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12158741017399296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:46:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158741017399296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:46:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158741017399296 [0;39m ==> Parameters:
2023-03-02 15:46:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158741017399296 [0;39m <==    Updates: 0
2023-03-02 15:46:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12158741017399296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:46:03.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:03.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158761993113600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:46:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158761993113600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:46:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158761993113600 [0;39m ==> Parameters:
2023-03-02 15:46:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158761993113600 [0;39m <==    Updates: 1
2023-03-02 15:46:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158761993113600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:46:05.156 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:09.259 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:25.165 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:27.211 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:33.478 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:35.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12158887784484864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:46:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158887784484864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:46:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158887784484864 [0;39m ==> Parameters:
2023-03-02 15:46:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12158887784484864 [0;39m <==    Updates: 1
2023-03-02 15:46:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12158887784484864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:46:37.051 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:49.272 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:46:51.319 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12158992642084864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:47:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158992642084864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:47:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158992642084864 [0;39m ==> Parameters:
2023-03-02 15:47:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12158992642084864 [0;39m <==    Updates: 0
2023-03-02 15:47:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12158992642084864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:47:02.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:03.522 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:04.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159013634576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:47:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159013634576384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:47:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159013634576384 [0;39m ==> Parameters:
2023-03-02 15:47:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159013634576384 [0;39m <==    Updates: 1
2023-03-02 15:47:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159013634576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:47:07.000 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:13.389 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:15.421 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:32.938 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:33.485 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:34.970 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159139421753344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:47:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159139421753344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:47:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159139421753344 [0;39m ==> Parameters:
2023-03-02 15:47:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159139421753344 [0;39m <==    Updates: 1
2023-03-02 15:47:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159139421753344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:47:37.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:39.043 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:47:41.087 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12159244304519168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:48:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159244304519168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:48:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159244304519168 [0;39m ==> Parameters:
2023-03-02 15:48:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159244304519168 [0;39m <==    Updates: 0
2023-03-02 15:48:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12159244304519168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:48:02.958 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:03.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:04.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159265288622080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:48:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159265288622080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:48:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159265288622080 [0;39m ==> Parameters:
2023-03-02 15:48:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159265288622080 [0;39m <==    Updates: 1
2023-03-02 15:48:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159265288622080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 15:48:07.009 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:09.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:33.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:33.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159391113547776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:48:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159391113547776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:48:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159391113547776 [0;39m ==> Parameters:
2023-03-02 15:48:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159391113547776 [0;39m <==    Updates: 1
2023-03-02 15:48:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159391113547776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:48:35.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:39.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:55.114 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:48:57.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12159495962759168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:49:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159495962759168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:49:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159495962759168 [0;39m ==> Parameters:
2023-03-02 15:49:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159495962759168 [0;39m <==    Updates: 0
2023-03-02 15:49:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12159495962759168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 15:49:02.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:03.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:04.976 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159516934279168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:49:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159516934279168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:49:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159516934279168 [0;39m ==> Parameters:
2023-03-02 15:49:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159516934279168 [0;39m <==    Updates: 1
2023-03-02 15:49:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159516934279168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:49:06.995 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:19.182 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:21.219 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:32.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:33.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:34.990 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159642759204864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:49:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159642759204864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:49:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159642759204864 [0;39m ==> Parameters:
2023-03-02 15:49:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159642759204864 [0;39m <==    Updates: 1
2023-03-02 15:49:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159642759204864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:49:37.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:43.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:49:45.310 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12159747637776384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:50:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159747637776384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:50:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159747637776384 [0;39m ==> Parameters:
2023-03-02 15:50:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159747637776384 [0;39m <==    Updates: 0
2023-03-02 15:50:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12159747637776384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:50:02.935 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:03.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:04.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159768596713472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:50:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159768596713472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:50:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159768596713472 [0;39m ==> Parameters:
2023-03-02 15:50:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159768596713472 [0;39m <==    Updates: 1
2023-03-02 15:50:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159768596713472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:50:07.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:09.085 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:11.120 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:32.956 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:33.507 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12159894434222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:50:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159894434222080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:50:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159894434222080 [0;39m ==> Parameters:
2023-03-02 15:50:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12159894434222080 [0;39m <==    Updates: 1
2023-03-02 15:50:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12159894434222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:50:37.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:50:39.086 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12159999287627776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:51:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159999287627776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:51:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159999287627776 [0;39m ==> Parameters:
2023-03-02 15:51:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12159999287627776 [0;39m <==    Updates: 0
2023-03-02 15:51:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12159999287627776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 15:51:01.134 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:03.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:03.482 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160020280119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:51:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160020280119296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:51:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160020280119296 [0;39m ==> Parameters:
2023-03-02 15:51:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160020280119296 [0;39m <==    Updates: 1
2023-03-02 15:51:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160020280119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:51:05.186 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:07.230 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:09.279 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:25.227 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:27.246 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:33.478 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:34.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160146079879168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:51:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160146079879168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:51:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160146079879168 [0;39m ==> Parameters:
2023-03-02 15:51:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160146079879168 [0;39m <==    Updates: 1
2023-03-02 15:51:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160146079879168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:51:36.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:51:51.322 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12160250945867776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:52:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160250945867776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:52:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160250945867776 [0;39m ==> Parameters:
2023-03-02 15:52:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160250945867776 [0;39m <==    Updates: 0
2023-03-02 15:52:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12160250945867776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:52:02.933 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:03.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:04.950 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160271925776384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:52:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160271925776384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:52:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160271925776384 [0;39m ==> Parameters:
2023-03-02 15:52:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160271925776384 [0;39m <==    Updates: 1
2023-03-02 15:52:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160271925776384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:52:06.984 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:15.398 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:32.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:33.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:34.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160397738119168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:52:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160397738119168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:52:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160397738119168 [0;39m ==> Parameters:
2023-03-02 15:52:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160397738119168 [0;39m <==    Updates: 1
2023-03-02 15:52:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160397738119168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:52:37.008 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:39.043 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:52:41.072 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12160502629273600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:53:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160502629273600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:53:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160502629273600 [0;39m ==> Parameters:
2023-03-02 15:53:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160502629273600 [0;39m <==    Updates: 0
2023-03-02 15:53:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12160502629273600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:53:02.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:03.478 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:04.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160523571433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:53:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160523571433472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:53:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160523571433472 [0;39m ==> Parameters:
2023-03-02 15:53:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160523571433472 [0;39m <==    Updates: 1
2023-03-02 15:53:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160523571433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:53:07.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:09.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:31.121 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:33.145 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160649396359168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:53:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160649396359168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:53:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160649396359168 [0;39m ==> Parameters:
2023-03-02 15:53:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160649396359168 [0;39m <==    Updates: 1
2023-03-02 15:53:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160649396359168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:53:37.241 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:56.165 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:53:58.210 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12160754270736384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:54:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160754270736384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:54:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160754270736384 [0;39m ==> Parameters:
2023-03-02 15:54:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12160754270736384 [0;39m <==    Updates: 0
2023-03-02 15:54:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12160754270736384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 15:54:02.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:03.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:04.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160775229673472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:54:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160775229673472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:54:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160775229673472 [0;39m ==> Parameters:
2023-03-02 15:54:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160775229673472 [0;39m <==    Updates: 1
2023-03-02 15:54:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160775229673472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:54:06.992 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:20.259 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:22.309 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:32.942 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:33.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:34.975 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12160901050404864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:54:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160901050404864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:54:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160901050404864 [0;39m ==> Parameters:
2023-03-02 15:54:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12160901050404864 [0;39m <==    Updates: 1
2023-03-02 15:54:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12160901050404864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:54:37.009 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:44.363 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:54:46.399 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12161005912199168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:55:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161005912199168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:55:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161005912199168 [0;39m ==> Parameters:
2023-03-02 15:55:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161005912199168 [0;39m <==    Updates: 0
2023-03-02 15:55:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12161005912199168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 15:55:02.950 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:03.484 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:04.971 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161026862747648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:55:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161026862747648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:55:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161026862747648 [0;39m ==> Parameters:
2023-03-02 15:55:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161026862747648 [0;39m <==    Updates: 1
2023-03-02 15:55:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161026862747648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:55:06.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:09.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:11.083 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:32.931 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:33.524 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:34.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161152721227776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:55:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161152721227776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:55:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161152721227776 [0;39m ==> Parameters:
2023-03-02 15:55:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161152721227776 [0;39m <==    Updates: 1
2023-03-02 15:55:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161152721227776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:55:37.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:55:39.067 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12161257599799296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:56:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161257599799296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:56:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161257599799296 [0;39m ==> Parameters:
2023-03-02 15:56:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161257599799296 [0;39m <==    Updates: 0
2023-03-02 15:56:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12161257599799296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:56:01.111 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:03.166 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:03.526 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161278562930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:56:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161278562930688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:56:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161278562930688 [0;39m ==> Parameters:
2023-03-02 15:56:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161278562930688 [0;39m <==    Updates: 1
2023-03-02 15:56:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161278562930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 15:56:05.214 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:07.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:26.148 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:28.178 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:33.485 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:34.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161404366884864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:56:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161404366884864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:56:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161404366884864 [0;39m ==> Parameters:
2023-03-02 15:56:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161404366884864 [0;39m <==    Updates: 1
2023-03-02 15:56:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161404366884864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:56:36.995 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:50.239 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:56:52.287 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12161509232873472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:57:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161509232873472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:57:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161509232873472 [0;39m ==> Parameters:
2023-03-02 15:57:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161509232873472 [0;39m <==    Updates: 0
2023-03-02 15:57:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12161509232873472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 15:57:02.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:03.523 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161530196004864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:57:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161530196004864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:57:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161530196004864 [0;39m ==> Parameters:
2023-03-02 15:57:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161530196004864 [0;39m <==    Updates: 1
2023-03-02 15:57:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161530196004864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:57:05.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:07.067 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:16.354 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:32.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:34.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161656037707776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:57:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161656037707776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:57:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161656037707776 [0;39m ==> Parameters:
2023-03-02 15:57:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161656037707776 [0;39m <==    Updates: 1
2023-03-02 15:57:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161656037707776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:57:36.967 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:39.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:57:41.071 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12161760895307776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:58:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161760895307776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:58:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161760895307776 [0;39m ==> Parameters:
2023-03-02 15:58:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12161760895307776 [0;39m <==    Updates: 0
2023-03-02 15:58:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12161760895307776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 15:58:03.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:04.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161781862633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:58:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161781862633472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:58:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161781862633472 [0;39m ==> Parameters:
2023-03-02 15:58:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161781862633472 [0;39m <==    Updates: 1
2023-03-02 15:58:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161781862633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 15:58:06.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:09.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:31.070 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:33.117 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:33.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12161907679170560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:58:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161907679170560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:58:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161907679170560 [0;39m ==> Parameters:
2023-03-02 15:58:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12161907679170560 [0;39m <==    Updates: 1
2023-03-02 15:58:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12161907679170560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:58:37.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:39.223 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:58:57.212 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12162012553547776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 15:59:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162012553547776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 15:59:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162012553547776 [0;39m ==> Parameters:
2023-03-02 15:59:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162012553547776 [0;39m <==    Updates: 0
2023-03-02 15:59:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12162012553547776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 15:59:02.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:03.507 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:04.975 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162033516679168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:59:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162033516679168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:59:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162033516679168 [0;39m ==> Parameters:
2023-03-02 15:59:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162033516679168 [0;39m <==    Updates: 1
2023-03-02 15:59:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162033516679168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 15:59:07.034 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:19.249 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:21.286 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:32.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:33.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:34.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162159358382080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 15:59:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162159358382080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 15:59:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162159358382080 [0;39m ==> Parameters:
2023-03-02 15:59:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162159358382080 [0;39m <==    Updates: 1
2023-03-02 15:59:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162159358382080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 15:59:37.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:43.320 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 15:59:45.351 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12162264207593472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:00:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162264207593472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:00:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162264207593472 [0;39m ==> Parameters:
2023-03-02 16:00:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162264207593472 [0;39m <==    Updates: 0
2023-03-02 16:00:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12162264207593472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:00:02.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:03.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:04.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162285170724864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:00:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162285170724864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:00:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162285170724864 [0;39m ==> Parameters:
2023-03-02 16:00:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162285170724864 [0;39m <==    Updates: 1
2023-03-02 16:00:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162285170724864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:00:07.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:09.051 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:11.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:32.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:33.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:34.968 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162411029204992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:00:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162411029204992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:00:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162411029204992 [0;39m ==> Parameters:
2023-03-02 16:00:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162411029204992 [0;39m <==    Updates: 1
2023-03-02 16:00:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162411029204992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:00:37.009 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:00:39.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12162515874222080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:01:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162515874222080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:01:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162515874222080 [0;39m ==> Parameters:
2023-03-02 16:01:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162515874222080 [0;39m <==    Updates: 0
2023-03-02 16:01:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12162515874222080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:01:01.100 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:03.131 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:03.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162536820576256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:01:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162536820576256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:01:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162536820576256 [0;39m ==> Parameters:
2023-03-02 16:01:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162536820576256 [0;39m <==    Updates: 1
2023-03-02 16:01:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162536820576256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:01:05.161 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:07.195 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:09.217 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:25.181 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:27.210 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:32.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:33.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162662666473472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:01:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162662666473472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:01:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162662666473472 [0;39m ==> Parameters:
2023-03-02 16:01:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162662666473472 [0;39m <==    Updates: 1
2023-03-02 16:01:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162662666473472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:01:37.039 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:49.230 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:01:51.239 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12162767536656384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:02:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162767536656384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:02:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162767536656384 [0;39m ==> Parameters:
2023-03-02 16:02:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12162767536656384 [0;39m <==    Updates: 0
2023-03-02 16:02:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12162767536656384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:02:02.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:03.507 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:04.963 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162788499787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:02:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162788499787776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:02:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162788499787776 [0;39m ==> Parameters:
2023-03-02 16:02:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162788499787776 [0;39m <==    Updates: 1
2023-03-02 16:02:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162788499787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:02:07.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:13.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:15.306 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:32.942 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:34.989 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12162914312130560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:02:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162914312130560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:02:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162914312130560 [0;39m ==> Parameters:
2023-03-02 16:02:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12162914312130560 [0;39m <==    Updates: 1
2023-03-02 16:02:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12162914312130560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:02:37.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:39.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:02:41.116 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12163019178119168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:03:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163019178119168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:03:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163019178119168 [0;39m ==> Parameters:
2023-03-02 16:03:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163019178119168 [0;39m <==    Updates: 0
2023-03-02 16:03:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12163019178119168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:03:02.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:03.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:04.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163040145444864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:03:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163040145444864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:03:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163040145444864 [0;39m ==> Parameters:
2023-03-02 16:03:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163040145444864 [0;39m <==    Updates: 1
2023-03-02 16:03:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163040145444864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:03:07.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:09.070 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:31.130 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:33.166 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:33.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163165987147776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:03:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163165987147776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:03:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163165987147776 [0;39m ==> Parameters:
2023-03-02 16:03:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163165987147776 [0;39m <==    Updates: 1
2023-03-02 16:03:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163165987147776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:03:35.198 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:37.233 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:39.254 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:55.180 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:03:57.197 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12163270840553472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:04:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163270840553472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:04:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163270840553472 [0;39m ==> Parameters:
2023-03-02 16:04:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163270840553472 [0;39m <==    Updates: 0
2023-03-02 16:04:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12163270840553472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:04:03.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:04.982 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163291833044992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:04:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163291833044992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:04:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163291833044992 [0;39m ==> Parameters:
2023-03-02 16:04:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163291833044992 [0;39m <==    Updates: 1
2023-03-02 16:04:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163291833044992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:04:07.028 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:19.240 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:21.260 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:32.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:33.480 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:34.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163417653776384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:04:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163417653776384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:04:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163417653776384 [0;39m ==> Parameters:
2023-03-02 16:04:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163417653776384 [0;39m <==    Updates: 1
2023-03-02 16:04:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163417653776384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:04:36.972 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:43.320 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:04:45.355 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12163522507182080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:05:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163522507182080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:05:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163522507182080 [0;39m ==> Parameters:
2023-03-02 16:05:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163522507182080 [0;39m <==    Updates: 0
2023-03-02 16:05:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12163522507182080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:05:02.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:03.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163543487090688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:05:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163543487090688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:05:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163543487090688 [0;39m ==> Parameters:
2023-03-02 16:05:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163543487090688 [0;39m <==    Updates: 1
2023-03-02 16:05:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163543487090688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:05:06.984 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:09.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:11.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:32.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:33.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163669312016384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:05:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163669312016384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:05:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163669312016384 [0;39m ==> Parameters:
2023-03-02 16:05:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163669312016384 [0;39m <==    Updates: 1
2023-03-02 16:05:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163669312016384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:05:37.002 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:05:39.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12163774182199296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:06:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163774182199296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:06:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163774182199296 [0;39m ==> Parameters:
2023-03-02 16:06:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12163774182199296 [0;39m <==    Updates: 0
2023-03-02 16:06:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12163774182199296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:06:01.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:03.057 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:03.465 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163795103387648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:06:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163795103387648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:06:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163795103387648 [0;39m ==> Parameters:
2023-03-02 16:06:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163795103387648 [0;39m <==    Updates: 1
2023-03-02 16:06:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163795103387648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:06:05.062 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:09.122 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:25.077 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:27.098 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:32.913 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:33.475 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:34.935 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12163920978644992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:06:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163920978644992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:06:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163920978644992 [0;39m ==> Parameters:
2023-03-02 16:06:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12163920978644992 [0;39m <==    Updates: 1
2023-03-02 16:06:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12163920978644992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:06:36.973 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:49.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:06:51.172 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12164025794301952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:07:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164025794301952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:07:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164025794301952 [0;39m ==> Parameters:
2023-03-02 16:07:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164025794301952 [0;39m <==    Updates: 0
2023-03-02 16:07:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12164025794301952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:07:03.804 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164046765821952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:07:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164046765821952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:07:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164046765821952 [0;39m ==> Parameters:
2023-03-02 16:07:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164046765821952 [0;39m <==    Updates: 1
2023-03-02 16:07:05.006 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164046765821952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:07:07.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:15.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:32.963 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:33.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164172599136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:07:35.004 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164172599136256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:07:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164172599136256 [0;39m ==> Parameters:
2023-03-02 16:07:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164172599136256 [0;39m <==    Updates: 1
2023-03-02 16:07:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164172599136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 16:07:37.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:39.093 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:07:41.142 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12164277481902080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:08:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164277481902080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:08:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164277481902080 [0;39m ==> Parameters:
2023-03-02 16:08:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164277481902080 [0;39m <==    Updates: 0
2023-03-02 16:08:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12164277481902080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:08:02.941 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:03.517 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:04.983 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164298466004992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:08:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164298466004992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:08:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164298466004992 [0;39m ==> Parameters:
2023-03-02 16:08:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164298466004992 [0;39m <==    Updates: 1
2023-03-02 16:08:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164298466004992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:08:07.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:09.061 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:31.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:33.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:33.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164424265764864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:08:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164424265764864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:08:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164424265764864 [0;39m ==> Parameters:
2023-03-02 16:08:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164424265764864 [0;39m <==    Updates: 1
2023-03-02 16:08:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164424265764864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 16:08:37.272 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:39.299 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:55.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:08:57.283 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12164529135947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:09:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164529135947776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:09:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164529135947776 [0;39m ==> Parameters:
2023-03-02 16:09:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164529135947776 [0;39m <==    Updates: 0
2023-03-02 16:09:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12164529135947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:09:02.936 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:03.498 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:04.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164550073913344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:09:05.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164550073913344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:09:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164550073913344 [0;39m ==> Parameters:
2023-03-02 16:09:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164550073913344 [0;39m <==    Updates: 1
2023-03-02 16:09:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164550073913344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:09:06.997 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:21.403 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:32.951 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:33.498 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:35.000 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164675957559296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:09:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164675957559296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:09:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164675957559296 [0;39m ==> Parameters:
2023-03-02 16:09:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164675957559296 [0;39m <==    Updates: 1
2023-03-02 16:09:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164675957559296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:09:37.043 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:09:45.485 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12164780827742208 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:10:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164780827742208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:10:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164780827742208 [0;39m ==> Parameters:
2023-03-02 16:10:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12164780827742208 [0;39m <==    Updates: 0
2023-03-02 16:10:00.027 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12164780827742208 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:10:02.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:03.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:04.980 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164801774096384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:10:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164801774096384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:10:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164801774096384 [0;39m ==> Parameters:
2023-03-02 16:10:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164801774096384 [0;39m <==    Updates: 1
2023-03-02 16:10:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164801774096384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 16:10:07.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:09.079 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:11.124 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:32.950 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:33.700 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12164927569661952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:10:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164927569661952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:10:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164927569661952 [0;39m ==> Parameters:
2023-03-02 16:10:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12164927569661952 [0;39m <==    Updates: 1
2023-03-02 16:10:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12164927569661952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:10:35.019 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:37.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:10:39.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12165032460816384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:11:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165032460816384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:11:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165032460816384 [0;39m ==> Parameters:
2023-03-02 16:11:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165032460816384 [0;39m <==    Updates: 0
2023-03-02 16:11:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12165032460816384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:11:03.195 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:03.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165053423947776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:11:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165053423947776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:11:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165053423947776 [0;39m ==> Parameters:
2023-03-02 16:11:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165053423947776 [0;39m <==    Updates: 1
2023-03-02 16:11:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165053423947776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:11:09.336 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:25.257 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:27.300 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:32.937 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:33.499 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165179261456384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:11:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165179261456384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:11:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165179261456384 [0;39m ==> Parameters:
2023-03-02 16:11:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165179261456384 [0;39m <==    Updates: 1
2023-03-02 16:11:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165179261456384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:11:37.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:49.328 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:11:51.356 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12165284123250688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:12:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165284123250688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:12:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165284123250688 [0;39m ==> Parameters:
2023-03-02 16:12:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165284123250688 [0;39m <==    Updates: 0
2023-03-02 16:12:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12165284123250688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:12:02.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:03.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:04.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165305090576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:12:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165305090576384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:12:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165305090576384 [0;39m ==> Parameters:
2023-03-02 16:12:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165305090576384 [0;39m <==    Updates: 1
2023-03-02 16:12:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165305090576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 16:12:07.027 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:13.428 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:15.472 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:32.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:33.498 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165430915502080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:12:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165430915502080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:12:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165430915502080 [0;39m ==> Parameters:
2023-03-02 16:12:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165430915502080 [0;39m <==    Updates: 1
2023-03-02 16:12:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165430915502080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:12:37.041 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:39.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:12:41.144 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12165535747936256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:13:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165535747936256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:13:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165535747936256 [0;39m ==> Parameters:
2023-03-02 16:13:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165535747936256 [0;39m <==    Updates: 0
2023-03-02 16:13:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12165535747936256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 16:13:03.500 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:04.997 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165556748816384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:13:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165556748816384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:13:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165556748816384 [0;39m ==> Parameters:
2023-03-02 16:13:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165556748816384 [0;39m <==    Updates: 1
2023-03-02 16:13:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165556748816384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:13:07.052 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:09.107 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:31.162 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:33.203 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:33.500 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165682582130688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:13:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165682582130688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:13:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165682582130688 [0;39m ==> Parameters:
2023-03-02 16:13:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165682582130688 [0;39m <==    Updates: 1
2023-03-02 16:13:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165682582130688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:13:37.322 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:56.222 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:13:58.264 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12165787410370560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:14:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165787410370560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:14:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165787410370560 [0;39m ==> Parameters:
2023-03-02 16:14:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12165787410370560 [0;39m <==    Updates: 0
2023-03-02 16:14:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12165787410370560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:14:03.518 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165808419639296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:14:05.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165808419639296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:14:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165808419639296 [0;39m ==> Parameters:
2023-03-02 16:14:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165808419639296 [0;39m <==    Updates: 1
2023-03-02 16:14:05.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165808419639296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:14:07.073 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:20.311 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:22.351 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:33.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:34.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12165934227787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:14:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165934227787776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:14:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165934227787776 [0;39m ==> Parameters:
2023-03-02 16:14:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12165934227787776 [0;39m <==    Updates: 1
2023-03-02 16:14:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12165934227787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:14:37.035 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:14:46.428 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12166039106359296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:15:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166039106359296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:15:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166039106359296 [0;39m ==> Parameters:
2023-03-02 16:15:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166039106359296 [0;39m <==    Updates: 0
2023-03-02 16:15:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12166039106359296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 16:15:03.523 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166060061102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:15:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166060061102080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:15:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166060061102080 [0;39m ==> Parameters:
2023-03-02 16:15:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166060061102080 [0;39m <==    Updates: 1
2023-03-02 16:15:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166060061102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:15:06.997 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:09.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:11.061 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:32.918 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:33.512 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:34.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166185894416384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:15:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166185894416384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:15:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166185894416384 [0;39m ==> Parameters:
2023-03-02 16:15:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166185894416384 [0;39m <==    Updates: 1
2023-03-02 16:15:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166185894416384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:15:36.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:15:39.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12166290718461952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:16:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166290718461952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:16:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166290718461952 [0;39m ==> Parameters:
2023-03-02 16:16:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166290718461952 [0;39m <==    Updates: 0
2023-03-02 16:16:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12166290718461952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 16:16:01.067 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:03.078 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:03.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166311715147776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:16:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166311715147776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:16:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166311715147776 [0;39m ==> Parameters:
2023-03-02 16:16:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166311715147776 [0;39m <==    Updates: 1
2023-03-02 16:16:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166311715147776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:16:05.118 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:07.147 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:09.187 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:25.134 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:27.163 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:32.929 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:33.489 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:34.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166437531684864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:16:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166437531684864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:16:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166437531684864 [0;39m ==> Parameters:
2023-03-02 16:16:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166437531684864 [0;39m <==    Updates: 1
2023-03-02 16:16:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166437531684864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:16:36.994 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:49.201 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:16:51.249 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12166542422839296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:17:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166542422839296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:17:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166542422839296 [0;39m ==> Parameters:
2023-03-02 16:17:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166542422839296 [0;39m <==    Updates: 0
2023-03-02 16:17:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12166542422839296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:17:03.514 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166563339833344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:17:05.002 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166563339833344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:17:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166563339833344 [0;39m ==> Parameters:
2023-03-02 16:17:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166563339833344 [0;39m <==    Updates: 1
2023-03-02 16:17:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166563339833344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:17:07.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:13.356 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:15.407 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:32.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:33.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166689198313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:17:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166689198313472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:17:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166689198313472 [0;39m ==> Parameters:
2023-03-02 16:17:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166689198313472 [0;39m <==    Updates: 1
2023-03-02 16:17:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166689198313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:17:35.039 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:37.074 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:17:41.159 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12166794043330560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:18:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166794043330560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:18:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166794043330560 [0;39m ==> Parameters:
2023-03-02 16:18:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12166794043330560 [0;39m <==    Updates: 0
2023-03-02 16:18:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12166794043330560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 16:18:02.956 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:03.517 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:04.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166815006461952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:18:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166815006461952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:18:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166815006461952 [0;39m ==> Parameters:
2023-03-02 16:18:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166815006461952 [0;39m <==    Updates: 1
2023-03-02 16:18:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166815006461952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:18:07.015 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:09.070 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:33.187 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:33.498 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12166940864942080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:18:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166940864942080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:18:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166940864942080 [0;39m ==> Parameters:
2023-03-02 16:18:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12166940864942080 [0;39m <==    Updates: 1
2023-03-02 16:18:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12166940864942080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:18:35.228 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:37.257 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:39.302 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:55.207 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:18:57.252 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12167045709959168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:19:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167045709959168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:19:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167045709959168 [0;39m ==> Parameters:
2023-03-02 16:19:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167045709959168 [0;39m <==    Updates: 0
2023-03-02 16:19:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12167045709959168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:19:03.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:04.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167066664701952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:19:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167066664701952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:19:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167066664701952 [0;39m ==> Parameters:
2023-03-02 16:19:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167066664701952 [0;39m <==    Updates: 1
2023-03-02 16:19:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167066664701952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:19:07.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:21.336 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:32.972 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:33.487 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:35.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167192502210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:19:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167192502210560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:19:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167192502210560 [0;39m ==> Parameters:
2023-03-02 16:19:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167192502210560 [0;39m <==    Updates: 1
2023-03-02 16:19:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167192502210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:19:37.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:19:45.430 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12167297376587776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:20:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167297376587776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:20:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167297376587776 [0;39m ==> Parameters:
2023-03-02 16:20:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167297376587776 [0;39m <==    Updates: 0
2023-03-02 16:20:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12167297376587776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:20:02.967 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:03.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167318314553344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:20:05.002 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167318314553344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:20:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167318314553344 [0;39m ==> Parameters:
2023-03-02 16:20:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167318314553344 [0;39m <==    Updates: 1
2023-03-02 16:20:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167318314553344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:20:07.057 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:09.095 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:11.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:32.956 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:33.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:35.000 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167444202393600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:20:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167444202393600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:20:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167444202393600 [0;39m ==> Parameters:
2023-03-02 16:20:35.025 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167444202393600 [0;39m <==    Updates: 1
2023-03-02 16:20:35.025 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167444202393600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:20:37.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:20:39.089 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12167549022244864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:21:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167549022244864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:21:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167549022244864 [0;39m ==> Parameters:
2023-03-02 16:21:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167549022244864 [0;39m <==    Updates: 0
2023-03-02 16:21:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12167549022244864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 16:21:03.190 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:03.501 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167569989570560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:21:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167569989570560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:21:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167569989570560 [0;39m ==> Parameters:
2023-03-02 16:21:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167569989570560 [0;39m <==    Updates: 1
2023-03-02 16:21:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167569989570560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:21:05.224 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:07.246 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:09.276 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:25.230 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:27.272 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:33.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:34.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167695810301952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:21:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167695810301952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:21:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167695810301952 [0;39m ==> Parameters:
2023-03-02 16:21:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167695810301952 [0;39m <==    Updates: 1
2023-03-02 16:21:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167695810301952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:21:37.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:49.312 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:21:51.349 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12167800667901952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:22:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167800667901952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:22:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167800667901952 [0;39m ==> Parameters:
2023-03-02 16:22:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12167800667901952 [0;39m <==    Updates: 0
2023-03-02 16:22:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12167800667901952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 16:22:02.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:03.512 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:04.992 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167821652004864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:22:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167821652004864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:22:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167821652004864 [0;39m ==> Parameters:
2023-03-02 16:22:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167821652004864 [0;39m <==    Updates: 1
2023-03-02 16:22:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167821652004864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:22:07.028 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:15.458 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:33.512 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:34.981 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12167947502096384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:22:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167947502096384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:22:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167947502096384 [0;39m ==> Parameters:
2023-03-02 16:22:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12167947502096384 [0;39m <==    Updates: 1
2023-03-02 16:22:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12167947502096384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:22:37.002 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:39.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:22:41.074 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12168052342919168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:23:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168052342919168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:23:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168052342919168 [0;39m ==> Parameters:
2023-03-02 16:23:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168052342919168 [0;39m <==    Updates: 0
2023-03-02 16:23:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12168052342919168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:23:02.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:03.520 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:04.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168073318633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:23:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168073318633472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:23:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168073318633472 [0;39m ==> Parameters:
2023-03-02 16:23:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168073318633472 [0;39m <==    Updates: 1
2023-03-02 16:23:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168073318633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:23:06.994 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:09.045 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:33.143 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:33.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168199151947776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:23:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168199151947776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:23:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168199151947776 [0;39m ==> Parameters:
2023-03-02 16:23:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168199151947776 [0;39m <==    Updates: 1
2023-03-02 16:23:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168199151947776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:23:35.183 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:39.257 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:55.183 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:23:57.238 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12168303984381952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:24:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168303984381952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:24:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168303984381952 [0;39m ==> Parameters:
2023-03-02 16:24:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168303984381952 [0;39m <==    Updates: 0
2023-03-02 16:24:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12168303984381952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 16:24:02.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:03.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168324972679168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:24:05.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168324972679168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:24:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168324972679168 [0;39m ==> Parameters:
2023-03-02 16:24:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168324972679168 [0;39m <==    Updates: 1
2023-03-02 16:24:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168324972679168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 16:24:07.039 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:19.289 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:21.323 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:32.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:33.523 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:34.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168450805993472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:24:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168450805993472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:24:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168450805993472 [0;39m ==> Parameters:
2023-03-02 16:24:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168450805993472 [0;39m <==    Updates: 1
2023-03-02 16:24:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168450805993472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:24:37.004 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:43.383 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:24:45.437 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12168555680370688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:25:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168555680370688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:25:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168555680370688 [0;39m ==> Parameters:
2023-03-02 16:25:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168555680370688 [0;39m <==    Updates: 0
2023-03-02 16:25:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12168555680370688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:25:03.521 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:05.022 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168576693833728 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:25:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168576693833728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:25:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168576693833728 [0;39m ==> Parameters:
2023-03-02 16:25:05.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:05.030 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168576693833728 [0;39m <==    Updates: 1
2023-03-02 16:25:05.031 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168576693833728 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:25:07.077 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:11.158 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:33.504 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168702489399296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:25:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168702489399296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:25:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168702489399296 [0;39m ==> Parameters:
2023-03-02 16:25:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168702489399296 [0;39m <==    Updates: 1
2023-03-02 16:25:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168702489399296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:25:37.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:25:39.072 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12168807292473344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:26:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168807292473344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:26:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168807292473344 [0;39m ==> Parameters:
2023-03-02 16:26:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12168807292473344 [0;39m <==    Updates: 0
2023-03-02 16:26:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12168807292473344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:26:01.125 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:03.151 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:03.511 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168828297547776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:26:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168828297547776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:26:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168828297547776 [0;39m ==> Parameters:
2023-03-02 16:26:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168828297547776 [0;39m <==    Updates: 1
2023-03-02 16:26:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168828297547776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:26:05.198 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:07.252 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:09.281 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:27.199 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:32.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:33.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:34.966 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12168954143444992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:26:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168954143444992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:26:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168954143444992 [0;39m ==> Parameters:
2023-03-02 16:26:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12168954143444992 [0;39m <==    Updates: 1
2023-03-02 16:26:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12168954143444992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 16:26:36.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:49.243 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:26:51.289 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12169058980073472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:27:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169058980073472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:27:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169058980073472 [0;39m ==> Parameters:
2023-03-02 16:27:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169058980073472 [0;39m <==    Updates: 0
2023-03-02 16:27:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12169058980073472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:27:02.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:03.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:04.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169079959982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:27:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169079959982080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:27:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169079959982080 [0;39m ==> Parameters:
2023-03-02 16:27:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169079959982080 [0;39m <==    Updates: 1
2023-03-02 16:27:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169079959982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:27:07.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:13.314 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:15.332 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:32.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:33.479 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169205772324864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:27:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169205772324864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:27:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169205772324864 [0;39m ==> Parameters:
2023-03-02 16:27:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169205772324864 [0;39m <==    Updates: 1
2023-03-02 16:27:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169205772324864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:27:36.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:39.008 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:27:41.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12169310638313472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:28:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169310638313472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:28:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169310638313472 [0;39m ==> Parameters:
2023-03-02 16:28:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169310638313472 [0;39m <==    Updates: 0
2023-03-02 16:28:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12169310638313472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:28:03.478 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:04.992 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169331609833472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:28:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169331609833472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:28:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169331609833472 [0;39m ==> Parameters:
2023-03-02 16:28:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169331609833472 [0;39m <==    Updates: 1
2023-03-02 16:28:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169331609833472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:28:07.016 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:09.051 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:31.093 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:33.115 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:33.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169457434759168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:28:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169457434759168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:28:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169457434759168 [0;39m ==> Parameters:
2023-03-02 16:28:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169457434759168 [0;39m <==    Updates: 1
2023-03-02 16:28:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169457434759168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:28:35.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:37.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:39.204 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:55.157 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:28:57.209 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12169562309136384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:29:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169562309136384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:29:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169562309136384 [0;39m ==> Parameters:
2023-03-02 16:29:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169562309136384 [0;39m <==    Updates: 0
2023-03-02 16:29:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12169562309136384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:29:02.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:03.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:04.997 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169583284850688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:29:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169583284850688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:29:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169583284850688 [0;39m ==> Parameters:
2023-03-02 16:29:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169583284850688 [0;39m <==    Updates: 1
2023-03-02 16:29:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169583284850688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:29:07.020 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:19.248 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:21.298 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:32.934 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:33.484 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:34.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169709076221952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:29:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169709076221952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:29:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169709076221952 [0;39m ==> Parameters:
2023-03-02 16:29:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169709076221952 [0;39m <==    Updates: 1
2023-03-02 16:29:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169709076221952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:29:36.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:43.354 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:29:45.371 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12169813933821952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:30:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169813933821952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:30:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169813933821952 [0;39m ==> Parameters:
2023-03-02 16:30:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12169813933821952 [0;39m <==    Updates: 0
2023-03-02 16:30:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12169813933821952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:30:02.934 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:03.498 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:04.971 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169834901147648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:30:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169834901147648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:30:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169834901147648 [0;39m ==> Parameters:
2023-03-02 16:30:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169834901147648 [0;39m <==    Updates: 1
2023-03-02 16:30:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169834901147648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:30:07.017 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:09.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:11.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:32.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:33.478 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12169960755433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:30:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169960755433472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:30:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169960755433472 [0;39m ==> Parameters:
2023-03-02 16:30:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12169960755433472 [0;39m <==    Updates: 1
2023-03-02 16:30:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12169960755433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:30:36.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:30:39.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12170065629810688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:31:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170065629810688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:31:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170065629810688 [0;39m ==> Parameters:
2023-03-02 16:31:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170065629810688 [0;39m <==    Updates: 0
2023-03-02 16:31:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12170065629810688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:31:01.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:03.103 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:03.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170086584553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:31:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170086584553472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:31:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170086584553472 [0;39m ==> Parameters:
2023-03-02 16:31:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170086584553472 [0;39m <==    Updates: 1
2023-03-02 16:31:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170086584553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:31:05.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:07.163 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:09.209 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:25.151 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:27.170 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:32.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:33.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:34.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170212422062080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:31:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170212422062080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:31:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170212422062080 [0;39m ==> Parameters:
2023-03-02 16:31:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170212422062080 [0;39m <==    Updates: 1
2023-03-02 16:31:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170212422062080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:31:36.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:31:51.238 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12170317246107648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:32:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170317246107648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:32:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170317246107648 [0;39m ==> Parameters:
2023-03-02 16:32:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170317246107648 [0;39m <==    Updates: 0
2023-03-02 16:32:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12170317246107648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-02 16:32:02.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:03.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170338221821952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:32:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170338221821952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:32:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170338221821952 [0;39m ==> Parameters:
2023-03-02 16:32:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170338221821952 [0;39m <==    Updates: 1
2023-03-02 16:32:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170338221821952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:32:07.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:13.252 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:15.333 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:32.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:33.468 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170464055136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:32:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170464055136256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:32:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170464055136256 [0;39m ==> Parameters:
2023-03-02 16:32:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170464055136256 [0;39m <==    Updates: 1
2023-03-02 16:32:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170464055136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:32:36.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:39.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:32:41.059 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12170568950484992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:33:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170568950484992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:33:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170568950484992 [0;39m ==> Parameters:
2023-03-02 16:33:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170568950484992 [0;39m <==    Updates: 0
2023-03-02 16:33:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12170568950484992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 16:33:02.929 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:03.477 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:05.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170589867479040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:33:05.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170589867479040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:33:05.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170589867479040 [0;39m ==> Parameters:
2023-03-02 16:33:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170589867479040 [0;39m <==    Updates: 1
2023-03-02 16:33:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170589867479040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:33:06.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:08.997 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:31.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:33.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:33.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170715730153472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:33:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170715730153472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:33:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170715730153472 [0;39m ==> Parameters:
2023-03-02 16:33:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170715730153472 [0;39m <==    Updates: 1
2023-03-02 16:33:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170715730153472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 16:33:35.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:37.082 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:39.089 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:55.112 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:33:57.129 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12170820612919296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:34:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170820612919296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:34:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170820612919296 [0;39m ==> Parameters:
2023-03-02 16:34:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12170820612919296 [0;39m <==    Updates: 0
2023-03-02 16:34:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12170820612919296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:34:03.478 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:04.939 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170841529913344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:34:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170841529913344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:34:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170841529913344 [0;39m ==> Parameters:
2023-03-02 16:34:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170841529913344 [0;39m <==    Updates: 1
2023-03-02 16:34:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170841529913344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:34:06.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:19.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:21.185 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:32.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12170967375810560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:34:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170967375810560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:34:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170967375810560 [0;39m ==> Parameters:
2023-03-02 16:34:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12170967375810560 [0;39m <==    Updates: 1
2023-03-02 16:34:35.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12170967375810560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 16:34:37.011 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:34:45.267 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12171072241799168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:35:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171072241799168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:35:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171072241799168 [0;39m ==> Parameters:
2023-03-02 16:35:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171072241799168 [0;39m <==    Updates: 0
2023-03-02 16:35:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12171072241799168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:35:03.516 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171093200736256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:35:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171093200736256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:35:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171093200736256 [0;39m ==> Parameters:
2023-03-02 16:35:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171093200736256 [0;39m <==    Updates: 1
2023-03-02 16:35:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171093200736256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:35:06.990 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:09.008 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:11.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:32.921 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:33.490 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:34.969 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171219017273344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:35:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171219017273344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:35:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171219017273344 [0;39m ==> Parameters:
2023-03-02 16:35:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171219017273344 [0;39m <==    Updates: 1
2023-03-02 16:35:35.004 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171219017273344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:35:36.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:35:39.015 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12171323879067648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:36:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171323879067648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:36:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171323879067648 [0;39m ==> Parameters:
2023-03-02 16:36:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171323879067648 [0;39m <==    Updates: 0
2023-03-02 16:36:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12171323879067648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:36:01.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:03.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:03.474 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171344888336384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:36:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171344888336384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:36:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171344888336384 [0;39m ==> Parameters:
2023-03-02 16:36:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171344888336384 [0;39m <==    Updates: 1
2023-03-02 16:36:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171344888336384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:36:05.091 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:07.115 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:26.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:28.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:32.917 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:33.484 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171470725844992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:36:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171470725844992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:36:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171470725844992 [0;39m ==> Parameters:
2023-03-02 16:36:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171470725844992 [0;39m <==    Updates: 1
2023-03-02 16:36:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171470725844992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 16:36:36.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:50.156 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:36:52.184 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12171575591833600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:37:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171575591833600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:37:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171575591833600 [0;39m ==> Parameters:
2023-03-02 16:37:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171575591833600 [0;39m <==    Updates: 0
2023-03-02 16:37:00.027 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12171575591833600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:37:03.476 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:04.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171596550770688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:37:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171596550770688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:37:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171596550770688 [0;39m ==> Parameters:
2023-03-02 16:37:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171596550770688 [0;39m <==    Updates: 1
2023-03-02 16:37:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171596550770688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:37:06.976 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:14.208 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:16.246 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:32.925 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:33.486 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:34.952 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171722388279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:37:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171722388279296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:37:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171722388279296 [0;39m ==> Parameters:
2023-03-02 16:37:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171722388279296 [0;39m <==    Updates: 1
2023-03-02 16:37:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171722388279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:37:36.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:39.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:37:41.027 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12171827220713472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:38:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171827220713472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:38:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171827220713472 [0;39m ==> Parameters:
2023-03-02 16:38:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12171827220713472 [0;39m <==    Updates: 0
2023-03-02 16:38:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12171827220713472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-02 16:38:02.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:03.480 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:04.942 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171848179650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:38:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171848179650560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:38:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171848179650560 [0;39m ==> Parameters:
2023-03-02 16:38:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171848179650560 [0;39m <==    Updates: 1
2023-03-02 16:38:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171848179650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:38:06.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:08.989 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:33.048 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:33.470 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12171974033936384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:38:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171974033936384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:38:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171974033936384 [0;39m ==> Parameters:
2023-03-02 16:38:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12171974033936384 [0;39m <==    Updates: 1
2023-03-02 16:38:35.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12171974033936384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:38:37.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:39.122 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:55.077 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:38:57.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12172078887342080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:39:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172078887342080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:39:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172078887342080 [0;39m ==> Parameters:
2023-03-02 16:39:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172078887342080 [0;39m <==    Updates: 0
2023-03-02 16:39:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12172078887342080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:39:02.912 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:03.479 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:04.933 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172099863056384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:39:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172099863056384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:39:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172099863056384 [0;39m ==> Parameters:
2023-03-02 16:39:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172099863056384 [0;39m <==    Updates: 1
2023-03-02 16:39:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172099863056384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:39:06.941 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:19.115 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:21.127 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:32.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:33.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:35.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172225713147904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:39:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172225713147904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:39:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172225713147904 [0;39m ==> Parameters:
2023-03-02 16:39:35.024 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172225713147904 [0;39m <==    Updates: 1
2023-03-02 16:39:35.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172225713147904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:39:37.024 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:43.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:39:45.204 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12172330520416256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:40:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172330520416256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:40:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172330520416256 [0;39m ==> Parameters:
2023-03-02 16:40:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172330520416256 [0;39m <==    Updates: 0
2023-03-02 16:40:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12172330520416256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:40:02.963 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:03.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:04.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172351512907776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:40:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172351512907776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:40:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172351512907776 [0;39m ==> Parameters:
2023-03-02 16:40:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172351512907776 [0;39m <==    Updates: 1
2023-03-02 16:40:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172351512907776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:40:06.998 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:09.030 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:11.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:32.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:33.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:34.968 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172477367193600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:40:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172477367193600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:40:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172477367193600 [0;39m ==> Parameters:
2023-03-02 16:40:35.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172477367193600 [0;39m <==    Updates: 1
2023-03-02 16:40:35.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172477367193600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:40:36.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:40:38.999 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12172582203822080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:41:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172582203822080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:41:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172582203822080 [0;39m ==> Parameters:
2023-03-02 16:41:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172582203822080 [0;39m <==    Updates: 0
2023-03-02 16:41:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12172582203822080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:41:01.027 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:03.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:03.479 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172603137593344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:41:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172603137593344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:41:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172603137593344 [0;39m ==> Parameters:
2023-03-02 16:41:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172603137593344 [0;39m <==    Updates: 1
2023-03-02 16:41:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172603137593344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:41:05.065 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:07.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:26.100 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:28.125 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:32.931 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:33.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:34.972 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172728975101952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:41:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172728975101952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:41:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172728975101952 [0;39m ==> Parameters:
2023-03-02 16:41:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172728975101952 [0;39m <==    Updates: 1
2023-03-02 16:41:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172728975101952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:41:37.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:50.134 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:41:52.182 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12172833870450688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:42:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172833870450688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:42:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172833870450688 [0;39m ==> Parameters:
2023-03-02 16:42:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12172833870450688 [0;39m <==    Updates: 0
2023-03-02 16:42:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12172833870450688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:42:02.914 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:03.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172854829387776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:42:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172854829387776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:42:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172854829387776 [0;39m ==> Parameters:
2023-03-02 16:42:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172854829387776 [0;39m <==    Updates: 1
2023-03-02 16:42:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172854829387776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:42:06.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:14.227 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:16.246 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:32.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:33.503 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:34.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12172980662702080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:42:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172980662702080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:42:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172980662702080 [0;39m ==> Parameters:
2023-03-02 16:42:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12172980662702080 [0;39m <==    Updates: 1
2023-03-02 16:42:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12172980662702080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:42:36.988 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:42:41.034 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12173085528690688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:43:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173085528690688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:43:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173085528690688 [0;39m ==> Parameters:
2023-03-02 16:43:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173085528690688 [0;39m <==    Updates: 0
2023-03-02 16:43:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12173085528690688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:43:02.925 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:03.477 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173106512793600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:43:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173106512793600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:43:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173106512793600 [0;39m ==> Parameters:
2023-03-02 16:43:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173106512793600 [0;39m <==    Updates: 1
2023-03-02 16:43:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173106512793600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:43:06.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:08.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:31.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:33.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:33.497 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173232283193344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:43:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173232283193344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:43:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173232283193344 [0;39m ==> Parameters:
2023-03-02 16:43:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173232283193344 [0;39m <==    Updates: 1
2023-03-02 16:43:35.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173232283193344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 16:43:35.064 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:37.086 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:39.134 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:55.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:43:57.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12173337178542080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:44:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173337178542080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:44:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173337178542080 [0;39m ==> Parameters:
2023-03-02 16:44:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173337178542080 [0;39m <==    Updates: 0
2023-03-02 16:44:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12173337178542080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:44:03.467 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173358124896256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:44:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173358124896256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:44:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173358124896256 [0;39m ==> Parameters:
2023-03-02 16:44:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173358124896256 [0;39m <==    Updates: 1
2023-03-02 16:44:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173358124896256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:44:06.980 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:19.122 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:21.145 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:32.951 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:33.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:34.982 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173483995959296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:44:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173483995959296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:44:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173483995959296 [0;39m ==> Parameters:
2023-03-02 16:44:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173483995959296 [0;39m <==    Updates: 1
2023-03-02 16:44:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173483995959296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:44:37.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:43.179 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:44:45.198 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12173588824199168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:45:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173588824199168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:45:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173588824199168 [0;39m ==> Parameters:
2023-03-02 16:45:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173588824199168 [0;39m <==    Updates: 0
2023-03-02 16:45:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12173588824199168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:45:03.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:04.935 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173609816690688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:45:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173609816690688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:45:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173609816690688 [0;39m ==> Parameters:
2023-03-02 16:45:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173609816690688 [0;39m <==    Updates: 1
2023-03-02 16:45:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173609816690688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:45:06.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:10.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:32.934 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:33.470 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:34.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173735629033472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:45:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173735629033472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:45:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173735629033472 [0;39m ==> Parameters:
2023-03-02 16:45:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173735629033472 [0;39m <==    Updates: 1
2023-03-02 16:45:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173735629033472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:45:36.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:45:38.988 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12173840474050560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:46:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173840474050560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:46:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173840474050560 [0;39m ==> Parameters:
2023-03-02 16:46:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12173840474050560 [0;39m <==    Updates: 0
2023-03-02 16:46:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12173840474050560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:46:01.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:03.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:03.469 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173861449764864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:46:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173861449764864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:46:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173861449764864 [0;39m ==> Parameters:
2023-03-02 16:46:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173861449764864 [0;39m <==    Updates: 1
2023-03-02 16:46:05.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173861449764864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 16:46:05.052 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:07.086 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:09.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:25.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:27.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:32.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:33.484 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:34.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12173987299856384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:46:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173987299856384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:46:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173987299856384 [0;39m ==> Parameters:
2023-03-02 16:46:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12173987299856384 [0;39m <==    Updates: 1
2023-03-02 16:46:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12173987299856384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:46:37.011 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:49.120 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:46:51.154 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12174092165844992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:47:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174092165844992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:47:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174092165844992 [0;39m ==> Parameters:
2023-03-02 16:47:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174092165844992 [0;39m <==    Updates: 0
2023-03-02 16:47:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12174092165844992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:47:02.941 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:03.473 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:04.963 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174113124782080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:47:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174113124782080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:47:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174113124782080 [0;39m ==> Parameters:
2023-03-02 16:47:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174113124782080 [0;39m <==    Updates: 1
2023-03-02 16:47:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174113124782080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:47:07.008 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:13.195 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:15.243 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:32.921 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:33.485 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:34.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174238932930560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:47:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174238932930560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:47:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174238932930560 [0;39m ==> Parameters:
2023-03-02 16:47:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174238932930560 [0;39m <==    Updates: 1
2023-03-02 16:47:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174238932930560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:47:36.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:47:41.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12174343807307776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:48:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174343807307776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:48:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174343807307776 [0;39m ==> Parameters:
2023-03-02 16:48:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174343807307776 [0;39m <==    Updates: 0
2023-03-02 16:48:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12174343807307776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:48:02.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:03.468 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174364770439168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:48:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174364770439168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:48:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174364770439168 [0;39m ==> Parameters:
2023-03-02 16:48:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174364770439168 [0;39m <==    Updates: 1
2023-03-02 16:48:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174364770439168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:48:06.969 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:08.976 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:31.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:33.019 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:33.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174490628919296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:48:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174490628919296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:48:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174490628919296 [0;39m ==> Parameters:
2023-03-02 16:48:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174490628919296 [0;39m <==    Updates: 1
2023-03-02 16:48:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174490628919296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:48:37.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:39.085 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:55.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:48:57.089 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12174595452964864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:49:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174595452964864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:49:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174595452964864 [0;39m ==> Parameters:
2023-03-02 16:49:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174595452964864 [0;39m <==    Updates: 0
2023-03-02 16:49:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12174595452964864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:49:02.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:03.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174616420290560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:49:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174616420290560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:49:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174616420290560 [0;39m ==> Parameters:
2023-03-02 16:49:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174616420290560 [0;39m <==    Updates: 1
2023-03-02 16:49:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174616420290560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:49:07.010 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:19.118 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:21.152 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:32.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:33.491 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:34.968 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174742291353600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:49:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174742291353600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:49:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174742291353600 [0;39m ==> Parameters:
2023-03-02 16:49:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174742291353600 [0;39m <==    Updates: 1
2023-03-02 16:49:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174742291353600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:49:36.978 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:43.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:49:45.198 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12174847153147904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:50:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174847153147904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:50:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174847153147904 [0;39m ==> Parameters:
2023-03-02 16:50:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12174847153147904 [0;39m <==    Updates: 0
2023-03-02 16:50:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12174847153147904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:50:02.953 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:03.519 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:04.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174868103696384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:50:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174868103696384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:50:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174868103696384 [0;39m ==> Parameters:
2023-03-02 16:50:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174868103696384 [0;39m <==    Updates: 1
2023-03-02 16:50:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174868103696384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 16:50:06.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:08.998 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:11.009 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:32.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:33.488 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:34.981 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12174993932816384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:50:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174993932816384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:50:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174993932816384 [0;39m ==> Parameters:
2023-03-02 16:50:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12174993932816384 [0;39m <==    Updates: 1
2023-03-02 16:50:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12174993932816384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:50:37.025 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:50:39.049 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12175098807193600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:51:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175098807193600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:51:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175098807193600 [0;39m ==> Parameters:
2023-03-02 16:51:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175098807193600 [0;39m <==    Updates: 0
2023-03-02 16:51:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12175098807193600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:51:01.084 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:03.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:03.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175119778713600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:51:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175119778713600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:51:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175119778713600 [0;39m ==> Parameters:
2023-03-02 16:51:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175119778713600 [0;39m <==    Updates: 1
2023-03-02 16:51:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175119778713600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:51:07.168 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:09.199 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:25.160 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:27.185 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:32.919 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:33.482 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:34.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175245570084864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:51:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175245570084864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:51:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175245570084864 [0;39m ==> Parameters:
2023-03-02 16:51:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175245570084864 [0;39m <==    Updates: 1
2023-03-02 16:51:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175245570084864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:51:36.980 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:49.214 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:51:51.254 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12175350440267776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:52:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175350440267776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:52:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175350440267776 [0;39m ==> Parameters:
2023-03-02 16:52:00.034 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175350440267776 [0;39m <==    Updates: 0
2023-03-02 16:52:00.034 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12175350440267776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š25æ¯«ç§’
2023-03-02 16:52:02.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:03.492 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:04.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175371415982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:52:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175371415982080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:52:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175371415982080 [0;39m ==> Parameters:
2023-03-02 16:52:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175371415982080 [0;39m <==    Updates: 1
2023-03-02 16:52:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175371415982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 16:52:07.000 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:13.297 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:15.305 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:32.936 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:33.488 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:34.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175497245102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:52:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175497245102080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:52:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175497245102080 [0;39m ==> Parameters:
2023-03-02 16:52:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175497245102080 [0;39m <==    Updates: 1
2023-03-02 16:52:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175497245102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:52:36.970 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:38.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:52:41.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12175602119479296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:53:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175602119479296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:53:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175602119479296 [0;39m ==> Parameters:
2023-03-02 16:53:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175602119479296 [0;39m <==    Updates: 0
2023-03-02 16:53:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12175602119479296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:53:02.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:03.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:04.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175623036473344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:53:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175623036473344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:53:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175623036473344 [0;39m ==> Parameters:
2023-03-02 16:53:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175623036473344 [0;39m <==    Updates: 1
2023-03-02 16:53:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175623036473344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:53:06.966 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:09.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:31.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:33.079 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:33.505 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175748911730688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:53:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175748911730688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:53:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175748911730688 [0;39m ==> Parameters:
2023-03-02 16:53:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175748911730688 [0;39m <==    Updates: 1
2023-03-02 16:53:35.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175748911730688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:53:35.090 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:37.111 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:39.135 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:55.114 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:53:57.147 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12175853781913600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:54:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175853781913600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:54:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175853781913600 [0;39m ==> Parameters:
2023-03-02 16:54:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12175853781913600 [0;39m <==    Updates: 0
2023-03-02 16:54:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12175853781913600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:54:02.928 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:03.493 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:04.975 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12175874719879168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:54:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175874719879168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:54:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175874719879168 [0;39m ==> Parameters:
2023-03-02 16:54:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12175874719879168 [0;39m <==    Updates: 1
2023-03-02 16:54:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12175874719879168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:54:07.024 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:19.162 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:21.211 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:33.488 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:34.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176000548999168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:54:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176000548999168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:54:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176000548999168 [0;39m ==> Parameters:
2023-03-02 16:54:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176000548999168 [0;39m <==    Updates: 1
2023-03-02 16:54:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176000548999168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:54:36.973 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:54:45.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12176105398210560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:55:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176105398210560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:55:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176105398210560 [0;39m ==> Parameters:
2023-03-02 16:55:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176105398210560 [0;39m <==    Updates: 0
2023-03-02 16:55:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12176105398210560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 16:55:02.952 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:03.482 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:04.999 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176126411673600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:55:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176126411673600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:55:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176126411673600 [0;39m ==> Parameters:
2023-03-02 16:55:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176126411673600 [0;39m <==    Updates: 1
2023-03-02 16:55:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176126411673600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:55:07.030 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:09.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:11.068 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:33.484 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176252211433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:55:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176252211433472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:55:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176252211433472 [0;39m ==> Parameters:
2023-03-02 16:55:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176252211433472 [0;39m <==    Updates: 1
2023-03-02 16:55:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176252211433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:55:36.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:55:39.003 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12176357085810688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:56:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176357085810688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:56:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176357085810688 [0;39m ==> Parameters:
2023-03-02 16:56:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176357085810688 [0;39m <==    Updates: 0
2023-03-02 16:56:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12176357085810688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 16:56:03.073 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:03.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176378065719296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:56:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176378065719296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:56:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176378065719296 [0;39m ==> Parameters:
2023-03-02 16:56:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176378065719296 [0;39m <==    Updates: 1
2023-03-02 16:56:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176378065719296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:56:05.093 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:09.170 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:25.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:27.125 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:32.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:33.573 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:34.994 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176503882256384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:56:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176503882256384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:56:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176503882256384 [0;39m ==> Parameters:
2023-03-02 16:56:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176503882256384 [0;39m <==    Updates: 1
2023-03-02 16:56:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176503882256384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 16:56:37.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:49.171 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:56:51.201 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12176608702107648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:57:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176608702107648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:57:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176608702107648 [0;39m ==> Parameters:
2023-03-02 16:57:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176608702107648 [0;39m <==    Updates: 0
2023-03-02 16:57:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12176608702107648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:57:03.512 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:04.982 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176629719764992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:57:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176629719764992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:57:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176629719764992 [0;39m ==> Parameters:
2023-03-02 16:57:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176629719764992 [0;39m <==    Updates: 1
2023-03-02 16:57:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176629719764992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 16:57:07.030 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:13.259 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:15.303 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:33.522 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:34.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176755498553344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:57:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176755498553344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:57:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176755498553344 [0;39m ==> Parameters:
2023-03-02 16:57:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176755498553344 [0;39m <==    Updates: 1
2023-03-02 16:57:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176755498553344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:57:37.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:39.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:57:41.094 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12176860372930560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:58:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176860372930560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:58:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176860372930560 [0;39m ==> Parameters:
2023-03-02 16:58:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12176860372930560 [0;39m <==    Updates: 0
2023-03-02 16:58:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12176860372930560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-02 16:58:02.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:03.517 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:04.989 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12176881340256256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:58:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176881340256256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:58:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176881340256256 [0;39m ==> Parameters:
2023-03-02 16:58:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12176881340256256 [0;39m <==    Updates: 1
2023-03-02 16:58:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12176881340256256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:58:07.049 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:09.103 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:31.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:33.206 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:33.524 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177007202930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:58:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177007202930688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:58:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177007202930688 [0;39m ==> Parameters:
2023-03-02 16:58:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177007202930688 [0;39m <==    Updates: 1
2023-03-02 16:58:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177007202930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:58:35.248 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:39.297 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:55.269 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:58:57.329 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12177112047947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 16:59:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177112047947776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 16:59:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177112047947776 [0;39m ==> Parameters:
2023-03-02 16:59:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177112047947776 [0;39m <==    Updates: 0
2023-03-02 16:59:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12177112047947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:59:03.500 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177132998496256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:59:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177132998496256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:59:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177132998496256 [0;39m ==> Parameters:
2023-03-02 16:59:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177132998496256 [0;39m <==    Updates: 1
2023-03-02 16:59:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177132998496256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 16:59:07.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:19.359 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:21.386 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:32.937 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:33.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:34.976 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177258844393472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 16:59:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177258844393472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 16:59:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177258844393472 [0;39m ==> Parameters:
2023-03-02 16:59:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177258844393472 [0;39m <==    Updates: 1
2023-03-02 16:59:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177258844393472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 16:59:37.024 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 16:59:45.480 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12177363701993472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:00:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177363701993472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:00:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177363701993472 [0;39m ==> Parameters:
2023-03-02 17:00:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177363701993472 [0;39m <==    Updates: 0
2023-03-02 17:00:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12177363701993472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-02 17:00:03.480 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177384665124864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:00:05.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177384665124864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:00:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177384665124864 [0;39m ==> Parameters:
2023-03-02 17:00:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177384665124864 [0;39m <==    Updates: 1
2023-03-02 17:00:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177384665124864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:00:07.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:09.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:11.140 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:32.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:33.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:35.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177510469079040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:00:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177510469079040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:00:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177510469079040 [0;39m ==> Parameters:
2023-03-02 17:00:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177510469079040 [0;39m <==    Updates: 1
2023-03-02 17:00:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177510469079040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:00:37.049 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:00:39.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12177615381204992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:01:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177615381204992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:01:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177615381204992 [0;39m ==> Parameters:
2023-03-02 17:01:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177615381204992 [0;39m <==    Updates: 0
2023-03-02 17:01:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12177615381204992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:01:01.154 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:03.211 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:03.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177636331753472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:01:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177636331753472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:01:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177636331753472 [0;39m ==> Parameters:
2023-03-02 17:01:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177636331753472 [0;39m <==    Updates: 1
2023-03-02 17:01:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177636331753472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:01:07.287 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:09.344 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:25.276 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:27.320 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:32.919 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:33.487 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:34.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:35.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177762127319040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:01:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177762127319040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:01:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177762127319040 [0;39m ==> Parameters:
2023-03-02 17:01:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177762127319040 [0;39m <==    Updates: 1
2023-03-02 17:01:35.002 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177762127319040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 17:01:36.975 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:01:51.480 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12177867022667776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:02:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177867022667776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:02:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177867022667776 [0;39m ==> Parameters:
2023-03-02 17:02:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12177867022667776 [0;39m <==    Updates: 0
2023-03-02 17:02:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12177867022667776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 17:02:02.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:03.514 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:04.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12177887989993472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:02:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177887989993472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:02:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177887989993472 [0;39m ==> Parameters:
2023-03-02 17:02:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12177887989993472 [0;39m <==    Updates: 1
2023-03-02 17:02:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12177887989993472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 17:02:07.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:15.567 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:33.485 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:34.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178013789753344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:02:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178013789753344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:02:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178013789753344 [0;39m ==> Parameters:
2023-03-02 17:02:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178013789753344 [0;39m <==    Updates: 1
2023-03-02 17:02:35.004 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178013789753344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 17:02:37.232 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:02:41.319 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12178118689296384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:03:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178118689296384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:03:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178118689296384 [0;39m ==> Parameters:
2023-03-02 17:03:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178118689296384 [0;39m <==    Updates: 0
2023-03-02 17:03:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12178118689296384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:03:02.969 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:03.500 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178139635650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:03:05.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178139635650560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:03:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178139635650560 [0;39m ==> Parameters:
2023-03-02 17:03:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178139635650560 [0;39m <==    Updates: 1
2023-03-02 17:03:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178139635650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:03:07.062 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:09.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:31.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:33.179 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:33.508 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178265447993344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:03:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178265447993344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:03:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178265447993344 [0;39m ==> Parameters:
2023-03-02 17:03:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178265447993344 [0;39m <==    Updates: 1
2023-03-02 17:03:35.004 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178265447993344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 17:03:35.235 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:37.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:39.316 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:03:57.281 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12178370326564864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:04:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178370326564864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:04:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178370326564864 [0;39m ==> Parameters:
2023-03-02 17:04:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178370326564864 [0;39m <==    Updates: 0
2023-03-02 17:04:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12178370326564864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:04:02.974 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:03.519 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178391310667776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:04:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178391310667776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:04:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178391310667776 [0;39m ==> Parameters:
2023-03-02 17:04:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178391310667776 [0;39m <==    Updates: 1
2023-03-02 17:04:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178391310667776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:04:07.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:19.330 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:21.385 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:32.952 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:33.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178517123010560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:04:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178517123010560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:04:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178517123010560 [0;39m ==> Parameters:
2023-03-02 17:04:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178517123010560 [0;39m <==    Updates: 1
2023-03-02 17:04:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178517123010560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:04:37.045 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:04:45.524 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12178621997387776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:05:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178621997387776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:05:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178621997387776 [0;39m ==> Parameters:
2023-03-02 17:05:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178621997387776 [0;39m <==    Updates: 0
2023-03-02 17:05:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12178621997387776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:05:03.505 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178642989879296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:05:05.015 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178642989879296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:05:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178642989879296 [0;39m ==> Parameters:
2023-03-02 17:05:05.024 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178642989879296 [0;39m <==    Updates: 1
2023-03-02 17:05:05.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178642989879296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:05:09.103 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:11.142 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:33.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178768772861952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:05:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178768772861952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:05:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178768772861952 [0;39m ==> Parameters:
2023-03-02 17:05:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178768772861952 [0;39m <==    Updates: 1
2023-03-02 17:05:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178768772861952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:05:37.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:05:39.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12178873676599296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:06:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178873676599296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:06:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178873676599296 [0;39m ==> Parameters:
2023-03-02 17:06:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12178873676599296 [0;39m <==    Updates: 0
2023-03-02 17:06:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12178873676599296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:06:01.091 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:03.135 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:03.495 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12178894614564864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:06:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178894614564864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:06:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178894614564864 [0;39m ==> Parameters:
2023-03-02 17:06:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12178894614564864 [0;39m <==    Updates: 1
2023-03-02 17:06:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12178894614564864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 17:06:05.194 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:09.286 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:25.171 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:27.210 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:32.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:33.494 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:35.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179020447879168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:06:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179020447879168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:06:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179020447879168 [0;39m ==> Parameters:
2023-03-02 17:06:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179020447879168 [0;39m <==    Updates: 1
2023-03-02 17:06:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179020447879168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:06:37.038 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:49.255 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:06:51.298 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12179125284507648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:07:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179125284507648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:07:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179125284507648 [0;39m ==> Parameters:
2023-03-02 17:07:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179125284507648 [0;39m <==    Updates: 0
2023-03-02 17:07:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12179125284507648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-02 17:07:03.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:04.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179146256027648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:07:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179146256027648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:07:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179146256027648 [0;39m ==> Parameters:
2023-03-02 17:07:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179146256027648 [0;39m <==    Updates: 1
2023-03-02 17:07:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179146256027648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:07:07.033 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:13.356 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:15.387 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:32.952 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:33.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179272131284992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:07:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179272131284992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:07:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179272131284992 [0;39m ==> Parameters:
2023-03-02 17:07:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179272131284992 [0;39m <==    Updates: 1
2023-03-02 17:07:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179272131284992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-02 17:07:37.016 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:39.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:07:41.090 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12179376988884992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:08:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179376988884992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:08:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179376988884992 [0;39m ==> Parameters:
2023-03-02 17:08:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179376988884992 [0;39m <==    Updates: 0
2023-03-02 17:08:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12179376988884992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-02 17:08:03.503 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179397935239168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:08:05.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179397935239168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:08:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179397935239168 [0;39m ==> Parameters:
2023-03-02 17:08:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179397935239168 [0;39m <==    Updates: 1
2023-03-02 17:08:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179397935239168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:08:07.059 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:09.116 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:31.179 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:33.213 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:33.483 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179523768553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:08:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179523768553472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:08:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179523768553472 [0;39m ==> Parameters:
2023-03-02 17:08:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179523768553472 [0;39m <==    Updates: 1
2023-03-02 17:08:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179523768553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:08:35.256 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:37.304 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:39.349 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:55.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:08:57.315 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12179628600987648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:09:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179628600987648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:09:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179628600987648 [0;39m ==> Parameters:
2023-03-02 17:09:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179628600987648 [0;39m <==    Updates: 0
2023-03-02 17:09:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12179628600987648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:09:02.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:03.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:04.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179649593479168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:09:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179649593479168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:09:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179649593479168 [0;39m ==> Parameters:
2023-03-02 17:09:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179649593479168 [0;39m <==    Updates: 1
2023-03-02 17:09:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179649593479168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:09:07.045 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:19.364 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:21.400 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:32.958 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:33.503 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179775426793472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:09:35.010 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179775426793472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:09:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179775426793472 [0;39m ==> Parameters:
2023-03-02 17:09:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179775426793472 [0;39m <==    Updates: 1
2023-03-02 17:09:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179775426793472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:09:37.049 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:43.452 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:09:45.496 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12179880267616256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:10:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179880267616256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:10:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179880267616256 [0;39m ==> Parameters:
2023-03-02 17:10:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12179880267616256 [0;39m <==    Updates: 0
2023-03-02 17:10:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12179880267616256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:10:02.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:03.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12179901234941952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:10:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179901234941952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:10:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179901234941952 [0;39m ==> Parameters:
2023-03-02 17:10:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12179901234941952 [0;39m <==    Updates: 1
2023-03-02 17:10:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12179901234941952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:10:05.019 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:07.059 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:11.149 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:33.503 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:35.027 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12180027164725248 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:10:35.027 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180027164725248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:10:35.028 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180027164725248 [0;39m ==> Parameters:
2023-03-02 17:10:35.034 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180027164725248 [0;39m <==    Updates: 1
2023-03-02 17:10:35.035 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12180027164725248 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:10:37.039 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:10:39.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12180131913273344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:11:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12180131913273344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:11:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12180131913273344 [0;39m ==> Parameters:
2023-03-02 17:11:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12180131913273344 [0;39m <==    Updates: 0
2023-03-02 17:11:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12180131913273344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-02 17:11:01.123 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:03.163 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:03.521 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12180152909959168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:11:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180152909959168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:11:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180152909959168 [0;39m ==> Parameters:
2023-03-02 17:11:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180152909959168 [0;39m <==    Updates: 1
2023-03-02 17:11:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12180152909959168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:11:05.210 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:07.263 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:09.304 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:25.195 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:27.234 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:32.967 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:33.518 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:34.999 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12180278772633600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:11:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180278772633600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:11:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180278772633600 [0;39m ==> Parameters:
2023-03-02 17:11:35.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180278772633600 [0;39m <==    Updates: 1
2023-03-02 17:11:35.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12180278772633600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-02 17:11:37.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:11:51.335 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m12180383621844992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-02 17:12:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12180383621844992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-02 17:12:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12180383621844992 [0;39m ==> Parameters:
2023-03-02 17:12:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m12180383621844992 [0;39m <==    Updates: 0
2023-03-02 17:12:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m12180383621844992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-02 17:12:02.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:03.509 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:05.000 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:05.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12180404538839040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:12:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180404538839040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:12:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180404538839040 [0;39m ==> Parameters:
2023-03-02 17:12:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180404538839040 [0;39m <==    Updates: 1
2023-03-02 17:12:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12180404538839040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-02 17:12:07.046 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:13.407 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:15.434 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:32.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:33.531 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m12180530409902080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-02 17:12:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180530409902080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-02 17:12:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180530409902080 [0;39m ==> Parameters:
2023-03-02 17:12:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m12180530409902080 [0;39m <==    Updates: 1
2023-03-02 17:12:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m12180530409902080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-02 17:12:37.057 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-02 17:12:41.134 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
