2023-03-25 19:57:01.226 INFO  com.jiawa.wiki.WikiApplication                    :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_271 on LAPTOP-TLCI2GAA with PID 6480 (D:\work\jiawawiki\target\classes started by k in D:\work\jiawawiki)
2023-03-25 19:57:01.203 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2023-03-25 19:57:01.227 INFO  com.jiawa.wiki.WikiApplication                    :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2023-03-25 19:57:01.309 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2023-03-25 19:57:01.311 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2023-03-25 19:57:02.709 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2023-03-25 19:57:02.712 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2023-03-25 19:57:02.759 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 30 ms. Found 0 Redis repository interfaces.
2023-03-25 19:57:03.180 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.apache.rocketmq.spring.autoconfigure.RocketMQAutoConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQAutoConfiguration$$EnhancerBySpringCGLIB$$a07cc837] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.203 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.909 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'defaultMQProducer' of type [org.apache.rocketmq.client.producer.DefaultMQProducer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.911 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonConfig' of type [com.jiawa.wiki.config.JacksonConfig$$EnhancerBySpringCGLIB$$42b73d38] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.912 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.914 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.917 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties' of type [org.springframework.boot.autoconfigure.jackson.JacksonProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.918 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'standardJacksonObjectMapperBuilderCustomizer' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration$StandardJackson2ObjectMapperBuilderCustomizer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.920 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.923 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'parameterNamesModule' of type [com.fasterxml.jackson.module.paramnames.ParameterNamesModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.923 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.947 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jsonComponentModule' of type [org.springframework.boot.jackson.JsonComponentModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.953 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.data.web.config.SpringDataJacksonConfiguration' of type [org.springframework.data.web.config.SpringDataJacksonConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.979 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonGeoModule' of type [org.springframework.data.geo.GeoModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:03.984 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonObjectMapperBuilder' of type [org.springframework.http.converter.json.Jackson2ObjectMapperBuilder] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:04.000 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonObjectMapper' of type [com.fasterxml.jackson.databind.ObjectMapper] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:06.616 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'rocketMQTemplate' of type [org.apache.rocketmq.spring.core.RocketMQTemplate] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:06.618 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'transactionHandlerRegistry' of type [org.apache.rocketmq.spring.config.TransactionHandlerRegistry] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-03-25 19:57:07.337 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2023-03-25 19:57:07.346 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2023-03-25 19:57:07.347 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2023-03-25 19:57:07.347 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2023-03-25 19:57:07.477 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2023-03-25 19:57:07.477 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 6165 ms
2023-03-25 19:57:08.614 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2023-03-25 19:57:09.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:09.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:09.153 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2023-03-25 19:57:09.220 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2023-03-25 19:57:11.667 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:13.712 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:13.714 INFO  o.a.r.s.support.DefaultRocketMQListenerContainer  :243  [32m                  [0;39m running container: DefaultRocketMQListenerContainer{consumerGroup='default', nameServer='127.0.0.1:9876', topic='VOTE_TOPIC', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING}
2023-03-25 19:57:13.714 INFO  o.a.r.s.a.ListenerContainerConfiguration          :107  [32m                  [0;39m Register the listener to container, listenerBeanName:voteTopicConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2023-03-25 19:57:13.726 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2023-03-25 19:57:13.735 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2023-03-25 19:57:13.748 INFO  com.jiawa.wiki.WikiApplication                    :61   [32m                  [0;39m Started WikiApplication in 13.278 seconds (JVM running for 14.95)
2023-03-25 19:57:13.750 INFO  com.jiawa.wiki.WikiApplication                    :26   [32m                  [0;39m å¯åŠ¨æˆåŠŸï¼ï¼
2023-03-25 19:57:13.750 INFO  com.jiawa.wiki.WikiApplication                    :27   [32m                  [0;39m åœ°å€: 	http://127.0.0.1:8880
2023-03-25 19:57:17.775 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20556974940884992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 19:57:35.032 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m20556974940884992 [0;39m HikariPool-1 - Starting...
2023-03-25 19:57:35.168 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m20556974940884992 [0;39m HikariPool-1 - Start completed.
2023-03-25 19:57:35.175 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20556974940884992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 19:57:35.194 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20556974940884992 [0;39m ==> Parameters: 
2023-03-25 19:57:35.196 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20556974940884992 [0;39m <==    Updates: 1
2023-03-25 19:57:35.198 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20556974940884992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š184æ¯«ç§’
2023-03-25 19:57:38.774 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:42.586 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:44.641 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:57:54.933 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2023-03-25 19:57:54.933 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2023-03-25 19:57:54.934 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2023-03-25 19:57:54.977 INFO  com.jiawa.wiki.websocket.WebSocketServer          :32   [32m                  [0;39m æœ‰æ–°è¿žæŽ¥ï¼štokenï¼šLlo79pPd05ï¼Œsession idï¼š0ï¼Œå½“å‰è¿žæŽ¥æ•°ï¼š1
2023-03-25 19:57:55.031 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20557058898268162 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 19:57:55.031 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20557058898268161 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 19:57:55.031 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20557058898268160 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 19:57:55.032 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20557058898268162 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/category/all GET
2023-03-25 19:57:55.032 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20557058898268161 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2023-03-25 19:57:55.032 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20557058898268162 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.CategoryController.all
2023-03-25 19:57:55.032 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20557058898268161 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookSnapshotController.get30Statistic
2023-03-25 19:57:55.033 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20557058898268162 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 19:57:55.033 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20557058898268161 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 19:57:55.033 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20557058898268160 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2023-03-25 19:57:55.033 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20557058898268160 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookSnapshotController.getStatistic
2023-03-25 19:57:55.033 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20557058898268160 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 19:57:55.078 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20557058898268162 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 19:57:55.078 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20557058898268161 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 19:57:55.078 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20557058898268160 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 19:57:55.086 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20557058898268160 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2023-03-25 19:57:55.086 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20557058898268161 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2023-03-25 19:57:55.087 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20557058898268160 [0;39m ==> Parameters: 
2023-03-25 19:57:55.087 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20557058898268161 [0;39m ==> Parameters: 
2023-03-25 19:57:55.106 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20557058898268161 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2023-03-25 19:57:55.106 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20557058898268160 [0;39m <==      Total: 0
2023-03-25 19:57:55.107 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20557058898268161 [0;39m <==        Row: 2023-03-02, 0, 0
2023-03-25 19:57:55.110 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20557058898268161 [0;39m <==        Row: 2023-03-05, 8, 5
2023-03-25 19:57:55.111 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20557058898268161 [0;39m <==        Row: 2023-03-06, 1, 1
2023-03-25 19:57:55.111 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20557058898268161 [0;39m <==        Row: 2023-03-18, 10, 7
2023-03-25 19:57:55.112 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20557058898268161 [0;39m <==        Row: 2023-03-23, 10, 7
2023-03-25 19:57:55.113 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20557058898268161 [0;39m <==      Total: 5
2023-03-25 19:57:55.117 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20557058898268162 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2023-03-25 19:57:55.118 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20557058898268162 [0;39m ==> Parameters: 
2023-03-25 19:57:55.118 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==    Columns: id, parent, name, sort
2023-03-25 19:57:55.119 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 100, 0, å‰ç«¯å¼€å‘, 100
2023-03-25 19:57:55.120 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 101, 100, Vue, 101
2023-03-25 19:57:55.120 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2023-03-25 19:57:55.121 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 200, 0, Java, 200
2023-03-25 19:57:55.121 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 201, 200, åŸºç¡€åº”ç”¨, 201
2023-03-25 19:57:55.122 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 202, 200, æ¡†æž¶åº”ç”¨, 202
2023-03-25 19:57:55.123 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 300, 0, Python, 300
2023-03-25 19:57:55.124 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 301, 300, åŸºç¡€åº”ç”¨, 301
2023-03-25 19:57:55.125 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 302, 300, è¿›é˜¶æ–¹å‘åº”ç”¨, 302
2023-03-25 19:57:55.125 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 400, 0, æ•°æ®åº“, 400
2023-03-25 19:57:55.126 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 401, 400, MySQL, 401
2023-03-25 19:57:55.128 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 500, 0, å…¶å®ƒ, 500
2023-03-25 19:57:55.128 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 501, 500, æœåŠ¡å™¨, 501
2023-03-25 19:57:55.130 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 502, 500, å¼€å‘å·¥å…·, 502
2023-03-25 19:57:55.132 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20557058898268162 [0;39m <==        Row: 503, 500, çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€, 503
2023-03-25 19:57:55.133 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20557058898268162 [0;39m <==      Total: 15
2023-03-25 19:57:55.133 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20557058898268160 [0;39m è¿”å›žç»“æžœ: {"content":[],"success":true}
2023-03-25 19:57:55.134 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20557058898268160 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š105 ms -------------
2023-03-25 19:57:55.140 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20557058898268161 [0;39m è¿”å›žç»“æžœ: {"content":[{"date":1677686400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1677945600000,"viewCount":0,"viewIncrease":8,"voteCount":0,"voteIncrease":5},{"date":1678032000000,"viewCount":0,"viewIncrease":1,"voteCount":0,"voteIncrease":1},{"date":1679068800000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":7},{"date":1679500800000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":7}],"success":true}
2023-03-25 19:57:55.141 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20557058898268161 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š111 ms -------------
2023-03-25 19:57:55.153 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20557058898268162 [0;39m è¿”å›žç»“æžœ: {"content":[{"id":100,"name":"å‰ç«¯å¼€å‘","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"åŸºç¡€åº”ç”¨","parent":200,"sort":201},{"id":202,"name":"æ¡†æž¶åº”ç”¨","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"åŸºç¡€åº”ç”¨","parent":300,"sort":301},{"id":302,"name":"è¿›é˜¶æ–¹å‘åº”ç”¨","parent":300,"sort":302},{"id":400,"name":"æ•°æ®åº“","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"å…¶å®ƒ","parent":0,"sort":500},{"id":501,"name":"æœåŠ¡å™¨","parent":500,"sort":501},{"id":502,"name":"å¼€å‘å·¥å…·","parent":500,"sort":502},{"id":503,"name":"çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€","parent":500,"sort":503}],"success":true}
2023-03-25 19:57:55.153 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20557058898268162 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š123 ms -------------
2023-03-25 19:58:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20557079748153344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 19:58:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557079748153344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 19:58:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557079748153344 [0;39m ==> Parameters: 
2023-03-25 19:58:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557079748153344 [0;39m <==    Updates: 5
2023-03-25 19:58:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20557079748153344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 19:58:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557100736450560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 19:58:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557100736450560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 19:58:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557100736450560 [0;39m ==> Parameters: 
2023-03-25 19:58:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557100736450560 [0;39m <==    Updates: 1
2023-03-25 19:58:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557100736450560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 19:58:06.680 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:08.726 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:12.854 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:30.766 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:32.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557226603319296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 19:58:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557226603319296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 19:58:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557226603319296 [0;39m ==> Parameters: 
2023-03-25 19:58:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557226603319296 [0;39m <==    Updates: 1
2023-03-25 19:58:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557226603319296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 19:58:38.761 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:39.764 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:41.798 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:58:56.881 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20557331406393344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 19:59:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557331406393344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 19:59:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557331406393344 [0;39m ==> Parameters: 
2023-03-25 19:59:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557331406393344 [0;39m <==    Updates: 0
2023-03-25 19:59:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20557331406393344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 19:59:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557352398884864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 19:59:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557352398884864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 19:59:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557352398884864 [0;39m ==> Parameters: 
2023-03-25 19:59:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557352398884864 [0;39m <==    Updates: 1
2023-03-25 19:59:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557352398884864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 19:59:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:11.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:21.004 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557478211227648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 19:59:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557478211227648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 19:59:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557478211227648 [0;39m ==> Parameters: 
2023-03-25 19:59:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557478211227648 [0;39m <==    Updates: 1
2023-03-25 19:59:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557478211227648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 19:59:38.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:41.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:43.863 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 19:59:45.903 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20557583098187776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:00:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557583098187776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:00:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557583098187776 [0;39m ==> Parameters: 
2023-03-25 20:00:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557583098187776 [0;39m <==    Updates: 0
2023-03-25 20:00:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20557583098187776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-25 20:00:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557604073902080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:00:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557604073902080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:00:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557604073902080 [0;39m ==> Parameters: 
2023-03-25 20:00:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557604073902080 [0;39m <==    Updates: 1
2023-03-25 20:00:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557604073902080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:00:07.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:08.657 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:09.718 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:11.751 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:13.783 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557729886244864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:00:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557729886244864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:00:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557729886244864 [0;39m ==> Parameters: 
2023-03-25 20:00:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557729886244864 [0;39m <==    Updates: 1
2023-03-25 20:00:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557729886244864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:00:35.959 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:37.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:38.653 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:00:44.100 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20557834760622080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:01:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557834760622080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:01:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557834760622080 [0;39m ==> Parameters: 
2023-03-25 20:01:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20557834760622080 [0;39m <==    Updates: 0
2023-03-25 20:01:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20557834760622080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-25 20:01:02.085 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557855698587648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:01:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557855698587648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:01:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557855698587648 [0;39m ==> Parameters: 
2023-03-25 20:01:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557855698587648 [0;39m <==    Updates: 1
2023-03-25 20:01:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557855698587648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:01:07.734 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:08.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:11.834 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:24.119 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:26.163 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20557981569650688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:01:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557981569650688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:01:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557981569650688 [0;39m ==> Parameters: 
2023-03-25 20:01:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20557981569650688 [0;39m <==    Updates: 1
2023-03-25 20:01:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20557981569650688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:01:38.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:39.770 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:41.797 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:48.223 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:01:50.259 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20558086423056384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:02:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558086423056384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:02:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558086423056384 [0;39m ==> Parameters: 
2023-03-25 20:02:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558086423056384 [0;39m <==    Updates: 0
2023-03-25 20:02:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20558086423056384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-25 20:02:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558107377799168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:02:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558107377799168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:02:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558107377799168 [0;39m ==> Parameters: 
2023-03-25 20:02:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558107377799168 [0;39m <==    Updates: 1
2023-03-25 20:02:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558107377799168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:02:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:09.781 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:11.818 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:12.156 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20558137362878464 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:02:12.157 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20558137362878464 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/user/login POST
2023-03-25 20:02:12.157 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20558137362878464 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.UserController.login
2023-03-25 20:02:12.158 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20558137362878464 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:02:12.160 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20558137362878464 [0;39m è¯·æ±‚å‚æ•°: [{"loginName":"test"}]
2023-03-25 20:02:12.308 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558137362878464 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2023-03-25 20:02:12.309 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558137362878464 [0;39m ==> Parameters: test(String)
2023-03-25 20:02:12.309 TRACE com.jiawa.wiki.mapper.UserMapper.selectByExample  :143  [32m20558137362878464 [0;39m <==    Columns: id, login_name, name, password
2023-03-25 20:02:12.309 TRACE com.jiawa.wiki.mapper.UserMapper.selectByExample  :143  [32m20558137362878464 [0;39m <==        Row: 1, test, æµ‹è¯•, e70e2222a9d67c4f2eae107533359aa4
2023-03-25 20:02:12.310 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558137362878464 [0;39m <==      Total: 1
2023-03-25 20:02:12.316 INFO  com.jiawa.wiki.controller.UserController          :79   [32m20558137362878464 [0;39m ç”Ÿæˆå•ç‚¹ç™»å½•tokenï¼š20558138033967104ï¼Œå¹¶æ”¾å…¥redisä¸­
2023-03-25 20:02:13.863 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:14.511 ERROR com.jiawa.wiki.config.ControllerExceptionHandler  :59   [32m20558137362878464 [0;39m ç³»ç»Ÿå¼‚å¸¸ï¼š
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1553)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1461)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1247)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1230)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:979)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:359)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:131)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:94)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:81)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:216)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:189)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:96)
	at org.springframework.data.redis.core.DefaultValueOperations.set(DefaultValueOperations.java:256)
	at com.jiawa.wiki.controller.UserController.login(UserController.java:81)
	at com.jiawa.wiki.controller.UserController$$FastClassBySpringCGLIB$$5f26ceea.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.jiawa.wiki.aspect.LogAspect.doAround(LogAspect.java:86)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.jiawa.wiki.controller.UserController$$EnhancerBySpringCGLIB$$694bb2bb.login(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:320)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:211)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.util.Optional.orElseGet(Optional.java:267)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1459)
	... 86 common frames omitted
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: no further information: localhost/127.0.0.1:6379
Caused by: java.net.ConnectException: Connection refused: no further information
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:715)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:707)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2023-03-25 20:02:14.516 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m20558137362878464 [0;39m Resolved [org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost:6379]
2023-03-25 20:02:15.909 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:24.552 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20558189355470848 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:02:24.552 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20558189355470848 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/user/login POST
2023-03-25 20:02:24.552 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20558189355470848 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.UserController.login
2023-03-25 20:02:24.553 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20558189355470848 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:02:24.553 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20558189355470848 [0;39m è¯·æ±‚å‚æ•°: [{"loginName":"test"}]
2023-03-25 20:02:24.554 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558189355470848 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2023-03-25 20:02:24.555 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558189355470848 [0;39m ==> Parameters: test(String)
2023-03-25 20:02:24.555 TRACE com.jiawa.wiki.mapper.UserMapper.selectByExample  :143  [32m20558189355470848 [0;39m <==    Columns: id, login_name, name, password
2023-03-25 20:02:24.556 TRACE com.jiawa.wiki.mapper.UserMapper.selectByExample  :143  [32m20558189355470848 [0;39m <==        Row: 1, test, æµ‹è¯•, e70e2222a9d67c4f2eae107533359aa4
2023-03-25 20:02:24.556 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558189355470848 [0;39m <==      Total: 1
2023-03-25 20:02:24.557 INFO  com.jiawa.wiki.service.UserService                :136  [32m20558189355470848 [0;39m å¯†ç ä¸å¯¹, è¾“å…¥å¯†ç ï¼š51d6a530fa191428c43cd9e916854783, æ•°æ®åº“å¯†ç ï¼še70e2222a9d67c4f2eae107533359aa4
2023-03-25 20:02:24.557 WARN  com.jiawa.wiki.config.ControllerExceptionHandler  :44   [32m20558189355470848 [0;39m ä¸šåŠ¡å¼‚å¸¸ï¼šç”¨æˆ·åä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯
2023-03-25 20:02:24.559 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m20558189355470848 [0;39m Resolved [com.jiawa.wiki.exception.BusinessException: ç”¨æˆ·åä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯]
2023-03-25 20:02:29.468 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20558209974669312 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:02:29.468 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20558209974669312 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/user/login POST
2023-03-25 20:02:29.469 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20558209974669312 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.UserController.login
2023-03-25 20:02:29.469 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20558209974669312 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:02:29.470 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20558209974669312 [0;39m è¯·æ±‚å‚æ•°: [{"loginName":"test"}]
2023-03-25 20:02:29.472 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558209974669312 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2023-03-25 20:02:29.473 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558209974669312 [0;39m ==> Parameters: test(String)
2023-03-25 20:02:29.473 TRACE com.jiawa.wiki.mapper.UserMapper.selectByExample  :143  [32m20558209974669312 [0;39m <==    Columns: id, login_name, name, password
2023-03-25 20:02:29.474 TRACE com.jiawa.wiki.mapper.UserMapper.selectByExample  :143  [32m20558209974669312 [0;39m <==        Row: 1, test, æµ‹è¯•, e70e2222a9d67c4f2eae107533359aa4
2023-03-25 20:02:29.474 DEBUG com.jiawa.wiki.mapper.UserMapper.selectByExample  :137  [32m20558209974669312 [0;39m <==      Total: 1
2023-03-25 20:02:29.474 INFO  com.jiawa.wiki.controller.UserController          :79   [32m20558209974669312 [0;39m ç”Ÿæˆå•ç‚¹ç™»å½•tokenï¼š20558209999835136ï¼Œå¹¶æ”¾å…¥redisä¸­
2023-03-25 20:02:29.514 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20558209974669312 [0;39m è¿”å›žç»“æžœ: {"content":{"id":1,"loginName":"test","name":"æµ‹è¯•","token":"20558209999835136"},"success":true}
2023-03-25 20:02:29.515 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20558209974669312 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š47 ms -------------
2023-03-25 20:02:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558233227890688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:02:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558233227890688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:02:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558233227890688 [0;39m ==> Parameters: 
2023-03-25 20:02:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558233227890688 [0;39m <==    Updates: 1
2023-03-25 20:02:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558233227890688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:02:38.673 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:39.778 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:41.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:02:43.877 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20558338072907776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:03:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558338072907776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:03:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558338072907776 [0;39m ==> Parameters: 
2023-03-25 20:03:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558338072907776 [0;39m <==    Updates: 0
2023-03-25 20:03:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20558338072907776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:03:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558359044427776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:03:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558359044427776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:03:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558359044427776 [0;39m ==> Parameters: 
2023-03-25 20:03:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558359044427776 [0;39m <==    Updates: 1
2023-03-25 20:03:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558359044427776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:03:07.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:08.690 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:12.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:14.104 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:30.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:32.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558484860964864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:03:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558484860964864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:03:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558484860964864 [0;39m ==> Parameters: 
2023-03-25 20:03:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558484860964864 [0;39m <==    Updates: 1
2023-03-25 20:03:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558484860964864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:03:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:38.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:41.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:03:56.176 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:00.000 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20558589693399040 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:04:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558589693399040 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:04:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558589693399040 [0;39m ==> Parameters: 
2023-03-25 20:04:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558589693399040 [0;39m <==    Updates: 0
2023-03-25 20:04:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20558589693399040 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:04:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558610732027904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:04:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558610732027904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:04:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558610732027904 [0;39m ==> Parameters: 
2023-03-25 20:04:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558610732027904 [0;39m <==    Updates: 1
2023-03-25 20:04:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558610732027904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:04:07.712 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:08.671 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:09.747 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:11.786 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:18.263 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:20.298 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558736548564992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:04:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558736548564992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:04:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558736548564992 [0;39m ==> Parameters: 
2023-03-25 20:04:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558736548564992 [0;39m <==    Updates: 1
2023-03-25 20:04:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558736548564992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š1æ¯«ç§’
2023-03-25 20:04:38.696 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:41.816 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:43.864 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:04:45.914 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20558841397776384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:05:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558841397776384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:05:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558841397776384 [0;39m ==> Parameters: 
2023-03-25 20:05:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20558841397776384 [0;39m <==    Updates: 0
2023-03-25 20:05:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20558841397776384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:05:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558862335741952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:05:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558862335741952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:05:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558862335741952 [0;39m ==> Parameters: 
2023-03-25 20:05:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558862335741952 [0;39m <==    Updates: 1
2023-03-25 20:05:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558862335741952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:05:07.719 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:08.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:11.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:13.860 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20558988206804992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:05:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558988206804992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:05:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558988206804992 [0;39m ==> Parameters: 
2023-03-25 20:05:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20558988206804992 [0;39m <==    Updates: 1
2023-03-25 20:05:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20558988206804992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:05:35.915 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:37.967 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:38.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:40.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:42.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:05:44.080 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:00.030 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20559093135708160 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:06:00.032 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559093135708160 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:06:00.032 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559093135708160 [0;39m ==> Parameters: 
2023-03-25 20:06:00.045 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559093135708160 [0;39m <==    Updates: 0
2023-03-25 20:06:00.047 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20559093135708160 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š17æ¯«ç§’
2023-03-25 20:06:02.089 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559114006564864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:06:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559114006564864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:06:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559114006564864 [0;39m ==> Parameters: 
2023-03-25 20:06:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559114006564864 [0;39m <==    Updates: 1
2023-03-25 20:06:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559114006564864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:06:07.712 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:08.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:11.816 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:26.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559239852462080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:06:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559239852462080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:06:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559239852462080 [0;39m ==> Parameters: 
2023-03-25 20:06:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559239852462080 [0;39m <==    Updates: 1
2023-03-25 20:06:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559239852462080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:06:37.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:41.834 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:48.211 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:06:50.266 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20559344701673472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:07:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559344701673472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:07:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559344701673472 [0;39m ==> Parameters: 
2023-03-25 20:07:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559344701673472 [0;39m <==    Updates: 0
2023-03-25 20:07:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20559344701673472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:07:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559365673193472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:07:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559365673193472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:07:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559365673193472 [0;39m ==> Parameters: 
2023-03-25 20:07:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559365673193472 [0;39m <==    Updates: 1
2023-03-25 20:07:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559365673193472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:07:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:11.825 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:13.877 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:15.927 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559491489730560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:07:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559491489730560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:07:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559491489730560 [0;39m ==> Parameters: 
2023-03-25 20:07:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559491489730560 [0;39m <==    Updates: 1
2023-03-25 20:07:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559491489730560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:07:37.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:38.664 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:39.752 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:41.783 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:07:43.821 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20559596368302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:08:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559596368302080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:08:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559596368302080 [0;39m ==> Parameters: 
2023-03-25 20:08:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559596368302080 [0;39m <==    Updates: 0
2023-03-25 20:08:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20559596368302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:08:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559617318850560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:08:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559617318850560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:08:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559617318850560 [0;39m ==> Parameters: 
2023-03-25 20:08:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559617318850560 [0;39m <==    Updates: 1
2023-03-25 20:08:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559617318850560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:08:05.872 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:07.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:12.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:14.065 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:31.971 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559743135387648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:08:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559743135387648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:08:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559743135387648 [0;39m ==> Parameters: 
2023-03-25 20:08:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559743135387648 [0;39m <==    Updates: 1
2023-03-25 20:08:35.006 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559743135387648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:08:37.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:38.661 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:41.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:54.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:08:56.079 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20559848005570560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:09:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559848005570560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:09:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559848005570560 [0;39m ==> Parameters: 
2023-03-25 20:09:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20559848005570560 [0;39m <==    Updates: 0
2023-03-25 20:09:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20559848005570560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:09:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559868960313344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:09:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559868960313344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:09:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559868960313344 [0;39m ==> Parameters: 
2023-03-25 20:09:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559868960313344 [0;39m <==    Updates: 1
2023-03-25 20:09:05.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559868960313344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:09:07.724 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:08.693 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:11.807 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:18.141 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:20.199 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20559994839764992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:09:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559994839764992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:09:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559994839764992 [0;39m ==> Parameters: 
2023-03-25 20:09:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20559994839764992 [0;39m <==    Updates: 1
2023-03-25 20:09:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20559994839764992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:09:38.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:41.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:43.880 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:09:45.929 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20560099659616256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:10:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560099659616256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:10:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560099659616256 [0;39m ==> Parameters: 
2023-03-25 20:10:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560099659616256 [0;39m <==    Updates: 0
2023-03-25 20:10:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20560099659616256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:10:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560120681467904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:10:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560120681467904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:10:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560120681467904 [0;39m ==> Parameters: 
2023-03-25 20:10:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560120681467904 [0;39m <==    Updates: 1
2023-03-25 20:10:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560120681467904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š1æ¯«ç§’
2023-03-25 20:10:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:11.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:13.867 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:35.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560246510587904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:10:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560246510587904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:10:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560246510587904 [0;39m ==> Parameters: 
2023-03-25 20:10:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560246510587904 [0;39m <==    Updates: 1
2023-03-25 20:10:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560246510587904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:10:35.936 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:37.984 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:38.695 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:40.033 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:10:44.124 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20560351359799296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:11:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560351359799296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:11:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560351359799296 [0;39m ==> Parameters: 
2023-03-25 20:11:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560351359799296 [0;39m <==    Updates: 0
2023-03-25 20:11:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20560351359799296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:11:00.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:02.080 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560372314542080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:11:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560372314542080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:11:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560372314542080 [0;39m ==> Parameters: 
2023-03-25 20:11:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560372314542080 [0;39m <==    Updates: 1
2023-03-25 20:11:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560372314542080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:11:07.724 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:08.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:09.767 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:11.805 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:26.182 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560498156244992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:11:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560498156244992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:11:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560498156244992 [0;39m ==> Parameters: 
2023-03-25 20:11:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560498156244992 [0;39m <==    Updates: 1
2023-03-25 20:11:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560498156244992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:11:38.666 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:39.770 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:41.812 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:48.249 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:11:50.279 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20560602992873472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:12:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560602992873472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:12:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560602992873472 [0;39m ==> Parameters: 
2023-03-25 20:12:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560602992873472 [0;39m <==    Updates: 0
2023-03-25 20:12:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20560602992873472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:12:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560623943421952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:12:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560623943421952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:12:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560623943421952 [0;39m ==> Parameters: 
2023-03-25 20:12:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560623943421952 [0;39m <==    Updates: 1
2023-03-25 20:12:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560623943421952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:12:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:09.789 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:11.832 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:15.924 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560749772541952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:12:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560749772541952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:12:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560749772541952 [0;39m ==> Parameters: 
2023-03-25 20:12:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560749772541952 [0;39m <==    Updates: 1
2023-03-25 20:12:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560749772541952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:12:38.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:41.809 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:12:43.854 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20560854625947648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:13:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560854625947648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:13:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560854625947648 [0;39m ==> Parameters: 
2023-03-25 20:13:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20560854625947648 [0;39m <==    Updates: 0
2023-03-25 20:13:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20560854625947648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:13:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20560875597467648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:13:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560875597467648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:13:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560875597467648 [0;39m ==> Parameters: 
2023-03-25 20:13:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20560875597467648 [0;39m <==    Updates: 1
2023-03-25 20:13:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20560875597467648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:13:07.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:08.690 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:10.010 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:12.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:14.078 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:30.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:32.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561001468530688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:13:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561001468530688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:13:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561001468530688 [0;39m ==> Parameters: 
2023-03-25 20:13:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561001468530688 [0;39m <==    Updates: 1
2023-03-25 20:13:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561001468530688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:13:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:39.760 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:41.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:54.120 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:13:56.166 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20561106334519296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:14:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561106334519296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:14:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561106334519296 [0;39m ==> Parameters: 
2023-03-25 20:14:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561106334519296 [0;39m <==    Updates: 0
2023-03-25 20:14:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20561106334519296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:14:05.020 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561127314427904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:14:05.027 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561127314427904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:14:05.029 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561127314427904 [0;39m ==> Parameters: 
2023-03-25 20:14:05.036 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561127314427904 [0;39m <==    Updates: 1
2023-03-25 20:14:05.036 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561127314427904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š16æ¯«ç§’
2023-03-25 20:14:07.724 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:08.673 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:09.765 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:11.822 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:18.213 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:20.242 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561253130964992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:14:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561253130964992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:14:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561253130964992 [0;39m ==> Parameters: 
2023-03-25 20:14:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561253130964992 [0;39m <==    Updates: 1
2023-03-25 20:14:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561253130964992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:14:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:38.690 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:41.814 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:43.860 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:14:45.906 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20561357996953600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:15:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561357996953600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:15:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561357996953600 [0;39m ==> Parameters: 
2023-03-25 20:15:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561357996953600 [0;39m <==    Updates: 0
2023-03-25 20:15:00.024 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20561357996953600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:15:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561378930724864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:15:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561378930724864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:15:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561378930724864 [0;39m ==> Parameters: 
2023-03-25 20:15:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561378930724864 [0;39m <==    Updates: 1
2023-03-25 20:15:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561378930724864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:15:07.710 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:08.690 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:11.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:13.852 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561504747261952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:15:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561504747261952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:15:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561504747261952 [0;39m ==> Parameters: 
2023-03-25 20:15:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561504747261952 [0;39m <==    Updates: 1
2023-03-25 20:15:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561504747261952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:15:37.967 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:38.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:40.018 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:42.057 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:15:44.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20561609667776512 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:16:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561609667776512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:16:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561609667776512 [0;39m ==> Parameters: 
2023-03-25 20:16:00.030 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561609667776512 [0;39m <==    Updates: 0
2023-03-25 20:16:00.031 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20561609667776512 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-25 20:16:00.033 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:02.084 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561630601547776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:16:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561630601547776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:16:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561630601547776 [0;39m ==> Parameters: 
2023-03-25 20:16:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561630601547776 [0;39m <==    Updates: 1
2023-03-25 20:16:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561630601547776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:16:07.743 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:08.693 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:11.845 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:24.142 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:26.195 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561756413890560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:16:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561756413890560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:16:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561756413890560 [0;39m ==> Parameters: 
2023-03-25 20:16:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561756413890560 [0;39m <==    Updates: 1
2023-03-25 20:16:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561756413890560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:16:37.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:38.665 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:41.841 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:16:50.252 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20561861284073472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:17:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561861284073472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:17:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561861284073472 [0;39m ==> Parameters: 
2023-03-25 20:17:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20561861284073472 [0;39m <==    Updates: 0
2023-03-25 20:17:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20561861284073472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š13æ¯«ç§’
2023-03-25 20:17:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20561882272370688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:17:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561882272370688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:17:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561882272370688 [0;39m ==> Parameters: 
2023-03-25 20:17:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20561882272370688 [0;39m <==    Updates: 1
2023-03-25 20:17:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20561882272370688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:17:07.743 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:09.787 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:11.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:15.928 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562008097296384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:17:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562008097296384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:17:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562008097296384 [0;39m ==> Parameters: 
2023-03-25 20:17:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562008097296384 [0;39m <==    Updates: 1
2023-03-25 20:17:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562008097296384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:17:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:41.811 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:17:43.861 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20562112942313472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:18:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562112942313472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:18:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562112942313472 [0;39m ==> Parameters: 
2023-03-25 20:18:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562112942313472 [0;39m <==    Updates: 0
2023-03-25 20:18:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20562112942313472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:18:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562133913833472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:18:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562133913833472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:18:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562133913833472 [0;39m ==> Parameters: 
2023-03-25 20:18:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562133913833472 [0;39m <==    Updates: 1
2023-03-25 20:18:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562133913833472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:18:07.972 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:10.012 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:12.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:14.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:32.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:35.020 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562259793285120 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:18:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562259793285120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:18:35.036 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562259793285120 [0;39m ==> Parameters: 
2023-03-25 20:18:35.049 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562259793285120 [0;39m <==    Updates: 1
2023-03-25 20:18:35.049 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562259793285120 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š29æ¯«ç§’
2023-03-25 20:18:38.740 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:41.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:54.128 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:18:56.185 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20562364608942080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:19:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562364608942080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:19:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562364608942080 [0;39m ==> Parameters: 
2023-03-25 20:19:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562364608942080 [0;39m <==    Updates: 0
2023-03-25 20:19:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20562364608942080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 20:19:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562385551101952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:19:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562385551101952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:19:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562385551101952 [0;39m ==> Parameters: 
2023-03-25 20:19:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562385551101952 [0;39m <==    Updates: 1
2023-03-25 20:19:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562385551101952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:19:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:08.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:09.786 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:11.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:18.234 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:20.266 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562511380221952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:19:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562511380221952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:19:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562511380221952 [0;39m ==> Parameters: 
2023-03-25 20:19:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562511380221952 [0;39m <==    Updates: 1
2023-03-25 20:19:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562511380221952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:19:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:38.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:41.823 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:19:45.906 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20562616271376384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:20:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562616271376384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:20:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562616271376384 [0;39m ==> Parameters: 
2023-03-25 20:20:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562616271376384 [0;39m <==    Updates: 0
2023-03-25 20:20:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20562616271376384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 20:20:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562637230313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:20:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562637230313472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:20:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562637230313472 [0;39m ==> Parameters: 
2023-03-25 20:20:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562637230313472 [0;39m <==    Updates: 1
2023-03-25 20:20:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562637230313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:20:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:08.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:09.769 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:11.806 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:13.842 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562763067822080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:20:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562763067822080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:20:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562763067822080 [0;39m ==> Parameters: 
2023-03-25 20:20:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562763067822080 [0;39m <==    Updates: 1
2023-03-25 20:20:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562763067822080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:20:35.898 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:37.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:38.664 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:42.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:20:44.081 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20562867929616384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:21:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562867929616384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:21:00.012 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562867929616384 [0;39m ==> Parameters: 
2023-03-25 20:21:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20562867929616384 [0;39m <==    Updates: 0
2023-03-25 20:21:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20562867929616384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:21:02.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20562888875970560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:21:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562888875970560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:21:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562888875970560 [0;39m ==> Parameters: 
2023-03-25 20:21:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20562888875970560 [0;39m <==    Updates: 1
2023-03-25 20:21:05.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20562888875970560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:21:07.737 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:08.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:09.790 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:11.832 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:24.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:26.162 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563014730256384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:21:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563014730256384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:21:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563014730256384 [0;39m ==> Parameters: 
2023-03-25 20:21:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563014730256384 [0;39m <==    Updates: 1
2023-03-25 20:21:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563014730256384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:21:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:39.780 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:41.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:50.256 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:21:54.206 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563095239921664 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:54.207 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563095239921664 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/category/all GET
2023-03-25 20:21:54.207 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563095239921664 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.CategoryController.all
2023-03-25 20:21:54.207 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563095239921664 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:54.207 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563095239921664 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:21:54.208 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563095239921664 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2023-03-25 20:21:54.208 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563095239921664 [0;39m ==> Parameters: 
2023-03-25 20:21:54.209 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==    Columns: id, parent, name, sort
2023-03-25 20:21:54.209 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 100, 0, å‰ç«¯å¼€å‘, 100
2023-03-25 20:21:54.210 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 101, 100, Vue, 101
2023-03-25 20:21:54.210 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2023-03-25 20:21:54.212 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 200, 0, Java, 200
2023-03-25 20:21:54.212 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 201, 200, åŸºç¡€åº”ç”¨, 201
2023-03-25 20:21:54.212 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 202, 200, æ¡†æž¶åº”ç”¨, 202
2023-03-25 20:21:54.213 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 300, 0, Python, 300
2023-03-25 20:21:54.213 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 301, 300, åŸºç¡€åº”ç”¨, 301
2023-03-25 20:21:54.213 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 302, 300, è¿›é˜¶æ–¹å‘åº”ç”¨, 302
2023-03-25 20:21:54.213 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 400, 0, æ•°æ®åº“, 400
2023-03-25 20:21:54.214 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 401, 400, MySQL, 401
2023-03-25 20:21:54.214 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 500, 0, å…¶å®ƒ, 500
2023-03-25 20:21:54.215 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 501, 500, æœåŠ¡å™¨, 501
2023-03-25 20:21:54.215 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 502, 500, å¼€å‘å·¥å…·, 502
2023-03-25 20:21:54.215 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563095239921664 [0;39m <==        Row: 503, 500, çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€, 503
2023-03-25 20:21:54.216 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563095239921664 [0;39m <==      Total: 15
2023-03-25 20:21:54.218 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563095239921664 [0;39m è¿”å›žç»“æžœ: {"content":[{"id":100,"name":"å‰ç«¯å¼€å‘","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"åŸºç¡€åº”ç”¨","parent":200,"sort":201},{"id":202,"name":"æ¡†æž¶åº”ç”¨","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"åŸºç¡€åº”ç”¨","parent":300,"sort":301},{"id":302,"name":"è¿›é˜¶æ–¹å‘åº”ç”¨","parent":300,"sort":302},{"id":400,"name":"æ•°æ®åº“","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"å…¶å®ƒ","parent":0,"sort":500},{"id":501,"name":"æœåŠ¡å™¨","parent":500,"sort":501},{"id":502,"name":"å¼€å‘å·¥å…·","parent":500,"sort":502},{"id":503,"name":"çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€","parent":500,"sort":503}],"success":true}
2023-03-25 20:21:54.218 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563095239921664 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š12 ms -------------
2023-03-25 20:21:54.277 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563095537717248 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:54.277 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563095537717248 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook/list GET
2023-03-25 20:21:54.277 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563095537717248 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookController.list
2023-03-25 20:21:54.278 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563095537717248 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:54.280 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563095537717248 [0;39m è¯·æ±‚å‚æ•°: [{"page":1,"size":10}]
2023-03-25 20:21:54.314 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563095537717248 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-03-25 20:21:54.315 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563095537717248 [0;39m ==> Parameters: 
2023-03-25 20:21:54.316 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563095537717248 [0;39m <==    Columns: count(0)
2023-03-25 20:21:54.316 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563095537717248 [0;39m <==        Row: 5
2023-03-25 20:21:54.316 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563095537717248 [0;39m <==      Total: 1
2023-03-25 20:21:54.319 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563095537717248 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-03-25 20:21:54.320 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563095537717248 [0;39m ==> Parameters: 10(Integer)
2023-03-25 20:21:54.321 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563095537717248 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-03-25 20:21:54.321 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563095537717248 [0;39m <==        Row: 1, Spring Boot å…¥é—¨æ•™ç¨‹, 200, 202, é›¶åŸºç¡€å…¥é—¨ Java å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 6, 10, 7
2023-03-25 20:21:54.321 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563095537717248 [0;39m <==        Row: 2, Vue å…¥é—¨æ•™ç¨‹, 100, 101, é›¶åŸºç¡€å…¥é—¨ Vue å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 0, 0, 0
2023-03-25 20:21:54.322 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563095537717248 [0;39m <==        Row: 3, Python å…¥é—¨æ•™ç¨‹, 300, 301, é›¶åŸºç¡€å…¥é—¨ Python å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 0, 0, 0
2023-03-25 20:21:54.322 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563095537717248 [0;39m <==        Row: 4, Mysql å…¥é—¨æ•™ç¨‹, 400, 401, é›¶åŸºç¡€å…¥é—¨ Mysql å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 0, 0, 0
2023-03-25 20:21:54.322 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563095537717248 [0;39m <==        Row: 5, Oracle å…¥é—¨æ•™ç¨‹, null, null, é›¶åŸºç¡€å…¥é—¨ Oracle å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 0, 0, 0
2023-03-25 20:21:54.322 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563095537717248 [0;39m <==      Total: 5
2023-03-25 20:21:54.324 INFO  com.jiawa.wiki.service.EbookService               :48   [32m20563095537717248 [0;39m æ€»è¡Œæ•°ï¼š5
2023-03-25 20:21:54.324 INFO  com.jiawa.wiki.service.EbookService               :49   [32m20563095537717248 [0;39m æ€»é¡µæ•°ï¼š1
2023-03-25 20:21:54.333 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563095537717248 [0;39m è¿”å›žç»“æžœ: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"é›¶åŸºç¡€å…¥é—¨ Java å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":6,"id":1,"name":"Spring Boot å…¥é—¨æ•™ç¨‹","viewCount":10,"voteCount":7},{"category1Id":100,"category2Id":101,"description":"é›¶åŸºç¡€å…¥é—¨ Vue å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":0,"id":2,"name":"Vue å…¥é—¨æ•™ç¨‹","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"é›¶åŸºç¡€å…¥é—¨ Python å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":0,"id":3,"name":"Python å…¥é—¨æ•™ç¨‹","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"é›¶åŸºç¡€å…¥é—¨ Mysql å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":0,"id":4,"name":"Mysql å…¥é—¨æ•™ç¨‹","viewCount":0,"voteCount":0},{"description":"é›¶åŸºç¡€å…¥é—¨ Oracle å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":0,"id":5,"name":"Oracle å…¥é—¨æ•™ç¨‹","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-03-25 20:21:54.333 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563095537717248 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š56 ms -------------
2023-03-25 20:21:55.063 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563098834440192 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563098838634496 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563098834440192 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/category/all GET
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563098838634496 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563098834440192 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.CategoryController.all
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563098838634496 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookSnapshotController.getStatistic
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563098834440192 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563098838634497 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563098838634497 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563098834440192 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563098838634497 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookSnapshotController.get30Statistic
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563098838634497 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:55.065 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563098838634497 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:21:55.064 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563098838634496 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:55.065 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563098834440192 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2023-03-25 20:21:55.065 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563098838634496 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:21:55.065 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20563098838634497 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2023-03-25 20:21:55.065 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563098834440192 [0;39m ==> Parameters: 
2023-03-25 20:21:55.066 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20563098838634497 [0;39m ==> Parameters: 
2023-03-25 20:21:55.066 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==    Columns: id, parent, name, sort
2023-03-25 20:21:55.066 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563098838634497 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2023-03-25 20:21:55.066 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 100, 0, å‰ç«¯å¼€å‘, 100
2023-03-25 20:21:55.067 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563098838634497 [0;39m <==        Row: 2023-03-02, 0, 0
2023-03-25 20:21:55.067 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 101, 100, Vue, 101
2023-03-25 20:21:55.067 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2023-03-25 20:21:55.067 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563098838634497 [0;39m <==        Row: 2023-03-05, 8, 5
2023-03-25 20:21:55.067 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 200, 0, Java, 200
2023-03-25 20:21:55.067 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563098838634497 [0;39m <==        Row: 2023-03-06, 1, 1
2023-03-25 20:21:55.067 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 201, 200, åŸºç¡€åº”ç”¨, 201
2023-03-25 20:21:55.068 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 202, 200, æ¡†æž¶åº”ç”¨, 202
2023-03-25 20:21:55.068 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563098838634497 [0;39m <==        Row: 2023-03-18, 10, 7
2023-03-25 20:21:55.068 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 300, 0, Python, 300
2023-03-25 20:21:55.068 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563098838634497 [0;39m <==        Row: 2023-03-23, 10, 7
2023-03-25 20:21:55.068 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20563098838634496 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2023-03-25 20:21:55.069 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20563098838634497 [0;39m <==      Total: 5
2023-03-25 20:21:55.068 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 301, 300, åŸºç¡€åº”ç”¨, 301
2023-03-25 20:21:55.069 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 302, 300, è¿›é˜¶æ–¹å‘åº”ç”¨, 302
2023-03-25 20:21:55.069 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563098838634497 [0;39m è¿”å›žç»“æžœ: {"content":[{"date":1677686400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1677945600000,"viewCount":0,"viewIncrease":8,"voteCount":0,"voteIncrease":5},{"date":1678032000000,"viewCount":0,"viewIncrease":1,"voteCount":0,"voteIncrease":1},{"date":1679068800000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":7},{"date":1679500800000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":7}],"success":true}
2023-03-25 20:21:55.069 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 400, 0, æ•°æ®åº“, 400
2023-03-25 20:21:55.069 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563098838634497 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š5 ms -------------
2023-03-25 20:21:55.069 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 401, 400, MySQL, 401
2023-03-25 20:21:55.070 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 500, 0, å…¶å®ƒ, 500
2023-03-25 20:21:55.070 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 501, 500, æœåŠ¡å™¨, 501
2023-03-25 20:21:55.070 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 502, 500, å¼€å‘å·¥å…·, 502
2023-03-25 20:21:55.070 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563098834440192 [0;39m <==        Row: 503, 500, çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€, 503
2023-03-25 20:21:55.069 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20563098838634496 [0;39m ==> Parameters: 
2023-03-25 20:21:55.071 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563098834440192 [0;39m <==      Total: 15
2023-03-25 20:21:55.072 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563098834440192 [0;39m è¿”å›žç»“æžœ: {"content":[{"id":100,"name":"å‰ç«¯å¼€å‘","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"åŸºç¡€åº”ç”¨","parent":200,"sort":201},{"id":202,"name":"æ¡†æž¶åº”ç”¨","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"åŸºç¡€åº”ç”¨","parent":300,"sort":301},{"id":302,"name":"è¿›é˜¶æ–¹å‘åº”ç”¨","parent":300,"sort":302},{"id":400,"name":"æ•°æ®åº“","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"å…¶å®ƒ","parent":0,"sort":500},{"id":501,"name":"æœåŠ¡å™¨","parent":500,"sort":501},{"id":502,"name":"å¼€å‘å·¥å…·","parent":500,"sort":502},{"id":503,"name":"çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€","parent":500,"sort":503}],"success":true}
2023-03-25 20:21:55.072 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563098834440192 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š9 ms -------------
2023-03-25 20:21:55.072 TRACE c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m20563098838634496 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2023-03-25 20:21:55.072 TRACE c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m20563098838634496 [0;39m <==        Row: 2023-03-25, 10, 7, 10, 7
2023-03-25 20:21:55.072 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20563098838634496 [0;39m <==      Total: 1
2023-03-25 20:21:55.073 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563098838634496 [0;39m è¿”å›žç»“æžœ: {"content":[{"date":1679673600000,"viewCount":10,"viewIncrease":10,"voteCount":7,"voteIncrease":7}],"success":true}
2023-03-25 20:21:55.073 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563098838634496 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š9 ms -------------
2023-03-25 20:21:56.224 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563103704027136 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:56.225 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563103704027136 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook/list GET
2023-03-25 20:21:56.225 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563103704027136 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookController.list
2023-03-25 20:21:56.225 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563103704027136 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:56.225 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563103704027136 [0;39m è¯·æ±‚å‚æ•°: [{"categoryId2":301,"page":1,"size":1000}]
2023-03-25 20:21:56.244 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563103704027136 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2023-03-25 20:21:56.245 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563103704027136 [0;39m ==> Parameters: 301(Long)
2023-03-25 20:21:56.246 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563103704027136 [0;39m <==    Columns: count(0)
2023-03-25 20:21:56.248 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563103704027136 [0;39m <==        Row: 1
2023-03-25 20:21:56.248 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563103704027136 [0;39m <==      Total: 1
2023-03-25 20:21:56.249 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563103704027136 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2023-03-25 20:21:56.249 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563103704027136 [0;39m ==> Parameters: 301(Long), 1000(Integer)
2023-03-25 20:21:56.249 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563103704027136 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-03-25 20:21:56.250 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563103704027136 [0;39m <==        Row: 3, Python å…¥é—¨æ•™ç¨‹, 300, 301, é›¶åŸºç¡€å…¥é—¨ Python å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 0, 0, 0
2023-03-25 20:21:56.250 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563103704027136 [0;39m <==      Total: 1
2023-03-25 20:21:56.250 INFO  com.jiawa.wiki.service.EbookService               :48   [32m20563103704027136 [0;39m æ€»è¡Œæ•°ï¼š1
2023-03-25 20:21:56.250 INFO  com.jiawa.wiki.service.EbookService               :49   [32m20563103704027136 [0;39m æ€»é¡µæ•°ï¼š1
2023-03-25 20:21:56.251 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563103704027136 [0;39m è¿”å›žç»“æžœ: {"content":{"list":[{"category1Id":300,"category2Id":301,"description":"é›¶åŸºç¡€å…¥é—¨ Python å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":0,"id":3,"name":"Python å…¥é—¨æ•™ç¨‹","viewCount":0,"voteCount":0}],"total":1},"success":true}
2023-03-25 20:21:56.251 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563103704027136 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š27 ms -------------
2023-03-25 20:21:57.808 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563110347804672 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:57.809 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563110347804672 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook/list GET
2023-03-25 20:21:57.809 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563110347804672 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookController.list
2023-03-25 20:21:57.809 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563110347804672 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:57.810 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563110347804672 [0;39m è¯·æ±‚å‚æ•°: [{"categoryId2":201,"page":1,"size":1000}]
2023-03-25 20:21:57.812 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563110347804672 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2023-03-25 20:21:57.813 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563110347804672 [0;39m ==> Parameters: 201(Long)
2023-03-25 20:21:57.814 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563110347804672 [0;39m <==    Columns: count(0)
2023-03-25 20:21:57.814 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563110347804672 [0;39m <==        Row: 0
2023-03-25 20:21:57.814 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563110347804672 [0;39m <==      Total: 1
2023-03-25 20:21:57.816 INFO  com.jiawa.wiki.service.EbookService               :48   [32m20563110347804672 [0;39m æ€»è¡Œæ•°ï¼š0
2023-03-25 20:21:57.816 INFO  com.jiawa.wiki.service.EbookService               :49   [32m20563110347804672 [0;39m æ€»é¡µæ•°ï¼š0
2023-03-25 20:21:57.816 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563110347804672 [0;39m è¿”å›žç»“æžœ: {"content":{"list":[],"total":0},"success":true}
2023-03-25 20:21:57.816 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563110347804672 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š8 ms -------------
2023-03-25 20:21:58.392 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563112797278208 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:58.392 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563112797278208 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook/list GET
2023-03-25 20:21:58.392 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563112797278208 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookController.list
2023-03-25 20:21:58.392 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563112797278208 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:58.392 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563112797278208 [0;39m è¯·æ±‚å‚æ•°: [{"categoryId2":202,"page":1,"size":1000}]
2023-03-25 20:21:58.394 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563112797278208 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2023-03-25 20:21:58.394 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563112797278208 [0;39m ==> Parameters: 202(Long)
2023-03-25 20:21:58.396 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563112797278208 [0;39m <==    Columns: count(0)
2023-03-25 20:21:58.396 TRACE c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m20563112797278208 [0;39m <==        Row: 1
2023-03-25 20:21:58.396 DEBUG c.j.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m20563112797278208 [0;39m <==      Total: 1
2023-03-25 20:21:58.397 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563112797278208 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2023-03-25 20:21:58.398 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563112797278208 [0;39m ==> Parameters: 202(Long), 1000(Integer)
2023-03-25 20:21:58.398 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563112797278208 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-03-25 20:21:58.398 TRACE com.jiawa.wiki.mapper.EbookMapper.selectByExample :143  [32m20563112797278208 [0;39m <==        Row: 1, Spring Boot å…¥é—¨æ•™ç¨‹, 200, 202, é›¶åŸºç¡€å…¥é—¨ Java å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶, null, 6, 10, 7
2023-03-25 20:21:58.399 DEBUG com.jiawa.wiki.mapper.EbookMapper.selectByExample :137  [32m20563112797278208 [0;39m <==      Total: 1
2023-03-25 20:21:58.399 INFO  com.jiawa.wiki.service.EbookService               :48   [32m20563112797278208 [0;39m æ€»è¡Œæ•°ï¼š1
2023-03-25 20:21:58.399 INFO  com.jiawa.wiki.service.EbookService               :49   [32m20563112797278208 [0;39m æ€»é¡µæ•°ï¼š1
2023-03-25 20:21:58.399 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563112797278208 [0;39m è¿”å›žç»“æžœ: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"é›¶åŸºç¡€å…¥é—¨ Java å¼€å‘ï¼Œä¼ä¸šçº§åº”ç”¨å¼€å‘æœ€ä½³é¦–é€‰æ¡†æž¶","docCount":6,"id":1,"name":"Spring Boot å…¥é—¨æ•™ç¨‹","viewCount":10,"voteCount":7}],"total":1},"success":true}
2023-03-25 20:21:58.399 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563112797278208 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š7 ms -------------
2023-03-25 20:21:59.322 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563116697980928 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:59.322 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563116697980928 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/doc/all/1 GET
2023-03-25 20:21:59.322 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563116697980928 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.DocController.all
2023-03-25 20:21:59.323 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563116697980928 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:59.323 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563116697980928 [0;39m è¯·æ±‚å‚æ•°: [1]
2023-03-25 20:21:59.329 DEBUG com.jiawa.wiki.mapper.DocMapper.selectByExample   :137  [32m20563116697980928 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2023-03-25 20:21:59.330 DEBUG com.jiawa.wiki.mapper.DocMapper.selectByExample   :137  [32m20563116697980928 [0;39m ==> Parameters: 1(Long)
2023-03-25 20:21:59.331 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2023-03-25 20:21:59.331 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==        Row: 1, 1, 0, æ–‡æ¡£1, 1, 5, 3
2023-03-25 20:21:59.332 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==        Row: 2, 1, 1, æ–‡æ¡£1.1, 1, 1, 1
2023-03-25 20:21:59.332 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==        Row: 4, 1, 3, æ–‡æ¡£2.1, 1, 2, 1
2023-03-25 20:21:59.332 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==        Row: 6, 1, 5, æ–‡æ¡£2.2.1, 1, 1, 1
2023-03-25 20:21:59.333 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==        Row: 3, 1, 0, æ–‡æ¡£2, 2, 0, 0
2023-03-25 20:21:59.333 TRACE com.jiawa.wiki.mapper.DocMapper.selectByExample   :143  [32m20563116697980928 [0;39m <==        Row: 5, 1, 3, æ–‡æ¡£2.2, 2, 1, 1
2023-03-25 20:21:59.333 DEBUG com.jiawa.wiki.mapper.DocMapper.selectByExample   :137  [32m20563116697980928 [0;39m <==      Total: 6
2023-03-25 20:21:59.343 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563116697980928 [0;39m è¿”å›žç»“æžœ: {"content":[{"ebookId":1,"id":1,"name":"æ–‡æ¡£1","parent":0,"sort":1,"viewCount":5,"voteCount":3},{"ebookId":1,"id":2,"name":"æ–‡æ¡£1.1","parent":1,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":4,"name":"æ–‡æ¡£2.1","parent":3,"sort":1,"viewCount":2,"voteCount":1},{"ebookId":1,"id":6,"name":"æ–‡æ¡£2.2.1","parent":5,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":3,"name":"æ–‡æ¡£2","parent":0,"sort":2,"viewCount":0,"voteCount":0},{"ebookId":1,"id":5,"name":"æ–‡æ¡£2.2","parent":3,"sort":2,"viewCount":1,"voteCount":1}],"success":true}
2023-03-25 20:21:59.344 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563116697980928 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š22 ms -------------
2023-03-25 20:21:59.380 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563116941250560 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:21:59.380 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563116941250560 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/doc/find-content/1 GET
2023-03-25 20:21:59.380 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563116941250560 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.DocController.findContent
2023-03-25 20:21:59.381 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563116941250560 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:21:59.381 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563116941250560 [0;39m è¯·æ±‚å‚æ•°: [1]
2023-03-25 20:21:59.381 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563116941250560 [0;39m ==>  Preparing: select id , content from content where id = ?
2023-03-25 20:21:59.383 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563116941250560 [0;39m ==> Parameters: 1(Long)
2023-03-25 20:21:59.384 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563116941250560 [0;39m <==      Total: 0
2023-03-25 20:21:59.385 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563116941250560 [0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2023-03-25 20:21:59.386 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563116941250560 [0;39m ==> Parameters: 1(Long)
2023-03-25 20:21:59.386 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563116941250560 [0;39m <==    Updates: 1
2023-03-25 20:21:59.387 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563116941250560 [0;39m è¿”å›žç»“æžœ: {"content":"","success":true}
2023-03-25 20:21:59.387 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563116941250560 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š7 ms -------------
2023-03-25 20:22:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20563119583662080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:22:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563119583662080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:22:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563119583662080 [0;39m ==> Parameters: 
2023-03-25 20:22:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563119583662080 [0;39m <==    Updates: 0
2023-03-25 20:22:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20563119583662080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:22:00.446 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563121408184320 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:22:00.446 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563121408184320 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/doc/find-content/2 GET
2023-03-25 20:22:00.446 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563121408184320 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.DocController.findContent
2023-03-25 20:22:00.446 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563121408184320 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:22:00.446 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563121408184320 [0;39m è¯·æ±‚å‚æ•°: [2]
2023-03-25 20:22:00.446 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563121408184320 [0;39m ==>  Preparing: select id , content from content where id = ?
2023-03-25 20:22:00.447 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563121408184320 [0;39m ==> Parameters: 2(Long)
2023-03-25 20:22:00.447 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563121408184320 [0;39m <==      Total: 0
2023-03-25 20:22:00.447 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563121408184320 [0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2023-03-25 20:22:00.448 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563121408184320 [0;39m ==> Parameters: 2(Long)
2023-03-25 20:22:00.454 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563121408184320 [0;39m <==    Updates: 1
2023-03-25 20:22:00.456 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563121408184320 [0;39m è¿”å›žç»“æžœ: {"content":"","success":true}
2023-03-25 20:22:00.456 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563121408184320 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š11 ms -------------
2023-03-25 20:22:01.327 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563125107560448 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:22:01.328 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563125107560448 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/doc/find-content/1 GET
2023-03-25 20:22:01.329 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563125107560448 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.DocController.findContent
2023-03-25 20:22:01.329 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563125107560448 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:22:01.329 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563125107560448 [0;39m è¯·æ±‚å‚æ•°: [1]
2023-03-25 20:22:01.330 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563125107560448 [0;39m ==>  Preparing: select id , content from content where id = ?
2023-03-25 20:22:01.330 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563125107560448 [0;39m ==> Parameters: 1(Long)
2023-03-25 20:22:01.331 DEBUG c.j.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m20563125107560448 [0;39m <==      Total: 0
2023-03-25 20:22:01.332 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563125107560448 [0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2023-03-25 20:22:01.332 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563125107560448 [0;39m ==> Parameters: 1(Long)
2023-03-25 20:22:01.334 DEBUG c.j.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m20563125107560448 [0;39m <==    Updates: 1
2023-03-25 20:22:01.334 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563125107560448 [0;39m è¿”å›žç»“æžœ: {"content":"","success":true}
2023-03-25 20:22:01.334 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563125107560448 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š7 ms -------------
2023-03-25 20:22:02.448 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563129809375232 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:22:02.449 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563129809375232 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2023-03-25 20:22:02.449 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563129809375232 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookSnapshotController.get30Statistic
2023-03-25 20:22:02.448 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563129809375233 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:22:02.449 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563129809375232 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:22:02.449 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563129809375233 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2023-03-25 20:22:02.449 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563129809375232 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:22:02.449 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563129809375233 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.EbookSnapshotController.getStatistic
2023-03-25 20:22:02.450 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563129809375233 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:22:02.450 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563129809375233 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:22:02.450 INFO  com.jiawa.wiki.aspect.LogAspect                   :53   [32m20563129817763840 [0;39m ------------- å¼€å§‹ -------------
2023-03-25 20:22:02.450 INFO  com.jiawa.wiki.aspect.LogAspect                   :54   [32m20563129817763840 [0;39m è¯·æ±‚åœ°å€: http://127.0.0.1:8880/category/all GET
2023-03-25 20:22:02.450 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20563129809375232 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2023-03-25 20:22:02.450 INFO  com.jiawa.wiki.aspect.LogAspect                   :55   [32m20563129817763840 [0;39m ç±»åæ–¹æ³•: com.jiawa.wiki.controller.CategoryController.all
2023-03-25 20:22:02.451 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20563129809375233 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2023-03-25 20:22:02.451 INFO  com.jiawa.wiki.aspect.LogAspect                   :56   [32m20563129817763840 [0;39m è¿œç¨‹åœ°å€: 127.0.0.1
2023-03-25 20:22:02.451 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20563129809375233 [0;39m ==> Parameters: 
2023-03-25 20:22:02.451 INFO  com.jiawa.wiki.aspect.LogAspect                   :78   [32m20563129817763840 [0;39m è¯·æ±‚å‚æ•°: []
2023-03-25 20:22:02.451 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20563129809375232 [0;39m ==> Parameters: 
2023-03-25 20:22:02.452 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563129817763840 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2023-03-25 20:22:02.452 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563129817763840 [0;39m ==> Parameters: 
2023-03-25 20:22:02.452 TRACE c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m20563129809375233 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2023-03-25 20:22:02.453 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==    Columns: id, parent, name, sort
2023-03-25 20:22:02.453 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563129809375232 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2023-03-25 20:22:02.453 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 100, 0, å‰ç«¯å¼€å‘, 100
2023-03-25 20:22:02.452 TRACE c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m20563129809375233 [0;39m <==        Row: 2023-03-25, 10, 7, 10, 7
2023-03-25 20:22:02.453 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563129809375232 [0;39m <==        Row: 2023-03-02, 0, 0
2023-03-25 20:22:02.453 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 101, 100, Vue, 101
2023-03-25 20:22:02.453 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m20563129809375233 [0;39m <==      Total: 1
2023-03-25 20:22:02.453 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2023-03-25 20:22:02.453 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563129809375233 [0;39m è¿”å›žç»“æžœ: {"content":[{"date":1679673600000,"viewCount":10,"viewIncrease":10,"voteCount":7,"voteIncrease":7}],"success":true}
2023-03-25 20:22:02.453 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 200, 0, Java, 200
2023-03-25 20:22:02.454 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563129809375233 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š6 ms -------------
2023-03-25 20:22:02.454 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 201, 200, åŸºç¡€åº”ç”¨, 201
2023-03-25 20:22:02.454 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 202, 200, æ¡†æž¶åº”ç”¨, 202
2023-03-25 20:22:02.454 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 300, 0, Python, 300
2023-03-25 20:22:02.454 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 301, 300, åŸºç¡€åº”ç”¨, 301
2023-03-25 20:22:02.454 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563129809375232 [0;39m <==        Row: 2023-03-05, 8, 5
2023-03-25 20:22:02.454 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 302, 300, è¿›é˜¶æ–¹å‘åº”ç”¨, 302
2023-03-25 20:22:02.454 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 400, 0, æ•°æ®åº“, 400
2023-03-25 20:22:02.455 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 401, 400, MySQL, 401
2023-03-25 20:22:02.455 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 500, 0, å…¶å®ƒ, 500
2023-03-25 20:22:02.455 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 501, 500, æœåŠ¡å™¨, 501
2023-03-25 20:22:02.456 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 502, 500, å¼€å‘å·¥å…·, 502
2023-03-25 20:22:02.456 TRACE c.jiawa.wiki.mapper.CategoryMapper.selectByExample:143  [32m20563129817763840 [0;39m <==        Row: 503, 500, çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€, 503
2023-03-25 20:22:02.456 DEBUG c.jiawa.wiki.mapper.CategoryMapper.selectByExample:137  [32m20563129817763840 [0;39m <==      Total: 15
2023-03-25 20:22:02.457 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563129817763840 [0;39m è¿”å›žç»“æžœ: {"content":[{"id":100,"name":"å‰ç«¯å¼€å‘","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"åŸºç¡€åº”ç”¨","parent":200,"sort":201},{"id":202,"name":"æ¡†æž¶åº”ç”¨","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"åŸºç¡€åº”ç”¨","parent":300,"sort":301},{"id":302,"name":"è¿›é˜¶æ–¹å‘åº”ç”¨","parent":300,"sort":302},{"id":400,"name":"æ•°æ®åº“","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"å…¶å®ƒ","parent":0,"sort":500},{"id":501,"name":"æœåŠ¡å™¨","parent":500,"sort":501},{"id":502,"name":"å¼€å‘å·¥å…·","parent":500,"sort":502},{"id":503,"name":"çƒ­é—¨æœåŠ¡ç«¯è¯­è¨€","parent":500,"sort":503}],"success":true}
2023-03-25 20:22:02.457 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563129817763840 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š7 ms -------------
2023-03-25 20:22:02.461 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563129809375232 [0;39m <==        Row: 2023-03-06, 1, 1
2023-03-25 20:22:02.461 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563129809375232 [0;39m <==        Row: 2023-03-18, 10, 7
2023-03-25 20:22:02.464 TRACE c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m20563129809375232 [0;39m <==        Row: 2023-03-23, 10, 7
2023-03-25 20:22:02.464 DEBUG c.j.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m20563129809375232 [0;39m <==      Total: 5
2023-03-25 20:22:02.465 INFO  com.jiawa.wiki.aspect.LogAspect                   :93   [32m20563129809375232 [0;39m è¿”å›žç»“æžœ: {"content":[{"date":1677686400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1677945600000,"viewCount":0,"viewIncrease":8,"voteCount":0,"voteIncrease":5},{"date":1678032000000,"viewCount":0,"viewIncrease":1,"voteCount":0,"voteIncrease":1},{"date":1679068800000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":7},{"date":1679500800000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":7}],"success":true}
2023-03-25 20:22:02.465 INFO  com.jiawa.wiki.aspect.LogAspect                   :94   [32m20563129809375232 [0;39m ------------- ç»“æŸ è€—æ—¶ï¼š17 ms -------------
2023-03-25 20:22:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563140559376384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:22:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563140559376384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:22:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563140559376384 [0;39m ==> Parameters: 
2023-03-25 20:22:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563140559376384 [0;39m <==    Updates: 1
2023-03-25 20:22:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563140559376384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:22:07.722 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:08.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:11.805 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:15.894 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563266350747648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:22:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563266350747648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:22:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563266350747648 [0;39m ==> Parameters: 
2023-03-25 20:22:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563266350747648 [0;39m <==    Updates: 1
2023-03-25 20:22:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563266350747648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 20:22:37.718 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:38.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:39.758 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:41.803 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:43.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:22:59.999 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20563371195764736 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:23:00.000 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563371195764736 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:23:00.001 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563371195764736 [0;39m ==> Parameters: 
2023-03-25 20:23:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563371195764736 [0;39m <==    Updates: 0
2023-03-25 20:23:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20563371195764736 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:23:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563392209227776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:23:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563392209227776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:23:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563392209227776 [0;39m ==> Parameters: 
2023-03-25 20:23:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563392209227776 [0;39m <==    Updates: 1
2023-03-25 20:23:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563392209227776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:23:05.901 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:07.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:08.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:09.988 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:12.011 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:14.064 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:30.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:32.049 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563518008987648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:23:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563518008987648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:23:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563518008987648 [0;39m ==> Parameters: 
2023-03-25 20:23:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563518008987648 [0;39m <==    Updates: 1
2023-03-25 20:23:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563518008987648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:23:37.720 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:38.688 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:39.773 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:41.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:54.096 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:23:56.144 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20563622879170560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:24:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563622879170560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:24:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563622879170560 [0;39m ==> Parameters: 
2023-03-25 20:24:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563622879170560 [0;39m <==    Updates: 0
2023-03-25 20:24:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20563622879170560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:24:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563643838107648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:24:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563643838107648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:24:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563643838107648 [0;39m ==> Parameters: 
2023-03-25 20:24:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563643838107648 [0;39m <==    Updates: 1
2023-03-25 20:24:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563643838107648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:24:07.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:08.670 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:11.822 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:18.173 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:20.226 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:35.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563769658839040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:24:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563769658839040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:24:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563769658839040 [0;39m ==> Parameters: 
2023-03-25 20:24:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563769658839040 [0;39m <==    Updates: 1
2023-03-25 20:24:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563769658839040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:24:38.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:39.778 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:41.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:43.873 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:24:45.908 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20563874566770688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:25:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563874566770688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:25:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563874566770688 [0;39m ==> Parameters: 
2023-03-25 20:25:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20563874566770688 [0;39m <==    Updates: 0
2023-03-25 20:25:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20563874566770688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:25:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20563895496347648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:25:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563895496347648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:25:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563895496347648 [0;39m ==> Parameters: 
2023-03-25 20:25:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20563895496347648 [0;39m <==    Updates: 1
2023-03-25 20:25:05.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20563895496347648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:25:08.671 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:09.762 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:11.795 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:13.843 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564021354827776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:25:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564021354827776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:25:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564021354827776 [0;39m ==> Parameters: 
2023-03-25 20:25:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564021354827776 [0;39m <==    Updates: 1
2023-03-25 20:25:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564021354827776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:25:35.897 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:37.936 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:38.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:42.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:44.073 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:25:59.958 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20564126195650560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:26:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564126195650560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:26:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564126195650560 [0;39m ==> Parameters: 
2023-03-25 20:26:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564126195650560 [0;39m <==    Updates: 0
2023-03-25 20:26:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20564126195650560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:26:02.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564147179753472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:26:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564147179753472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:26:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564147179753472 [0;39m ==> Parameters: 
2023-03-25 20:26:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564147179753472 [0;39m <==    Updates: 1
2023-03-25 20:26:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564147179753472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:26:07.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:08.693 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:09.779 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:11.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:24.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:26.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564273038233600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:26:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564273038233600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:26:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564273038233600 [0;39m ==> Parameters: 
2023-03-25 20:26:35.025 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564273038233600 [0;39m <==    Updates: 1
2023-03-25 20:26:35.025 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564273038233600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:26:37.737 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:38.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:39.790 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:41.830 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:26:50.212 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20564377858084864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:27:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564377858084864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:27:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564377858084864 [0;39m ==> Parameters: 
2023-03-25 20:27:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564377858084864 [0;39m <==    Updates: 0
2023-03-25 20:27:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20564377858084864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:27:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564398817021952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:27:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564398817021952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:27:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564398817021952 [0;39m ==> Parameters: 
2023-03-25 20:27:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564398817021952 [0;39m <==    Updates: 1
2023-03-25 20:27:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564398817021952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:27:07.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:08.673 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:09.778 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:11.822 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:13.865 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:15.903 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564524650336256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:27:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564524650336256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:27:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564524650336256 [0;39m ==> Parameters: 
2023-03-25 20:27:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564524650336256 [0;39m <==    Updates: 1
2023-03-25 20:27:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564524650336256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:27:37.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:38.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:39.782 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:41.835 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:27:43.886 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20564629499547648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:28:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564629499547648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:28:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564629499547648 [0;39m ==> Parameters: 
2023-03-25 20:28:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564629499547648 [0;39m <==    Updates: 0
2023-03-25 20:28:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20564629499547648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-25 20:28:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564650487844864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:28:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564650487844864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:28:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564650487844864 [0;39m ==> Parameters: 
2023-03-25 20:28:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564650487844864 [0;39m <==    Updates: 1
2023-03-25 20:28:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564650487844864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:28:05.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:07.996 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:08.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:10.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:12.093 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:14.145 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:30.042 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:32.077 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564776304381952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:28:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564776304381952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:28:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564776304381952 [0;39m ==> Parameters: 
2023-03-25 20:28:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564776304381952 [0;39m <==    Updates: 1
2023-03-25 20:28:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564776304381952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:28:37.721 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:38.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:41.795 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:54.129 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:28:56.178 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20564881187147776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:29:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564881187147776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:29:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564881187147776 [0;39m ==> Parameters: 
2023-03-25 20:29:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20564881187147776 [0;39m <==    Updates: 0
2023-03-25 20:29:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20564881187147776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:29:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20564902129307648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:29:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564902129307648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:29:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564902129307648 [0;39m ==> Parameters: 
2023-03-25 20:29:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20564902129307648 [0;39m <==    Updates: 1
2023-03-25 20:29:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20564902129307648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:29:07.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:09.781 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:11.831 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:20.269 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565027962621952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:29:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565027962621952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:29:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565027962621952 [0;39m ==> Parameters: 
2023-03-25 20:29:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565027962621952 [0;39m <==    Updates: 1
2023-03-25 20:29:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565027962621952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:29:38.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:39.773 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:41.813 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:43.858 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:29:45.909 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20565132816027648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:30:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565132816027648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:30:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565132816027648 [0;39m ==> Parameters: 
2023-03-25 20:30:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565132816027648 [0;39m <==    Updates: 0
2023-03-25 20:30:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20565132816027648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:30:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565153795936256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:30:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565153795936256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:30:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565153795936256 [0;39m ==> Parameters: 
2023-03-25 20:30:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565153795936256 [0;39m <==    Updates: 1
2023-03-25 20:30:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565153795936256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:30:07.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:08.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:09.761 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:11.804 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:13.849 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565279650222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:30:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565279650222080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:30:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565279650222080 [0;39m ==> Parameters: 
2023-03-25 20:30:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565279650222080 [0;39m <==    Updates: 1
2023-03-25 20:30:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565279650222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:30:35.906 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:37.949 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:38.667 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:39.984 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:42.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:30:44.068 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20565384495239168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:31:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565384495239168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:31:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565384495239168 [0;39m ==> Parameters: 
2023-03-25 20:31:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565384495239168 [0;39m <==    Updates: 0
2023-03-25 20:31:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20565384495239168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:31:02.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565405500313600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:31:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565405500313600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:31:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565405500313600 [0;39m ==> Parameters: 
2023-03-25 20:31:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565405500313600 [0;39m <==    Updates: 1
2023-03-25 20:31:05.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565405500313600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:31:08.668 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:09.773 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:11.809 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:24.116 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:26.165 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565531283296256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:31:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565531283296256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:31:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565531283296256 [0;39m ==> Parameters: 
2023-03-25 20:31:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565531283296256 [0;39m <==    Updates: 1
2023-03-25 20:31:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565531283296256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:31:37.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:38.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:41.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:48.209 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:31:50.264 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20565636182839296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:32:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565636182839296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:32:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565636182839296 [0;39m ==> Parameters: 
2023-03-25 20:32:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565636182839296 [0;39m <==    Updates: 0
2023-03-25 20:32:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20565636182839296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:32:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565657137582080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:32:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565657137582080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:32:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565657137582080 [0;39m ==> Parameters: 
2023-03-25 20:32:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565657137582080 [0;39m <==    Updates: 1
2023-03-25 20:32:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565657137582080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:32:07.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:08.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:09.777 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:11.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:15.903 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565782962507776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:32:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565782962507776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:32:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565782962507776 [0;39m ==> Parameters: 
2023-03-25 20:32:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565782962507776 [0;39m <==    Updates: 1
2023-03-25 20:32:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565782962507776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:32:37.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:38.659 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:39.775 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:41.817 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:32:43.874 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20565887824302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:33:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565887824302080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:33:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565887824302080 [0;39m ==> Parameters: 
2023-03-25 20:33:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20565887824302080 [0;39m <==    Updates: 0
2023-03-25 20:33:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20565887824302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:33:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20565908812599296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:33:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565908812599296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:33:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565908812599296 [0;39m ==> Parameters: 
2023-03-25 20:33:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20565908812599296 [0;39m <==    Updates: 1
2023-03-25 20:33:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20565908812599296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:33:05.919 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:07.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:08.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:10.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:12.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:14.107 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:32.065 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566034637524992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:33:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566034637524992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:33:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566034637524992 [0;39m ==> Parameters: 
2023-03-25 20:33:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566034637524992 [0;39m <==    Updates: 1
2023-03-25 20:33:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566034637524992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:33:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:38.694 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:39.780 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:41.835 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:54.106 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:33:56.140 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20566139503513600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:34:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566139503513600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:34:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566139503513600 [0;39m ==> Parameters: 
2023-03-25 20:34:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566139503513600 [0;39m <==    Updates: 0
2023-03-25 20:34:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20566139503513600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:34:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566160479227904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:34:05.024 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566160479227904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:34:05.025 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566160479227904 [0;39m ==> Parameters: 
2023-03-25 20:34:05.032 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566160479227904 [0;39m <==    Updates: 1
2023-03-25 20:34:05.032 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566160479227904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š16æ¯«ç§’
2023-03-25 20:34:07.738 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:08.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:09.795 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:11.834 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:18.205 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:20.262 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566286295764992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:34:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566286295764992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:34:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566286295764992 [0;39m ==> Parameters: 
2023-03-25 20:34:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566286295764992 [0;39m <==    Updates: 1
2023-03-25 20:34:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566286295764992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:34:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:39.769 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:41.821 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:43.877 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:34:45.912 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20566391144976384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:35:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566391144976384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:35:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566391144976384 [0;39m ==> Parameters: 
2023-03-25 20:35:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566391144976384 [0;39m <==    Updates: 0
2023-03-25 20:35:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20566391144976384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 20:35:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566412087136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:35:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566412087136256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:35:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566412087136256 [0;39m ==> Parameters: 
2023-03-25 20:35:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566412087136256 [0;39m <==    Updates: 1
2023-03-25 20:35:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566412087136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:35:08.689 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:09.762 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:11.816 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:13.856 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566537916256256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:35:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566537916256256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:35:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566537916256256 [0;39m ==> Parameters: 
2023-03-25 20:35:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566537916256256 [0;39m <==    Updates: 1
2023-03-25 20:35:35.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566537916256256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:35:35.922 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:37.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:38.680 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:40.018 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:42.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:35:44.117 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20566642778050560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:36:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566642778050560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:36:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566642778050560 [0;39m ==> Parameters: 
2023-03-25 20:36:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566642778050560 [0;39m <==    Updates: 0
2023-03-25 20:36:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20566642778050560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:36:02.053 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566663778930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:36:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566663778930688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:36:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566663778930688 [0;39m ==> Parameters: 
2023-03-25 20:36:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566663778930688 [0;39m <==    Updates: 1
2023-03-25 20:36:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566663778930688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:36:07.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:08.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:09.766 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:11.806 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:24.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:26.170 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566789608050688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:36:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566789608050688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:36:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566789608050688 [0;39m ==> Parameters: 
2023-03-25 20:36:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566789608050688 [0;39m <==    Updates: 1
2023-03-25 20:36:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566789608050688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:36:37.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:39.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:41.811 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:48.226 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:36:50.262 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:00.000 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20566894415319040 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:37:00.001 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566894415319040 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:37:00.001 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566894415319040 [0;39m ==> Parameters: 
2023-03-25 20:37:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20566894415319040 [0;39m <==    Updates: 0
2023-03-25 20:37:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20566894415319040 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:37:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20566915424587776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:37:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566915424587776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:37:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566915424587776 [0;39m ==> Parameters: 
2023-03-25 20:37:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20566915424587776 [0;39m <==    Updates: 1
2023-03-25 20:37:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20566915424587776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:37:07.738 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:08.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:09.788 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:11.838 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:13.872 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:15.912 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567041220153344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:37:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567041220153344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:37:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567041220153344 [0;39m ==> Parameters: 
2023-03-25 20:37:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567041220153344 [0;39m <==    Updates: 1
2023-03-25 20:37:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567041220153344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:37:37.716 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:38.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:39.761 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:41.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:37:43.871 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20567146115502080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:38:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567146115502080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:38:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567146115502080 [0;39m ==> Parameters: 
2023-03-25 20:38:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567146115502080 [0;39m <==    Updates: 0
2023-03-25 20:38:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20567146115502080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:38:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567167103799296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:38:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567167103799296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:38:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567167103799296 [0;39m ==> Parameters: 
2023-03-25 20:38:05.024 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567167103799296 [0;39m <==    Updates: 1
2023-03-25 20:38:05.025 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567167103799296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:38:05.933 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:07.969 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:08.671 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:12.049 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:14.096 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:30.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:32.072 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567292899364864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:38:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567292899364864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:38:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567292899364864 [0;39m ==> Parameters: 
2023-03-25 20:38:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567292899364864 [0;39m <==    Updates: 1
2023-03-25 20:38:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567292899364864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:38:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:39.766 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:41.799 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:38:56.298 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20567397761159168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:39:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567397761159168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:39:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567397761159168 [0;39m ==> Parameters: 
2023-03-25 20:39:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567397761159168 [0;39m <==    Updates: 0
2023-03-25 20:39:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20567397761159168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:39:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567418749456384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:39:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567418749456384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:39:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567418749456384 [0;39m ==> Parameters: 
2023-03-25 20:39:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567418749456384 [0;39m <==    Updates: 1
2023-03-25 20:39:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567418749456384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:39:08.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:11.775 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:18.335 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:20.390 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567544586964992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:39:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567544586964992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:39:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567544586964992 [0;39m ==> Parameters: 
2023-03-25 20:39:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567544586964992 [0;39m <==    Updates: 1
2023-03-25 20:39:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567544586964992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:39:37.711 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:38.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:41.806 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:43.852 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:39:45.896 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20567649406816256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:40:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567649406816256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:40:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567649406816256 [0;39m ==> Parameters: 
2023-03-25 20:40:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567649406816256 [0;39m <==    Updates: 0
2023-03-25 20:40:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20567649406816256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:40:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567670420279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:40:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567670420279296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:40:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567670420279296 [0;39m ==> Parameters: 
2023-03-25 20:40:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567670420279296 [0;39m <==    Updates: 1
2023-03-25 20:40:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567670420279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:40:07.740 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:11.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:13.876 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567796215844864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:40:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567796215844864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:40:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567796215844864 [0;39m ==> Parameters: 
2023-03-25 20:40:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567796215844864 [0;39m <==    Updates: 1
2023-03-25 20:40:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567796215844864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:40:35.939 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:37.997 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:38.698 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:42.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:40:44.128 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20567901056667648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:41:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567901056667648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:41:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567901056667648 [0;39m ==> Parameters: 
2023-03-25 20:41:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20567901056667648 [0;39m <==    Updates: 0
2023-03-25 20:41:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20567901056667648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:41:00.064 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:02.118 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20567922053353472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:41:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567922053353472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:41:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567922053353472 [0;39m ==> Parameters: 
2023-03-25 20:41:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20567922053353472 [0;39m <==    Updates: 1
2023-03-25 20:41:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20567922053353472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:41:08.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:09.755 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:11.806 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:24.162 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:26.189 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568047890862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:41:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568047890862080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:41:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568047890862080 [0;39m ==> Parameters: 
2023-03-25 20:41:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568047890862080 [0;39m <==    Updates: 1
2023-03-25 20:41:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568047890862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:41:37.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:38.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:41.809 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:48.225 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:41:50.281 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20568152735879168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:42:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568152735879168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:42:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568152735879168 [0;39m ==> Parameters: 
2023-03-25 20:42:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568152735879168 [0;39m <==    Updates: 0
2023-03-25 20:42:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20568152735879168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 20:42:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568173682233344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:42:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568173682233344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:42:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568173682233344 [0;39m ==> Parameters: 
2023-03-25 20:42:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568173682233344 [0;39m <==    Updates: 1
2023-03-25 20:42:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568173682233344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:42:08.696 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:11.823 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:13.880 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:15.934 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568299549102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:42:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568299549102080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:42:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568299549102080 [0;39m ==> Parameters: 
2023-03-25 20:42:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568299549102080 [0;39m <==    Updates: 1
2023-03-25 20:42:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568299549102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:42:37.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:38.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:39.792 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:41.842 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:42:43.882 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20568404415090688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:43:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568404415090688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:43:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568404415090688 [0;39m ==> Parameters: 
2023-03-25 20:43:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568404415090688 [0;39m <==    Updates: 0
2023-03-25 20:43:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20568404415090688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:43:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568425361444864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:43:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568425361444864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:43:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568425361444864 [0;39m ==> Parameters: 
2023-03-25 20:43:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568425361444864 [0;39m <==    Updates: 1
2023-03-25 20:43:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568425361444864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:43:05.925 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:07.976 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:10.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:14.123 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:32.079 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568551215730688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:43:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568551215730688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:43:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568551215730688 [0;39m ==> Parameters: 
2023-03-25 20:43:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568551215730688 [0;39m <==    Updates: 1
2023-03-25 20:43:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568551215730688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:43:37.739 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:38.688 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:41.830 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:43:56.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20568656081719296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:44:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568656081719296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:44:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568656081719296 [0;39m ==> Parameters: 
2023-03-25 20:44:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568656081719296 [0;39m <==    Updates: 0
2023-03-25 20:44:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20568656081719296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:44:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568677002907648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:44:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568677002907648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:44:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568677002907648 [0;39m ==> Parameters: 
2023-03-25 20:44:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568677002907648 [0;39m <==    Updates: 1
2023-03-25 20:44:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568677002907648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:44:08.666 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:09.779 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:11.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:20.263 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568802836221952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:44:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568802836221952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:44:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568802836221952 [0;39m ==> Parameters: 
2023-03-25 20:44:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568802836221952 [0;39m <==    Updates: 1
2023-03-25 20:44:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568802836221952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:44:37.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:38.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:39.786 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:41.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:44:45.923 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20568907731570688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:45:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568907731570688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:45:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568907731570688 [0;39m ==> Parameters: 
2023-03-25 20:45:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20568907731570688 [0;39m <==    Updates: 0
2023-03-25 20:45:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20568907731570688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:45:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20568928677924864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:45:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568928677924864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:45:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568928677924864 [0;39m ==> Parameters: 
2023-03-25 20:45:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20568928677924864 [0;39m <==    Updates: 1
2023-03-25 20:45:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20568928677924864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:45:07.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:08.695 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:09.772 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:11.817 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:13.855 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569054515433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:45:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569054515433472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:45:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569054515433472 [0;39m ==> Parameters: 
2023-03-25 20:45:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569054515433472 [0;39m <==    Updates: 1
2023-03-25 20:45:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569054515433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:45:35.912 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:37.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:38.691 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:40.010 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:42.059 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:45:44.110 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:00.007 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20569159368839168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:46:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569159368839168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:46:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569159368839168 [0;39m ==> Parameters: 
2023-03-25 20:46:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569159368839168 [0;39m <==    Updates: 0
2023-03-25 20:46:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20569159368839168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:46:02.050 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569180361330688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:46:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569180361330688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:46:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569180361330688 [0;39m ==> Parameters: 
2023-03-25 20:46:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569180361330688 [0;39m <==    Updates: 1
2023-03-25 20:46:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569180361330688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:46:07.748 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:08.667 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:09.805 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:11.847 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:24.104 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:26.152 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569306152701952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:46:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569306152701952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:46:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569306152701952 [0;39m ==> Parameters: 
2023-03-25 20:46:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569306152701952 [0;39m <==    Updates: 1
2023-03-25 20:46:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569306152701952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:46:37.739 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:38.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:41.830 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:48.206 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:46:50.252 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20569411022884864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:47:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569411022884864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:47:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569411022884864 [0;39m ==> Parameters: 
2023-03-25 20:47:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569411022884864 [0;39m <==    Updates: 0
2023-03-25 20:47:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20569411022884864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:47:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569431977627648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:47:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569431977627648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:47:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569431977627648 [0;39m ==> Parameters: 
2023-03-25 20:47:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569431977627648 [0;39m <==    Updates: 1
2023-03-25 20:47:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569431977627648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:47:07.737 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:09.790 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:11.840 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:13.892 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:15.935 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569557836107776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:47:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569557836107776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:47:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569557836107776 [0;39m ==> Parameters: 
2023-03-25 20:47:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569557836107776 [0;39m <==    Updates: 1
2023-03-25 20:47:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569557836107776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:47:37.747 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:39.787 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:41.828 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:47:43.867 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20569662676930560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:48:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569662676930560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:48:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569662676930560 [0;39m ==> Parameters: 
2023-03-25 20:48:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569662676930560 [0;39m <==    Updates: 0
2023-03-25 20:48:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20569662676930560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:48:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569683644256256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:48:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569683644256256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:48:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569683644256256 [0;39m ==> Parameters: 
2023-03-25 20:48:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569683644256256 [0;39m <==    Updates: 1
2023-03-25 20:48:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569683644256256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:48:05.918 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:07.970 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:08.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:10.005 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:14.109 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:30.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:32.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569809515319296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:48:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569809515319296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:48:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569809515319296 [0;39m ==> Parameters: 
2023-03-25 20:48:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569809515319296 [0;39m <==    Updates: 1
2023-03-25 20:48:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569809515319296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:48:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:38.664 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:39.768 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:41.816 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:54.138 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:48:56.177 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20569914381307904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:49:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569914381307904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:49:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569914381307904 [0;39m ==> Parameters: 
2023-03-25 20:49:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20569914381307904 [0;39m <==    Updates: 0
2023-03-25 20:49:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20569914381307904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:49:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20569935298301952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:49:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569935298301952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:49:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569935298301952 [0;39m ==> Parameters: 
2023-03-25 20:49:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20569935298301952 [0;39m <==    Updates: 1
2023-03-25 20:49:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20569935298301952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 20:49:07.715 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:08.661 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:09.768 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:11.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:18.233 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:20.285 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570061135810560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:49:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570061135810560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:49:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570061135810560 [0;39m ==> Parameters: 
2023-03-25 20:49:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570061135810560 [0;39m <==    Updates: 1
2023-03-25 20:49:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570061135810560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:49:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:38.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:39.779 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:41.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:43.846 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:49:45.894 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20570166035353600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:50:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570166035353600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:50:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570166035353600 [0;39m ==> Parameters: 
2023-03-25 20:50:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570166035353600 [0;39m <==    Updates: 0
2023-03-25 20:50:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20570166035353600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:50:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570186952347648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:50:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570186952347648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:50:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570186952347648 [0;39m ==> Parameters: 
2023-03-25 20:50:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570186952347648 [0;39m <==    Updates: 1
2023-03-25 20:50:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570186952347648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:50:07.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:08.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:09.783 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:11.835 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:13.886 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570312806633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:50:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570312806633472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:50:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570312806633472 [0;39m ==> Parameters: 
2023-03-25 20:50:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570312806633472 [0;39m <==    Updates: 1
2023-03-25 20:50:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570312806633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:50:35.943 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:37.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:38.696 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:40.016 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:42.069 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:50:44.105 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20570417693593600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:51:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570417693593600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:51:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570417693593600 [0;39m ==> Parameters: 
2023-03-25 20:51:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570417693593600 [0;39m <==    Updates: 0
2023-03-25 20:51:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20570417693593600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:51:00.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:02.072 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570438669307904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:51:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570438669307904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:51:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570438669307904 [0;39m ==> Parameters: 
2023-03-25 20:51:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570438669307904 [0;39m <==    Updates: 1
2023-03-25 20:51:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570438669307904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:51:08.673 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:09.765 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:11.808 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:26.176 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570564452290560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:51:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570564452290560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:51:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570564452290560 [0;39m ==> Parameters: 
2023-03-25 20:51:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570564452290560 [0;39m <==    Updates: 1
2023-03-25 20:51:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570564452290560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:51:37.720 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:38.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:41.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:48.219 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:51:50.272 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20570669305696256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:52:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570669305696256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:52:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570669305696256 [0;39m ==> Parameters: 
2023-03-25 20:52:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570669305696256 [0;39m <==    Updates: 0
2023-03-25 20:52:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20570669305696256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 20:52:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570690306576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:52:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570690306576384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:52:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570690306576384 [0;39m ==> Parameters: 
2023-03-25 20:52:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570690306576384 [0;39m <==    Updates: 1
2023-03-25 20:52:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570690306576384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:52:08.702 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:09.777 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:11.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:15.936 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570816106336256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:52:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570816106336256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:52:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570816106336256 [0;39m ==> Parameters: 
2023-03-25 20:52:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570816106336256 [0;39m <==    Updates: 1
2023-03-25 20:52:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570816106336256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:52:37.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:38.697 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:39.769 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:41.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:52:43.857 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20570920984907776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:53:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570920984907776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:53:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570920984907776 [0;39m ==> Parameters: 
2023-03-25 20:53:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20570920984907776 [0;39m <==    Updates: 0
2023-03-25 20:53:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20570920984907776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 20:53:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20570941948039168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:53:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570941948039168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:53:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570941948039168 [0;39m ==> Parameters: 
2023-03-25 20:53:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20570941948039168 [0;39m <==    Updates: 1
2023-03-25 20:53:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20570941948039168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 20:53:05.909 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:07.944 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:08.661 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:09.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:12.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:14.072 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:32.023 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571067798130688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:53:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571067798130688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:53:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571067798130688 [0;39m ==> Parameters: 
2023-03-25 20:53:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571067798130688 [0;39m <==    Updates: 1
2023-03-25 20:53:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571067798130688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:53:37.745 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:38.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:39.798 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:41.838 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:54.078 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:53:56.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20571172613787648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:54:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571172613787648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:54:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571172613787648 [0;39m ==> Parameters: 
2023-03-25 20:54:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571172613787648 [0;39m <==    Updates: 0
2023-03-25 20:54:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20571172613787648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:54:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571193581113344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:54:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571193581113344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:54:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571193581113344 [0;39m ==> Parameters: 
2023-03-25 20:54:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571193581113344 [0;39m <==    Updates: 1
2023-03-25 20:54:05.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571193581113344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:54:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:09.787 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:11.830 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:18.181 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:20.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571319443787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:54:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571319443787776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:54:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571319443787776 [0;39m ==> Parameters: 
2023-03-25 20:54:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571319443787776 [0;39m <==    Updates: 1
2023-03-25 20:54:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571319443787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:54:38.659 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:39.780 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:41.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:54:45.924 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20571424330747904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:55:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571424330747904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:55:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571424330747904 [0;39m ==> Parameters: 
2023-03-25 20:55:00.026 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571424330747904 [0;39m <==    Updates: 0
2023-03-25 20:55:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20571424330747904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:55:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571445260324864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:55:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571445260324864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:55:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571445260324864 [0;39m ==> Parameters: 
2023-03-25 20:55:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571445260324864 [0;39m <==    Updates: 1
2023-03-25 20:55:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571445260324864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:55:08.696 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:09.757 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:11.811 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:13.868 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571571076861952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:55:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571571076861952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:55:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571571076861952 [0;39m ==> Parameters: 
2023-03-25 20:55:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571571076861952 [0;39m <==    Updates: 1
2023-03-25 20:55:35.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571571076861952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 20:55:37.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:38.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:55:44.082 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20571675993182208 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:56:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571675993182208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:56:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571675993182208 [0;39m ==> Parameters: 
2023-03-25 20:56:00.027 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571675993182208 [0;39m <==    Updates: 0
2023-03-25 20:56:00.027 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20571675993182208 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:56:00.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:02.081 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:05.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571696893399040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:56:05.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571696893399040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:56:05.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571696893399040 [0;39m ==> Parameters: 
2023-03-25 20:56:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571696893399040 [0;39m <==    Updates: 1
2023-03-25 20:56:05.002 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571696893399040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:56:07.727 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:11.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:26.176 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571822735101952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:56:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571822735101952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:56:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571822735101952 [0;39m ==> Parameters: 
2023-03-25 20:56:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571822735101952 [0;39m <==    Updates: 1
2023-03-25 20:56:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571822735101952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:56:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:39.768 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:41.821 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:48.221 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:56:50.262 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20571927592701952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:57:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571927592701952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:57:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571927592701952 [0;39m ==> Parameters: 
2023-03-25 20:57:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20571927592701952 [0;39m <==    Updates: 0
2023-03-25 20:57:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20571927592701952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:57:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20571948593582080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:57:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571948593582080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:57:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571948593582080 [0;39m ==> Parameters: 
2023-03-25 20:57:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20571948593582080 [0;39m <==    Updates: 1
2023-03-25 20:57:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20571948593582080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 20:57:07.719 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:08.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:09.763 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:11.790 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:13.822 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:15.848 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572074414313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:57:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572074414313472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:57:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572074414313472 [0;39m ==> Parameters: 
2023-03-25 20:57:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572074414313472 [0;39m <==    Updates: 1
2023-03-25 20:57:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572074414313472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 20:57:37.746 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:39.798 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:41.844 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:57:43.894 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20572179280302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:58:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572179280302080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:58:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572179280302080 [0;39m ==> Parameters: 
2023-03-25 20:58:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572179280302080 [0;39m <==    Updates: 0
2023-03-25 20:58:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20572179280302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:58:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572200256016384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:58:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572200256016384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:58:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572200256016384 [0;39m ==> Parameters: 
2023-03-25 20:58:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572200256016384 [0;39m <==    Updates: 1
2023-03-25 20:58:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572200256016384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 20:58:05.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:08.006 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:08.691 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:10.060 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:14.145 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:30.071 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:32.124 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572326072553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:58:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572326072553472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:58:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572326072553472 [0;39m ==> Parameters: 
2023-03-25 20:58:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572326072553472 [0;39m <==    Updates: 1
2023-03-25 20:58:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572326072553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:58:37.741 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:38.691 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:39.796 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:41.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:54.193 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:58:56.248 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20572430909181952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 20:59:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572430909181952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 20:59:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572430909181952 [0;39m ==> Parameters: 
2023-03-25 20:59:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572430909181952 [0;39m <==    Updates: 0
2023-03-25 20:59:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20572430909181952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 20:59:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572451893284864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:59:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572451893284864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:59:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572451893284864 [0;39m ==> Parameters: 
2023-03-25 20:59:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572451893284864 [0;39m <==    Updates: 1
2023-03-25 20:59:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572451893284864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:59:07.746 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:08.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:09.788 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:11.844 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:18.288 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:20.332 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572577718210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 20:59:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572577718210560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 20:59:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572577718210560 [0;39m ==> Parameters: 
2023-03-25 20:59:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572577718210560 [0;39m <==    Updates: 1
2023-03-25 20:59:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572577718210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 20:59:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:38.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:39.774 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:41.830 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:43.869 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 20:59:45.911 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20572682571616256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:00:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572682571616256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:00:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572682571616256 [0;39m ==> Parameters: 
2023-03-25 21:00:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572682571616256 [0;39m <==    Updates: 0
2023-03-25 21:00:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20572682571616256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:00:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572703551524864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:00:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572703551524864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:00:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572703551524864 [0;39m ==> Parameters: 
2023-03-25 21:00:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572703551524864 [0;39m <==    Updates: 1
2023-03-25 21:00:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572703551524864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:00:08.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:09.804 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:11.847 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:13.900 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572829405810688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:00:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572829405810688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:00:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572829405810688 [0;39m ==> Parameters: 
2023-03-25 21:00:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572829405810688 [0;39m <==    Updates: 1
2023-03-25 21:00:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572829405810688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:00:35.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:38.001 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:38.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:40.054 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:42.112 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:00:44.170 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20572934259216384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:01:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572934259216384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:01:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572934259216384 [0;39m ==> Parameters: 
2023-03-25 21:01:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20572934259216384 [0;39m <==    Updates: 0
2023-03-25 21:01:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20572934259216384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:01:00.073 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:02.128 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20572955218153472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:01:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572955218153472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:01:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572955218153472 [0;39m ==> Parameters: 
2023-03-25 21:01:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20572955218153472 [0;39m <==    Updates: 1
2023-03-25 21:01:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20572955218153472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:01:07.726 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:08.693 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:09.781 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:11.835 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:24.182 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:26.226 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573081055662080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:01:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573081055662080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:01:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573081055662080 [0;39m ==> Parameters: 
2023-03-25 21:01:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573081055662080 [0;39m <==    Updates: 1
2023-03-25 21:01:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573081055662080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:01:37.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:38.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:41.823 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:01:50.343 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20573185892290560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:02:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573185892290560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:02:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573185892290560 [0;39m ==> Parameters: 
2023-03-25 21:02:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573185892290560 [0;39m <==    Updates: 0
2023-03-25 21:02:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20573185892290560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:02:05.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573206847033344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:02:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573206847033344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:02:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573206847033344 [0;39m ==> Parameters: 
2023-03-25 21:02:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573206847033344 [0;39m <==    Updates: 1
2023-03-25 21:02:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573206847033344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:02:07.726 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:08.693 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:09.782 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:11.836 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:13.892 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:15.945 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573332684541952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:02:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573332684541952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:02:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573332684541952 [0;39m ==> Parameters: 
2023-03-25 21:02:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573332684541952 [0;39m <==    Updates: 1
2023-03-25 21:02:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573332684541952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:02:37.741 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:38.680 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:39.787 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:41.842 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:02:43.901 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20573437579890688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:03:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573437579890688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:03:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573437579890688 [0;39m ==> Parameters: 
2023-03-25 21:03:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573437579890688 [0;39m <==    Updates: 0
2023-03-25 21:03:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20573437579890688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:03:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573458543022080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:03:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573458543022080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:03:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573458543022080 [0;39m ==> Parameters: 
2023-03-25 21:03:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573458543022080 [0;39m <==    Updates: 1
2023-03-25 21:03:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573458543022080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:03:05.946 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:07.999 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:08.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:10.052 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:12.105 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:14.162 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:30.064 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:32.118 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573584384724992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:03:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573584384724992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:03:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573584384724992 [0;39m ==> Parameters: 
2023-03-25 21:03:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573584384724992 [0;39m <==    Updates: 1
2023-03-25 21:03:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573584384724992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:03:37.740 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:38.691 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:39.794 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:41.838 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:54.193 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:03:56.248 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20573689208770560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:04:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573689208770560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:04:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573689208770560 [0;39m ==> Parameters: 
2023-03-25 21:04:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573689208770560 [0;39m <==    Updates: 0
2023-03-25 21:04:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20573689208770560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:04:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573710184484864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:04:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573710184484864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:04:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573710184484864 [0;39m ==> Parameters: 
2023-03-25 21:04:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573710184484864 [0;39m <==    Updates: 1
2023-03-25 21:04:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573710184484864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 21:04:07.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:08.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:09.789 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:11.848 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:18.317 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:20.347 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573836042964992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:04:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573836042964992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:04:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573836042964992 [0;39m ==> Parameters: 
2023-03-25 21:04:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573836042964992 [0;39m <==    Updates: 1
2023-03-25 21:04:35.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573836042964992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:04:37.739 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:38.688 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:39.794 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:41.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:43.907 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:04:45.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20573940862816256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:05:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573940862816256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:05:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573940862816256 [0;39m ==> Parameters: 
2023-03-25 21:05:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20573940862816256 [0;39m <==    Updates: 0
2023-03-25 21:05:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20573940862816256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:05:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20573961851113472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:05:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573961851113472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:05:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573961851113472 [0;39m ==> Parameters: 
2023-03-25 21:05:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20573961851113472 [0;39m <==    Updates: 1
2023-03-25 21:05:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20573961851113472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:05:07.735 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:08.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:09.792 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:11.848 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:13.907 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574087680233472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:05:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574087680233472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:05:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574087680233472 [0;39m ==> Parameters: 
2023-03-25 21:05:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574087680233472 [0;39m <==    Updates: 1
2023-03-25 21:05:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574087680233472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:05:35.975 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:38.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:38.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:40.084 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:42.135 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:05:44.176 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20574192512667648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:06:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574192512667648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:06:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574192512667648 [0;39m ==> Parameters: 
2023-03-25 21:06:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574192512667648 [0;39m <==    Updates: 0
2023-03-25 21:06:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20574192512667648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:06:00.064 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:02.089 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574213505159168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:06:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574213505159168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:06:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574213505159168 [0;39m ==> Parameters: 
2023-03-25 21:06:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574213505159168 [0;39m <==    Updates: 1
2023-03-25 21:06:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574213505159168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:06:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:09.791 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:11.847 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:24.144 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:26.200 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574339351056384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:06:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574339351056384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:06:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574339351056384 [0;39m ==> Parameters: 
2023-03-25 21:06:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574339351056384 [0;39m <==    Updates: 1
2023-03-25 21:06:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574339351056384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:06:37.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:38.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:39.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:41.804 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:06:50.295 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20574444183490560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:07:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574444183490560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:07:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574444183490560 [0;39m ==> Parameters: 
2023-03-25 21:07:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574444183490560 [0;39m <==    Updates: 0
2023-03-25 21:07:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20574444183490560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:07:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574465159204864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:07:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574465159204864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:07:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574465159204864 [0;39m ==> Parameters: 
2023-03-25 21:07:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574465159204864 [0;39m <==    Updates: 1
2023-03-25 21:07:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574465159204864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:07:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:08.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:11.846 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:13.901 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:15.954 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574591005102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:07:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574591005102080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:07:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574591005102080 [0;39m ==> Parameters: 
2023-03-25 21:07:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574591005102080 [0;39m <==    Updates: 1
2023-03-25 21:07:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574591005102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:07:37.726 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:38.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:39.784 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:41.838 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:07:43.891 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20574695824953344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:08:00.001 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574695824953344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:08:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574695824953344 [0;39m ==> Parameters: 
2023-03-25 21:08:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574695824953344 [0;39m <==    Updates: 0
2023-03-25 21:08:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20574695824953344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:08:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574716850999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:08:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574716850999296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:08:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574716850999296 [0;39m ==> Parameters: 
2023-03-25 21:08:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574716850999296 [0;39m <==    Updates: 1
2023-03-25 21:08:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574716850999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:08:05.947 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:07.988 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:08.661 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:10.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:12.087 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:14.141 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:30.056 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:32.102 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574842663342080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:08:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574842663342080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:08:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574842663342080 [0;39m ==> Parameters: 
2023-03-25 21:08:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574842663342080 [0;39m <==    Updates: 1
2023-03-25 21:08:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574842663342080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:08:37.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:38.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:41.837 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:54.171 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:08:56.225 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20574947529330688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:09:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574947529330688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:09:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574947529330688 [0;39m ==> Parameters: 
2023-03-25 21:09:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20574947529330688 [0;39m <==    Updates: 0
2023-03-25 21:09:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20574947529330688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:09:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20574968496656384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:09:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574968496656384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:09:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574968496656384 [0;39m ==> Parameters: 
2023-03-25 21:09:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20574968496656384 [0;39m <==    Updates: 1
2023-03-25 21:09:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20574968496656384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:09:07.742 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:08.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:09.785 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:11.840 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:18.276 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:20.319 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575094321582080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:09:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575094321582080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:09:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575094321582080 [0;39m ==> Parameters: 
2023-03-25 21:09:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575094321582080 [0;39m <==    Updates: 1
2023-03-25 21:09:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575094321582080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:09:37.723 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:38.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:39.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:41.834 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:43.873 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:09:45.931 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20575199154016256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:10:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575199154016256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:10:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575199154016256 [0;39m ==> Parameters: 
2023-03-25 21:10:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575199154016256 [0;39m <==    Updates: 0
2023-03-25 21:10:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20575199154016256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:10:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575220121341952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:10:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575220121341952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:10:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575220121341952 [0;39m ==> Parameters: 
2023-03-25 21:10:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575220121341952 [0;39m <==    Updates: 1
2023-03-25 21:10:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575220121341952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:10:07.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:08.698 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:09.788 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:11.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:13.888 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575345992404992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:10:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575345992404992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:10:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575345992404992 [0;39m ==> Parameters: 
2023-03-25 21:10:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575345992404992 [0;39m <==    Updates: 1
2023-03-25 21:10:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575345992404992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:10:37.998 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:38.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:40.040 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:42.098 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:10:44.153 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20575450812256256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:11:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575450812256256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:11:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575450812256256 [0;39m ==> Parameters: 
2023-03-25 21:11:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575450812256256 [0;39m <==    Updates: 0
2023-03-25 21:11:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20575450812256256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:11:00.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:02.122 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575471792164864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:11:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575471792164864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:11:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575471792164864 [0;39m ==> Parameters: 
2023-03-25 21:11:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575471792164864 [0;39m <==    Updates: 1
2023-03-25 21:11:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575471792164864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:11:07.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:08.670 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:11.799 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:24.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:26.214 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575597646450688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:11:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575597646450688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:11:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575597646450688 [0;39m ==> Parameters: 
2023-03-25 21:11:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575597646450688 [0;39m <==    Updates: 1
2023-03-25 21:11:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575597646450688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:11:37.704 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:38.669 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:39.745 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:41.780 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:48.267 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:11:50.277 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20575702466301952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:12:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575702466301952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:12:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575702466301952 [0;39m ==> Parameters: 
2023-03-25 21:12:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575702466301952 [0;39m <==    Updates: 0
2023-03-25 21:12:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20575702466301952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:12:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575723433627648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:12:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575723433627648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:12:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575723433627648 [0;39m ==> Parameters: 
2023-03-25 21:12:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575723433627648 [0;39m <==    Updates: 1
2023-03-25 21:12:05.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575723433627648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:12:08.681 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:09.747 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:11.778 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:13.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:15.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575849296302080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:12:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575849296302080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:12:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575849296302080 [0;39m ==> Parameters: 
2023-03-25 21:12:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575849296302080 [0;39m <==    Updates: 1
2023-03-25 21:12:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575849296302080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:12:37.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:38.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:41.845 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:12:43.879 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20575954162290688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:13:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575954162290688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:13:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575954162290688 [0;39m ==> Parameters: 
2023-03-25 21:13:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20575954162290688 [0;39m <==    Updates: 0
2023-03-25 21:13:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20575954162290688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:13:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20575975112839168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:13:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575975112839168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:13:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575975112839168 [0;39m ==> Parameters: 
2023-03-25 21:13:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20575975112839168 [0;39m <==    Updates: 1
2023-03-25 21:13:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20575975112839168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:13:05.926 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:07.972 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:08.660 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:12.074 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:14.125 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:32.058 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576100916793344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:13:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576100916793344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:13:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576100916793344 [0;39m ==> Parameters: 
2023-03-25 21:13:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576100916793344 [0;39m <==    Updates: 1
2023-03-25 21:13:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576100916793344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:13:37.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:38.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:39.785 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:41.805 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:54.126 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:13:56.175 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20576205828919296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:14:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576205828919296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:14:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576205828919296 [0;39m ==> Parameters: 
2023-03-25 21:14:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576205828919296 [0;39m <==    Updates: 0
2023-03-25 21:14:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20576205828919296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:14:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576226792050688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:14:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576226792050688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:14:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576226792050688 [0;39m ==> Parameters: 
2023-03-25 21:14:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576226792050688 [0;39m <==    Updates: 1
2023-03-25 21:14:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576226792050688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:14:07.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:08.680 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:09.768 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:11.821 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:18.221 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:20.262 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:35.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576352570839040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:14:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576352570839040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:14:35.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576352570839040 [0;39m ==> Parameters: 
2023-03-25 21:14:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576352570839040 [0;39m <==    Updates: 1
2023-03-25 21:14:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576352570839040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:14:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:38.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:39.772 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:41.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:43.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:14:45.898 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20576457453604864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:15:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576457453604864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:15:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576457453604864 [0;39m ==> Parameters: 
2023-03-25 21:15:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576457453604864 [0;39m <==    Updates: 0
2023-03-25 21:15:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20576457453604864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:15:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576478420930560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:15:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576478420930560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:15:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576478420930560 [0;39m ==> Parameters: 
2023-03-25 21:15:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576478420930560 [0;39m <==    Updates: 1
2023-03-25 21:15:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576478420930560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:15:07.743 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:08.710 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:09.796 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:11.850 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:13.901 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576604258439168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:15:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576604258439168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:15:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576604258439168 [0;39m ==> Parameters: 
2023-03-25 21:15:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576604258439168 [0;39m <==    Updates: 1
2023-03-25 21:15:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576604258439168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:15:35.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:37.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:38.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:40.031 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:42.070 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:15:44.115 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20576709107650560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:16:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576709107650560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:16:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576709107650560 [0;39m ==> Parameters: 
2023-03-25 21:16:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576709107650560 [0;39m <==    Updates: 0
2023-03-25 21:16:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20576709107650560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:16:02.088 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576730104336384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:16:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576730104336384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:16:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576730104336384 [0;39m ==> Parameters: 
2023-03-25 21:16:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576730104336384 [0;39m <==    Updates: 1
2023-03-25 21:16:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576730104336384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:16:08.669 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:09.781 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:11.792 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:24.140 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:26.185 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576855937650688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:16:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576855937650688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:16:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576855937650688 [0;39m ==> Parameters: 
2023-03-25 21:16:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576855937650688 [0;39m <==    Updates: 1
2023-03-25 21:16:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576855937650688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:16:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:38.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:39.757 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:41.812 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:48.241 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:16:50.285 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20576960753307648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:17:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576960753307648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:17:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576960753307648 [0;39m ==> Parameters: 
2023-03-25 21:17:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20576960753307648 [0;39m <==    Updates: 0
2023-03-25 21:17:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20576960753307648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 21:17:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20576981733216256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:17:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576981733216256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:17:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576981733216256 [0;39m ==> Parameters: 
2023-03-25 21:17:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20576981733216256 [0;39m <==    Updates: 1
2023-03-25 21:17:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20576981733216256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:17:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:08.665 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:09.770 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:11.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:13.882 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:15.929 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577107579113472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:17:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577107579113472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:17:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577107579113472 [0;39m ==> Parameters: 
2023-03-25 21:17:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577107579113472 [0;39m <==    Updates: 1
2023-03-25 21:17:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577107579113472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:17:37.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:38.658 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:39.751 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:41.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:17:43.854 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20577212432519168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:18:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577212432519168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:18:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577212432519168 [0;39m ==> Parameters: 
2023-03-25 21:18:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577212432519168 [0;39m <==    Updates: 0
2023-03-25 21:18:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20577212432519168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:18:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577233395650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:18:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577233395650560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:18:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577233395650560 [0;39m ==> Parameters: 
2023-03-25 21:18:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577233395650560 [0;39m <==    Updates: 1
2023-03-25 21:18:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577233395650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:18:05.909 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:07.937 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:08.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:09.989 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:12.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:30.980 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:33.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577359212187648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:18:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577359212187648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:18:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577359212187648 [0;39m ==> Parameters: 
2023-03-25 21:18:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577359212187648 [0;39m <==    Updates: 1
2023-03-25 21:18:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577359212187648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:18:37.727 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:39.781 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:41.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:55.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:18:57.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20577464065593344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:19:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577464065593344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:19:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577464065593344 [0;39m ==> Parameters: 
2023-03-25 21:19:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577464065593344 [0;39m <==    Updates: 0
2023-03-25 21:19:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20577464065593344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:19:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577485091639296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:19:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577485091639296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:19:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577485091639296 [0;39m ==> Parameters: 
2023-03-25 21:19:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577485091639296 [0;39m <==    Updates: 1
2023-03-25 21:19:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577485091639296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:19:07.746 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:08.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:09.787 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:11.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:19.174 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:21.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577610916564992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:19:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577610916564992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:19:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577610916564992 [0;39m ==> Parameters: 
2023-03-25 21:19:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577610916564992 [0;39m <==    Updates: 1
2023-03-25 21:19:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577610916564992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:19:37.741 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:38.673 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:39.791 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:41.848 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:43.888 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:19:45.921 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20577715732221952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:20:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577715732221952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:20:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577715732221952 [0;39m ==> Parameters: 
2023-03-25 21:20:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577715732221952 [0;39m <==    Updates: 0
2023-03-25 21:20:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20577715732221952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:20:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577736733102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:20:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577736733102080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:20:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577736733102080 [0;39m ==> Parameters: 
2023-03-25 21:20:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577736733102080 [0;39m <==    Updates: 1
2023-03-25 21:20:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577736733102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:20:08.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:09.762 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:11.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:13.880 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577862578999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:20:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577862578999296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:20:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577862578999296 [0;39m ==> Parameters: 
2023-03-25 21:20:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577862578999296 [0;39m <==    Updates: 1
2023-03-25 21:20:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577862578999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:20:35.932 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:37.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:38.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:40.020 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:42.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:20:44.097 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20577967407239168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:21:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577967407239168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:21:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577967407239168 [0;39m ==> Parameters: 
2023-03-25 21:21:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20577967407239168 [0;39m <==    Updates: 0
2023-03-25 21:21:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20577967407239168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:21:00.038 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:02.083 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20577988391342080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:21:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577988391342080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:21:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577988391342080 [0;39m ==> Parameters: 
2023-03-25 21:21:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20577988391342080 [0;39m <==    Updates: 1
2023-03-25 21:21:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20577988391342080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:21:07.721 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:08.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:09.762 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:11.793 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:24.115 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:26.156 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578114199490560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:21:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578114199490560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:21:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578114199490560 [0;39m ==> Parameters: 
2023-03-25 21:21:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578114199490560 [0;39m <==    Updates: 1
2023-03-25 21:21:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578114199490560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:21:38.652 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:39.760 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:41.810 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:48.211 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:21:50.264 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20578219090644992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:22:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578219090644992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:22:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578219090644992 [0;39m ==> Parameters: 
2023-03-25 21:22:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578219090644992 [0;39m <==    Updates: 0
2023-03-25 21:22:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20578219090644992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-25 21:22:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578240028610560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:22:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578240028610560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:22:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578240028610560 [0;39m ==> Parameters: 
2023-03-25 21:22:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578240028610560 [0;39m <==    Updates: 1
2023-03-25 21:22:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578240028610560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:22:08.647 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:09.757 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:11.783 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:13.812 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:15.865 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578365882896384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:22:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578365882896384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:22:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578365882896384 [0;39m ==> Parameters: 
2023-03-25 21:22:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578365882896384 [0;39m <==    Updates: 1
2023-03-25 21:22:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578365882896384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:22:37.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:38.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:39.795 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:41.831 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:22:43.885 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20578470706941952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:23:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578470706941952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:23:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578470706941952 [0;39m ==> Parameters: 
2023-03-25 21:23:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578470706941952 [0;39m <==    Updates: 0
2023-03-25 21:23:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20578470706941952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:23:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578491724599296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:23:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578491724599296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:23:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578491724599296 [0;39m ==> Parameters: 
2023-03-25 21:23:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578491724599296 [0;39m <==    Updates: 1
2023-03-25 21:23:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578491724599296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:23:05.948 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:07.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:08.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:12.072 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:14.114 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:30.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:32.074 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578617532747776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:23:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578617532747776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:23:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578617532747776 [0;39m ==> Parameters: 
2023-03-25 21:23:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578617532747776 [0;39m <==    Updates: 1
2023-03-25 21:23:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578617532747776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:23:37.701 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:38.653 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:41.800 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:54.131 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:23:56.173 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20578722398736384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:24:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578722398736384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:24:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578722398736384 [0;39m ==> Parameters: 
2023-03-25 21:24:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578722398736384 [0;39m <==    Updates: 0
2023-03-25 21:24:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20578722398736384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:24:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578743349284864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:24:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578743349284864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:24:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578743349284864 [0;39m ==> Parameters: 
2023-03-25 21:24:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578743349284864 [0;39m <==    Updates: 1
2023-03-25 21:24:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578743349284864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:24:07.719 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:08.664 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:11.824 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:18.225 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:20.271 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578869203570688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:24:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578869203570688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:24:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578869203570688 [0;39m ==> Parameters: 
2023-03-25 21:24:35.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578869203570688 [0;39m <==    Updates: 1
2023-03-25 21:24:35.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578869203570688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:24:37.727 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:39.779 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:41.833 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:43.893 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:24:45.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20578974040199168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:25:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578974040199168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:25:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578974040199168 [0;39m ==> Parameters: 
2023-03-25 21:25:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20578974040199168 [0;39m <==    Updates: 0
2023-03-25 21:25:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20578974040199168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:25:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20578994999136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:25:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578994999136256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:25:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578994999136256 [0;39m ==> Parameters: 
2023-03-25 21:25:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20578994999136256 [0;39m <==    Updates: 1
2023-03-25 21:25:05.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20578994999136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:25:07.720 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:08.665 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:09.756 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:11.795 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:13.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579120861810688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:25:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579120861810688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:25:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579120861810688 [0;39m ==> Parameters: 
2023-03-25 21:25:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579120861810688 [0;39m <==    Updates: 1
2023-03-25 21:25:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579120861810688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:25:35.905 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:37.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:38.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:25:42.035 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20579225706827776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:26:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579225706827776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:26:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579225706827776 [0;39m ==> Parameters: 
2023-03-25 21:26:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579225706827776 [0;39m <==    Updates: 0
2023-03-25 21:26:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20579225706827776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:26:00.990 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:03.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579246699319296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:26:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579246699319296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:26:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579246699319296 [0;39m ==> Parameters: 
2023-03-25 21:26:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579246699319296 [0;39m <==    Updates: 1
2023-03-25 21:26:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579246699319296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:26:07.724 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:11.810 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:25.095 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:27.121 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579372486496256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:26:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579372486496256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:26:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579372486496256 [0;39m ==> Parameters: 
2023-03-25 21:26:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579372486496256 [0;39m <==    Updates: 1
2023-03-25 21:26:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579372486496256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:26:37.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:38.664 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:39.780 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:41.817 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:49.170 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:26:51.216 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20579477386039296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:27:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579477386039296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:27:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579477386039296 [0;39m ==> Parameters: 
2023-03-25 21:27:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579477386039296 [0;39m <==    Updates: 0
2023-03-25 21:27:00.026 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20579477386039296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-25 21:27:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579498344976384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:27:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579498344976384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:27:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579498344976384 [0;39m ==> Parameters: 
2023-03-25 21:27:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579498344976384 [0;39m <==    Updates: 1
2023-03-25 21:27:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579498344976384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:27:07.725 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:08.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:11.834 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:15.930 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579624153124864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:27:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579624153124864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:27:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579624153124864 [0;39m ==> Parameters: 
2023-03-25 21:27:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579624153124864 [0;39m <==    Updates: 1
2023-03-25 21:27:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579624153124864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:27:38.656 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:41.773 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:27:43.813 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20579729044279296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:28:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579729044279296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:28:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579729044279296 [0;39m ==> Parameters: 
2023-03-25 21:28:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579729044279296 [0;39m <==    Updates: 0
2023-03-25 21:28:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20579729044279296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:28:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579750007410688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:28:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579750007410688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:28:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579750007410688 [0;39m ==> Parameters: 
2023-03-25 21:28:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579750007410688 [0;39m <==    Updates: 1
2023-03-25 21:28:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579750007410688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:28:05.883 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:07.924 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:08.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:09.956 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:12.002 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:30.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:32.985 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20579875828142080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:28:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579875828142080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:28:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579875828142080 [0;39m ==> Parameters: 
2023-03-25 21:28:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20579875828142080 [0;39m <==    Updates: 1
2023-03-25 21:28:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20579875828142080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:28:37.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:38.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:39.784 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:41.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:55.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:28:57.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20579980694130688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:29:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579980694130688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:29:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579980694130688 [0;39m ==> Parameters: 
2023-03-25 21:29:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20579980694130688 [0;39m <==    Updates: 0
2023-03-25 21:29:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20579980694130688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:29:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580001669844992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:29:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580001669844992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:29:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580001669844992 [0;39m ==> Parameters: 
2023-03-25 21:29:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580001669844992 [0;39m <==    Updates: 1
2023-03-25 21:29:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580001669844992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:29:07.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:08.666 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:09.770 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:11.812 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:21.161 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580127507353600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:29:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580127507353600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:29:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580127507353600 [0;39m ==> Parameters: 
2023-03-25 21:29:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580127507353600 [0;39m <==    Updates: 1
2023-03-25 21:29:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580127507353600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:29:38.652 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:39.719 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:41.764 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:43.784 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:29:45.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20580232352370688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:30:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580232352370688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:30:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580232352370688 [0;39m ==> Parameters: 
2023-03-25 21:30:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580232352370688 [0;39m <==    Updates: 0
2023-03-25 21:30:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20580232352370688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:30:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580253294530560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:30:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580253294530560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:30:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580253294530560 [0;39m ==> Parameters: 
2023-03-25 21:30:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580253294530560 [0;39m <==    Updates: 1
2023-03-25 21:30:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580253294530560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:30:07.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:08.694 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:09.774 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:11.814 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:13.842 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580379144622080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:30:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580379144622080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:30:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580379144622080 [0;39m ==> Parameters: 
2023-03-25 21:30:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580379144622080 [0;39m <==    Updates: 1
2023-03-25 21:30:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580379144622080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:30:35.876 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:37.918 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:38.669 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:39.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:41.996 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:30:44.056 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20580483968667648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:31:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580483968667648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:31:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580483968667648 [0;39m ==> Parameters: 
2023-03-25 21:31:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580483968667648 [0;39m <==    Updates: 0
2023-03-25 21:31:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20580483968667648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:31:02.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580504944381952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:31:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580504944381952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:31:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580504944381952 [0;39m ==> Parameters: 
2023-03-25 21:31:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580504944381952 [0;39m <==    Updates: 1
2023-03-25 21:31:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580504944381952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:31:07.723 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:08.670 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:09.777 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:11.794 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:24.080 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:26.111 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580630802862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:31:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580630802862080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:31:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580630802862080 [0;39m ==> Parameters: 
2023-03-25 21:31:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580630802862080 [0;39m <==    Updates: 1
2023-03-25 21:31:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580630802862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:31:37.721 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:38.688 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:39.777 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:41.838 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:48.143 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:31:50.192 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20580735681433600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:32:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580735681433600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:32:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580735681433600 [0;39m ==> Parameters: 
2023-03-25 21:32:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580735681433600 [0;39m <==    Updates: 0
2023-03-25 21:32:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20580735681433600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:32:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580756631982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:32:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580756631982080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:32:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580756631982080 [0;39m ==> Parameters: 
2023-03-25 21:32:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580756631982080 [0;39m <==    Updates: 1
2023-03-25 21:32:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580756631982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:32:08.671 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:09.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:11.810 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:13.864 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:15.901 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20580882473684992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:32:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580882473684992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:32:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580882473684992 [0;39m ==> Parameters: 
2023-03-25 21:32:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20580882473684992 [0;39m <==    Updates: 1
2023-03-25 21:32:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20580882473684992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:32:37.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:38.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:39.774 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:41.825 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:32:43.873 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20580987289341952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:33:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580987289341952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:33:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580987289341952 [0;39m ==> Parameters: 
2023-03-25 21:33:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20580987289341952 [0;39m <==    Updates: 0
2023-03-25 21:33:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20580987289341952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:33:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581008306999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:33:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581008306999296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:33:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581008306999296 [0;39m ==> Parameters: 
2023-03-25 21:33:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581008306999296 [0;39m <==    Updates: 1
2023-03-25 21:33:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581008306999296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:33:05.921 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:07.966 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:10.010 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:12.065 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:14.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:30.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:32.075 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581134136119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:33:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581134136119296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:33:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581134136119296 [0;39m ==> Parameters: 
2023-03-25 21:33:35.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581134136119296 [0;39m <==    Updates: 1
2023-03-25 21:33:35.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581134136119296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:33:37.718 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:38.685 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:41.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:33:56.164 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20581238943387648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:34:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581238943387648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:34:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581238943387648 [0;39m ==> Parameters: 
2023-03-25 21:34:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581238943387648 [0;39m <==    Updates: 0
2023-03-25 21:34:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20581238943387648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:34:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581259940073472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:34:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581259940073472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:34:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581259940073472 [0;39m ==> Parameters: 
2023-03-25 21:34:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581259940073472 [0;39m <==    Updates: 1
2023-03-25 21:34:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581259940073472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:34:07.734 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:08.684 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:09.763 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:11.818 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:18.230 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:20.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581385764999168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:34:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581385764999168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:34:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581385764999168 [0;39m ==> Parameters: 
2023-03-25 21:34:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581385764999168 [0;39m <==    Updates: 1
2023-03-25 21:34:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581385764999168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:34:37.698 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:38.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:39.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:41.765 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:43.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:34:45.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20581490601627648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:35:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581490601627648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:35:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581490601627648 [0;39m ==> Parameters: 
2023-03-25 21:35:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581490601627648 [0;39m <==    Updates: 0
2023-03-25 21:35:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20581490601627648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:35:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581511585730560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:35:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581511585730560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:35:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581511585730560 [0;39m ==> Parameters: 
2023-03-25 21:35:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581511585730560 [0;39m <==    Updates: 1
2023-03-25 21:35:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581511585730560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:35:07.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:08.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:09.752 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:11.794 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:13.844 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581637435822080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:35:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581637435822080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:35:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581637435822080 [0;39m ==> Parameters: 
2023-03-25 21:35:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581637435822080 [0;39m <==    Updates: 1
2023-03-25 21:35:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581637435822080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:35:35.910 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:38.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:39.979 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:42.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:44.051 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:35:59.993 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20581742289227776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:36:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581742289227776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:36:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581742289227776 [0;39m ==> Parameters: 
2023-03-25 21:36:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581742289227776 [0;39m <==    Updates: 0
2023-03-25 21:36:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20581742289227776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:36:02.035 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581763256553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:36:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581763256553472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:36:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581763256553472 [0;39m ==> Parameters: 
2023-03-25 21:36:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581763256553472 [0;39m <==    Updates: 1
2023-03-25 21:36:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581763256553472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:36:07.727 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:08.691 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:09.768 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:11.818 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:24.090 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:26.130 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20581889085673472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:36:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581889085673472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:36:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581889085673472 [0;39m ==> Parameters: 
2023-03-25 21:36:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20581889085673472 [0;39m <==    Updates: 1
2023-03-25 21:36:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20581889085673472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:36:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:38.654 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:41.798 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:48.182 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:36:50.219 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20581993934884864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:37:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581993934884864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:37:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581993934884864 [0;39m ==> Parameters: 
2023-03-25 21:37:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20581993934884864 [0;39m <==    Updates: 0
2023-03-25 21:37:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20581993934884864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:37:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582014902210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:37:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582014902210560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:37:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582014902210560 [0;39m ==> Parameters: 
2023-03-25 21:37:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582014902210560 [0;39m <==    Updates: 1
2023-03-25 21:37:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582014902210560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:37:08.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:09.760 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:11.790 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:13.839 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:15.890 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582140727136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:37:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582140727136256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:37:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582140727136256 [0;39m ==> Parameters: 
2023-03-25 21:37:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582140727136256 [0;39m <==    Updates: 1
2023-03-25 21:37:35.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582140727136256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:37:38.669 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:39.772 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:41.799 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:37:43.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20582245614096384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:38:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582245614096384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:38:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582245614096384 [0;39m ==> Parameters: 
2023-03-25 21:38:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582245614096384 [0;39m <==    Updates: 0
2023-03-25 21:38:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20582245614096384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:38:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582266585616384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:38:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582266585616384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:38:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582266585616384 [0;39m ==> Parameters: 
2023-03-25 21:38:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582266585616384 [0;39m <==    Updates: 1
2023-03-25 21:38:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582266585616384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:38:05.913 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:07.957 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:08.688 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:10.011 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:12.038 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:14.091 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:30.003 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:32.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582392376987648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:38:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582392376987648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:38:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582392376987648 [0;39m ==> Parameters: 
2023-03-25 21:38:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582392376987648 [0;39m <==    Updates: 1
2023-03-25 21:38:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582392376987648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:38:37.742 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:38.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:39.773 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:41.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:38:56.136 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20582497276530688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:39:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582497276530688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:39:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582497276530688 [0;39m ==> Parameters: 
2023-03-25 21:39:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582497276530688 [0;39m <==    Updates: 0
2023-03-25 21:39:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20582497276530688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:39:05.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582518210301952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:39:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582518210301952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:39:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582518210301952 [0;39m ==> Parameters: 
2023-03-25 21:39:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582518210301952 [0;39m <==    Updates: 1
2023-03-25 21:39:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582518210301952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:39:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:08.680 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:09.784 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:11.838 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:20.233 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582644039421952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:39:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582644039421952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:39:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582644039421952 [0;39m ==> Parameters: 
2023-03-25 21:39:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582644039421952 [0;39m <==    Updates: 1
2023-03-25 21:39:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582644039421952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:39:37.720 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:38.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:39.749 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:41.781 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:39:45.847 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20582748917993472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:40:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582748917993472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:40:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582748917993472 [0;39m ==> Parameters: 
2023-03-25 21:40:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20582748917993472 [0;39m <==    Updates: 0
2023-03-25 21:40:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20582748917993472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:40:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582769902096384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:40:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582769902096384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:40:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582769902096384 [0;39m ==> Parameters: 
2023-03-25 21:40:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582769902096384 [0;39m <==    Updates: 1
2023-03-25 21:40:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582769902096384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:40:07.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:09.763 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:11.813 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:13.856 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:35.001 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20582895689273344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:40:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582895689273344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:40:35.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582895689273344 [0;39m ==> Parameters: 
2023-03-25 21:40:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20582895689273344 [0;39m <==    Updates: 1
2023-03-25 21:40:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20582895689273344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:40:35.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:37.960 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:38.694 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:42.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:40:44.094 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20583000551067648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:41:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583000551067648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:41:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583000551067648 [0;39m ==> Parameters: 
2023-03-25 21:41:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583000551067648 [0;39m <==    Updates: 0
2023-03-25 21:41:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20583000551067648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 21:41:02.033 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583021568724992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:41:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583021568724992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:41:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583021568724992 [0;39m ==> Parameters: 
2023-03-25 21:41:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583021568724992 [0;39m <==    Updates: 1
2023-03-25 21:41:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583021568724992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:41:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:11.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:24.107 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:26.154 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583147372679168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:41:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583147372679168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:41:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583147372679168 [0;39m ==> Parameters: 
2023-03-25 21:41:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583147372679168 [0;39m <==    Updates: 1
2023-03-25 21:41:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583147372679168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:41:37.715 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:38.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:41.818 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:48.194 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:41:50.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20583252263833600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:42:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583252263833600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:42:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583252263833600 [0;39m ==> Parameters: 
2023-03-25 21:42:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583252263833600 [0;39m <==    Updates: 0
2023-03-25 21:42:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20583252263833600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:42:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583273231159296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:42:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583273231159296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:42:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583273231159296 [0;39m ==> Parameters: 
2023-03-25 21:42:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583273231159296 [0;39m <==    Updates: 1
2023-03-25 21:42:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583273231159296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:42:07.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:08.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:11.826 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:13.870 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:15.921 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583399056084992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:42:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583399056084992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:42:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583399056084992 [0;39m ==> Parameters: 
2023-03-25 21:42:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583399056084992 [0;39m <==    Updates: 1
2023-03-25 21:42:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583399056084992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:42:37.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:39.778 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:41.822 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:42:43.858 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20583503863353344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:43:00.001 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583503863353344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:43:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583503863353344 [0;39m ==> Parameters: 
2023-03-25 21:43:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583503863353344 [0;39m <==    Updates: 0
2023-03-25 21:43:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20583503863353344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:43:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583524889399296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:43:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583524889399296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:43:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583524889399296 [0;39m ==> Parameters: 
2023-03-25 21:43:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583524889399296 [0;39m <==    Updates: 1
2023-03-25 21:43:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583524889399296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:43:07.955 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:08.657 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:09.998 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:12.052 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:14.106 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:30.013 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:32.068 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583650718519296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:43:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583650718519296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:43:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583650718519296 [0;39m ==> Parameters: 
2023-03-25 21:43:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583650718519296 [0;39m <==    Updates: 1
2023-03-25 21:43:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583650718519296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:43:37.724 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:38.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:41.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:54.117 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:43:56.157 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:00.004 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20583755534176256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:44:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583755534176256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:44:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583755534176256 [0;39m ==> Parameters: 
2023-03-25 21:44:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20583755534176256 [0;39m <==    Updates: 0
2023-03-25 21:44:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20583755534176256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:44:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583776556027904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:44:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583776556027904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:44:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583776556027904 [0;39m ==> Parameters: 
2023-03-25 21:44:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583776556027904 [0;39m <==    Updates: 1
2023-03-25 21:44:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583776556027904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:44:07.741 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:08.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:09.795 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:11.845 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:18.228 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:20.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20583902376759296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:44:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583902376759296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:44:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583902376759296 [0;39m ==> Parameters: 
2023-03-25 21:44:35.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20583902376759296 [0;39m <==    Updates: 1
2023-03-25 21:44:35.024 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20583902376759296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:44:37.727 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:39.769 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:41.813 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:43.869 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:44:45.925 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20584007196610560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:45:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584007196610560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:45:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584007196610560 [0;39m ==> Parameters: 
2023-03-25 21:45:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584007196610560 [0;39m <==    Updates: 0
2023-03-25 21:45:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20584007196610560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 21:45:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584028193296384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:45:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584028193296384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:45:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584028193296384 [0;39m ==> Parameters: 
2023-03-25 21:45:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584028193296384 [0;39m <==    Updates: 1
2023-03-25 21:45:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584028193296384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:45:08.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:09.767 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:11.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:13.867 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584154030804992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:45:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584154030804992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:45:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584154030804992 [0;39m ==> Parameters: 
2023-03-25 21:45:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584154030804992 [0;39m <==    Updates: 1
2023-03-25 21:45:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584154030804992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:45:35.935 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:37.990 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:40.021 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:42.059 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:45:44.112 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20584258871627776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:46:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584258871627776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:46:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584258871627776 [0;39m ==> Parameters: 
2023-03-25 21:46:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584258871627776 [0;39m <==    Updates: 0
2023-03-25 21:46:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20584258871627776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 21:46:00.055 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:02.106 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584279822176256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:46:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584279822176256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:46:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584279822176256 [0;39m ==> Parameters: 
2023-03-25 21:46:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584279822176256 [0;39m <==    Updates: 1
2023-03-25 21:46:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584279822176256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:46:07.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:08.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:11.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:24.167 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:26.209 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584405642907648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:46:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584405642907648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:46:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584405642907648 [0;39m ==> Parameters: 
2023-03-25 21:46:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584405642907648 [0;39m <==    Updates: 1
2023-03-25 21:46:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584405642907648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:46:37.726 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:38.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:39.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:41.820 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:46:50.317 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20584510508896256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:47:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584510508896256 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:47:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584510508896256 [0;39m ==> Parameters: 
2023-03-25 21:47:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584510508896256 [0;39m <==    Updates: 0
2023-03-25 21:47:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20584510508896256 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 21:47:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584531530747904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:47:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584531530747904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:47:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584531530747904 [0;39m ==> Parameters: 
2023-03-25 21:47:05.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584531530747904 [0;39m <==    Updates: 1
2023-03-25 21:47:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584531530747904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:47:07.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:08.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:09.769 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:11.811 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:15.906 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584657305341952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:47:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584657305341952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:47:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584657305341952 [0;39m ==> Parameters: 
2023-03-25 21:47:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584657305341952 [0;39m <==    Updates: 1
2023-03-25 21:47:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584657305341952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-03-25 21:47:37.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:41.836 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:47:43.889 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20584762188107776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:48:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584762188107776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:48:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584762188107776 [0;39m ==> Parameters: 
2023-03-25 21:48:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20584762188107776 [0;39m <==    Updates: 0
2023-03-25 21:48:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20584762188107776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:48:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584783155433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:48:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584783155433472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:48:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584783155433472 [0;39m ==> Parameters: 
2023-03-25 21:48:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584783155433472 [0;39m <==    Updates: 1
2023-03-25 21:48:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584783155433472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:48:05.925 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:07.975 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:08.690 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:10.026 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:12.081 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:14.113 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:30.015 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:32.066 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20584908980359168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:48:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584908980359168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:48:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584908980359168 [0;39m ==> Parameters: 
2023-03-25 21:48:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20584908980359168 [0;39m <==    Updates: 1
2023-03-25 21:48:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20584908980359168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:48:37.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:38.677 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:39.779 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:41.832 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:54.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:48:56.176 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20585013871513600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:49:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585013871513600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:49:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585013871513600 [0;39m ==> Parameters: 
2023-03-25 21:49:00.025 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585013871513600 [0;39m <==    Updates: 0
2023-03-25 21:49:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20585013871513600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:49:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585034843033600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:49:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585034843033600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:49:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585034843033600 [0;39m ==> Parameters: 
2023-03-25 21:49:05.023 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585034843033600 [0;39m <==    Updates: 1
2023-03-25 21:49:05.023 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585034843033600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:49:07.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:08.666 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:09.778 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:11.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:20.243 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585160672153600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:49:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585160672153600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:49:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585160672153600 [0;39m ==> Parameters: 
2023-03-25 21:49:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585160672153600 [0;39m <==    Updates: 1
2023-03-25 21:49:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585160672153600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:49:37.705 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:38.668 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:41.799 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:43.821 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:49:45.873 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20585265500393472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:50:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585265500393472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:50:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585265500393472 [0;39m ==> Parameters: 
2023-03-25 21:50:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585265500393472 [0;39m <==    Updates: 0
2023-03-25 21:50:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20585265500393472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:50:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585286492884992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:50:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585286492884992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:50:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585286492884992 [0;39m ==> Parameters: 
2023-03-25 21:50:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585286492884992 [0;39m <==    Updates: 1
2023-03-25 21:50:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585286492884992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:50:07.713 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:08.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:09.753 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:11.799 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:13.839 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585412280061952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:50:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585412280061952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:50:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585412280061952 [0;39m ==> Parameters: 
2023-03-25 21:50:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585412280061952 [0;39m <==    Updates: 1
2023-03-25 21:50:35.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585412280061952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:50:35.904 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:37.934 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:38.667 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:39.986 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:42.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:44.052 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:50:59.991 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20585517150244864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:51:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585517150244864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:51:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585517150244864 [0;39m ==> Parameters: 
2023-03-25 21:51:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585517150244864 [0;39m <==    Updates: 0
2023-03-25 21:51:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20585517150244864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 21:51:02.022 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585538113376256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:51:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585538113376256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:51:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585538113376256 [0;39m ==> Parameters: 
2023-03-25 21:51:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585538113376256 [0;39m <==    Updates: 1
2023-03-25 21:51:05.006 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585538113376256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:51:07.747 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:08.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:09.801 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:11.858 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:24.044 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:26.083 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585663946690560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:51:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585663946690560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:51:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585663946690560 [0;39m ==> Parameters: 
2023-03-25 21:51:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585663946690560 [0;39m <==    Updates: 1
2023-03-25 21:51:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585663946690560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:51:37.730 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:38.667 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:41.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:51:50.197 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20585768829456384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:52:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585768829456384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:52:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585768829456384 [0;39m ==> Parameters: 
2023-03-25 21:52:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20585768829456384 [0;39m <==    Updates: 0
2023-03-25 21:52:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20585768829456384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:52:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585789775810560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:52:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585789775810560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:52:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585789775810560 [0;39m ==> Parameters: 
2023-03-25 21:52:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585789775810560 [0;39m <==    Updates: 1
2023-03-25 21:52:05.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585789775810560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:52:07.732 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:11.807 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:15.912 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20585915621707776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:52:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585915621707776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:52:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585915621707776 [0;39m ==> Parameters: 
2023-03-25 21:52:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20585915621707776 [0;39m <==    Updates: 1
2023-03-25 21:52:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20585915621707776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:52:38.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:39.797 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:41.841 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:52:43.872 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20586020496084992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:53:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586020496084992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:53:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586020496084992 [0;39m ==> Parameters: 
2023-03-25 21:53:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586020496084992 [0;39m <==    Updates: 0
2023-03-25 21:53:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20586020496084992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:53:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586041438244864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:53:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586041438244864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:53:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586041438244864 [0;39m ==> Parameters: 
2023-03-25 21:53:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586041438244864 [0;39m <==    Updates: 1
2023-03-25 21:53:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586041438244864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:53:05.923 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:07.964 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:14.090 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:32.074 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586167254781952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:53:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586167254781952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:53:35.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586167254781952 [0;39m ==> Parameters: 
2023-03-25 21:53:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586167254781952 [0;39m <==    Updates: 1
2023-03-25 21:53:35.005 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586167254781952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:53:38.792 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:42.204 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:53:56.183 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20586272120770560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:54:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586272120770560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:54:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586272120770560 [0;39m ==> Parameters: 
2023-03-25 21:54:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586272120770560 [0;39m <==    Updates: 0
2023-03-25 21:54:00.015 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20586272120770560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:54:05.000 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586293071319040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:54:05.001 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586293071319040 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:54:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586293071319040 [0;39m ==> Parameters: 
2023-03-25 21:54:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586293071319040 [0;39m <==    Updates: 1
2023-03-25 21:54:05.004 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586293071319040 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:54:08.039 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:08.744 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:12.937 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:20.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586418950770688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:54:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586418950770688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:54:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586418950770688 [0;39m ==> Parameters: 
2023-03-25 21:54:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586418950770688 [0;39m <==    Updates: 1
2023-03-25 21:54:35.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586418950770688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 21:54:38.229 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:39.133 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:40.244 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:42.745 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:54:47.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20586523816759296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:55:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586523816759296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:55:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586523816759296 [0;39m ==> Parameters: 
2023-03-25 21:55:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586523816759296 [0;39m <==    Updates: 0
2023-03-25 21:55:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20586523816759296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:55:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586544788279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:55:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586544788279296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:55:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586544788279296 [0;39m ==> Parameters: 
2023-03-25 21:55:05.522 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586544788279296 [0;39m <==    Updates: 1
2023-03-25 21:55:05.523 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586544788279296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š509æ¯«ç§’
2023-03-25 21:55:08.238 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:08.740 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:12.982 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:15.169 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586670596427776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:55:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586670596427776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:55:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586670596427776 [0;39m ==> Parameters: 
2023-03-25 21:55:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586670596427776 [0;39m <==    Updates: 1
2023-03-25 21:55:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586670596427776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:55:37.569 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:39.169 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:40.163 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:55:44.929 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:00.001 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20586775420473344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:56:00.002 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586775420473344 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:56:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586775420473344 [0;39m ==> Parameters: 
2023-03-25 21:56:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20586775420473344 [0;39m <==    Updates: 0
2023-03-25 21:56:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20586775420473344 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 21:56:04.766 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586796450713600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:56:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586796450713600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:56:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586796450713600 [0;39m ==> Parameters: 
2023-03-25 21:56:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586796450713600 [0;39m <==    Updates: 1
2023-03-25 21:56:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586796450713600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-03-25 21:56:08.068 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:09.063 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:13.252 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:27.335 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:29.758 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:35.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20586922225307648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:56:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586922225307648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:56:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586922225307648 [0;39m ==> Parameters: 
2023-03-25 21:56:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20586922225307648 [0;39m <==    Updates: 1
2023-03-25 21:56:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20586922225307648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:56:38.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:40.199 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:42.258 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:56:53.847 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20587027120656384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:57:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587027120656384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:57:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587027120656384 [0;39m ==> Parameters: 
2023-03-25 21:57:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587027120656384 [0;39m <==    Updates: 0
2023-03-25 21:57:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20587027120656384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š14æ¯«ç§’
2023-03-25 21:57:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587048087982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:57:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587048087982080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:57:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587048087982080 [0;39m ==> Parameters: 
2023-03-25 21:57:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587048087982080 [0;39m <==    Updates: 1
2023-03-25 21:57:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587048087982080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:57:08.754 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:11.812 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:15.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:18.014 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587173921296384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:57:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587173921296384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:57:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587173921296384 [0;39m ==> Parameters: 
2023-03-25 21:57:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587173921296384 [0;39m <==    Updates: 1
2023-03-25 21:57:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587173921296384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:57:38.698 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:39.775 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:41.816 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:57:43.856 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20587278791479296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:58:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587278791479296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:58:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587278791479296 [0;39m ==> Parameters: 
2023-03-25 21:58:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587278791479296 [0;39m <==    Updates: 0
2023-03-25 21:58:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20587278791479296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 21:58:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587299767193600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:58:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587299767193600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:58:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587299767193600 [0;39m ==> Parameters: 
2023-03-25 21:58:05.021 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587299767193600 [0;39m <==    Updates: 1
2023-03-25 21:58:05.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587299767193600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 21:58:08.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:14.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:30.034 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:32.086 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:35.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587425600507904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:58:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587425600507904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:58:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587425600507904 [0;39m ==> Parameters: 
2023-03-25 21:58:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587425600507904 [0;39m <==    Updates: 1
2023-03-25 21:58:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587425600507904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:58:38.674 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:41.833 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:54.124 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:58:56.186 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20587530449719296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 21:59:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587530449719296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 21:59:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587530449719296 [0;39m ==> Parameters: 
2023-03-25 21:59:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587530449719296 [0;39m <==    Updates: 0
2023-03-25 21:59:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20587530449719296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 21:59:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587551417044992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:59:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587551417044992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:59:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587551417044992 [0;39m ==> Parameters: 
2023-03-25 21:59:05.022 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587551417044992 [0;39m <==    Updates: 1
2023-03-25 21:59:05.022 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587551417044992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 21:59:07.721 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:08.675 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:11.804 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:18.244 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:20.312 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:35.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587677250359296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 21:59:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587677250359296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 21:59:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587677250359296 [0;39m ==> Parameters: 
2023-03-25 21:59:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587677250359296 [0;39m <==    Updates: 1
2023-03-25 21:59:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587677250359296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 21:59:37.741 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:38.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:41.835 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 21:59:45.913 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20587782099570688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:00:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587782099570688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:00:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587782099570688 [0;39m ==> Parameters: 
2023-03-25 22:00:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20587782099570688 [0;39m <==    Updates: 0
2023-03-25 22:00:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20587782099570688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 22:00:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587803071090688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:00:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587803071090688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:00:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587803071090688 [0;39m ==> Parameters: 
2023-03-25 22:00:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587803071090688 [0;39m <==    Updates: 1
2023-03-25 22:00:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587803071090688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 22:00:08.660 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:11.813 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:13.856 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20587928887627776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:00:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587928887627776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:00:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587928887627776 [0;39m ==> Parameters: 
2023-03-25 22:00:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20587928887627776 [0;39m <==    Updates: 1
2023-03-25 22:00:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20587928887627776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 22:00:35.909 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:37.951 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:38.698 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:39.996 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:00:44.143 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20588033757810688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:01:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588033757810688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:01:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588033757810688 [0;39m ==> Parameters: 
2023-03-25 22:01:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588033757810688 [0;39m <==    Updates: 0
2023-03-25 22:01:00.022 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20588033757810688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:01:00.206 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:02.614 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:05.016 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588054746107904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:01:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588054746107904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:01:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588054746107904 [0;39m ==> Parameters: 
2023-03-25 22:01:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588054746107904 [0;39m <==    Updates: 1
2023-03-25 22:01:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588054746107904 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:01:07.735 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:08.678 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:09.773 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:11.822 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:26.709 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588180520701952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:01:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588180520701952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:01:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588180520701952 [0;39m ==> Parameters: 
2023-03-25 22:01:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588180520701952 [0;39m <==    Updates: 1
2023-03-25 22:01:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588180520701952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:01:37.744 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:38.689 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:39.798 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:41.857 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:01:50.814 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20588285424439296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:02:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588285424439296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:02:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588285424439296 [0;39m ==> Parameters: 
2023-03-25 22:02:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588285424439296 [0;39m <==    Updates: 0
2023-03-25 22:02:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20588285424439296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 22:02:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588306383376384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:02:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588306383376384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:02:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588306383376384 [0;39m ==> Parameters: 
2023-03-25 22:02:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588306383376384 [0;39m <==    Updates: 1
2023-03-25 22:02:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588306383376384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:02:07.724 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:08.707 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:11.833 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:15.897 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588432187330560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:02:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588432187330560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:02:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588432187330560 [0;39m ==> Parameters: 
2023-03-25 22:02:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588432187330560 [0;39m <==    Updates: 1
2023-03-25 22:02:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588432187330560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 22:02:38.689 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:39.771 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:41.819 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:02:43.903 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:00.003 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20588537036541952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:03:00.004 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588537036541952 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:03:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588537036541952 [0;39m ==> Parameters: 
2023-03-25 22:03:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588537036541952 [0;39m <==    Updates: 0
2023-03-25 22:03:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20588537036541952 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:03:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588558033227776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:03:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588558033227776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:03:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588558033227776 [0;39m ==> Parameters: 
2023-03-25 22:03:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588558033227776 [0;39m <==    Updates: 1
2023-03-25 22:03:05.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588558033227776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:03:05.962 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:07.999 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:08.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:12.076 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:14.127 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:30.047 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:32.104 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588683853959168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:03:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588683853959168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:03:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588683853959168 [0;39m ==> Parameters: 
2023-03-25 22:03:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588683853959168 [0;39m <==    Updates: 1
2023-03-25 22:03:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588683853959168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:03:38.690 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:41.802 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:03:56.192 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20588788719947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:04:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588788719947776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:04:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588788719947776 [0;39m ==> Parameters: 
2023-03-25 22:04:00.024 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20588788719947776 [0;39m <==    Updates: 0
2023-03-25 22:04:00.025 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20588788719947776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š12æ¯«ç§’
2023-03-25 22:04:05.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588809704050688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:04:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588809704050688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:04:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588809704050688 [0;39m ==> Parameters: 
2023-03-25 22:04:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588809704050688 [0;39m <==    Updates: 1
2023-03-25 22:04:05.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588809704050688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:04:08.676 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:11.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:20.321 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20588935512199168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:04:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588935512199168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:04:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588935512199168 [0;39m ==> Parameters: 
2023-03-25 22:04:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20588935512199168 [0;39m <==    Updates: 1
2023-03-25 22:04:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20588935512199168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:04:38.683 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:39.776 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:41.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:43.848 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:04:45.899 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20589040373993472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:05:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589040373993472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:05:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589040373993472 [0;39m ==> Parameters: 
2023-03-25 22:05:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589040373993472 [0;39m <==    Updates: 0
2023-03-25 22:05:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20589040373993472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:05:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589061341319168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:05:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589061341319168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:05:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589061341319168 [0;39m ==> Parameters: 
2023-03-25 22:05:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589061341319168 [0;39m <==    Updates: 1
2023-03-25 22:05:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589061341319168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:05:07.741 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:08.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:09.780 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:11.800 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:13.855 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:35.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589187174633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:05:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589187174633472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:05:35.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589187174633472 [0;39m ==> Parameters: 
2023-03-25 22:05:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589187174633472 [0;39m <==    Updates: 1
2023-03-25 22:05:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589187174633472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 22:05:37.939 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:38.686 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:39.974 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:42.027 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:05:44.077 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20589292040622080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:06:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589292040622080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:06:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589292040622080 [0;39m ==> Parameters: 
2023-03-25 22:06:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589292040622080 [0;39m <==    Updates: 0
2023-03-25 22:06:00.021 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20589292040622080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:06:02.032 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:05.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589313033113600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:06:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589313033113600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:06:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589313033113600 [0;39m ==> Parameters: 
2023-03-25 22:06:05.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589313033113600 [0;39m <==    Updates: 1
2023-03-25 22:06:05.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589313033113600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 22:06:08.667 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:11.812 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:24.099 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:26.150 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589438820290560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:06:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589438820290560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:06:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589438820290560 [0;39m ==> Parameters: 
2023-03-25 22:06:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589438820290560 [0;39m <==    Updates: 1
2023-03-25 22:06:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589438820290560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 22:06:37.733 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:38.689 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:39.783 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:41.827 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:06:50.248 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20589543690473472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:07:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589543690473472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:07:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589543690473472 [0;39m ==> Parameters: 
2023-03-25 22:07:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589543690473472 [0;39m <==    Updates: 0
2023-03-25 22:07:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20589543690473472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:07:05.014 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589564687159296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:07:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589564687159296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:07:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589564687159296 [0;39m ==> Parameters: 
2023-03-25 22:07:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589564687159296 [0;39m <==    Updates: 1
2023-03-25 22:07:05.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589564687159296 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:07:07.707 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:08.672 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:09.762 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:11.797 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:13.850 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:15.887 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:35.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589690486919168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:07:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589690486919168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:07:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589690486919168 [0;39m ==> Parameters: 
2023-03-25 22:07:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589690486919168 [0;39m <==    Updates: 1
2023-03-25 22:07:35.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589690486919168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-03-25 22:07:37.746 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:38.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:39.775 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:41.811 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:07:43.851 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:00.011 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20589795361296384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:08:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589795361296384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:08:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589795361296384 [0;39m ==> Parameters: 
2023-03-25 22:08:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20589795361296384 [0;39m <==    Updates: 0
2023-03-25 22:08:00.020 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20589795361296384 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 22:08:05.008 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589816320233472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:08:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589816320233472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:08:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589816320233472 [0;39m ==> Parameters: 
2023-03-25 22:08:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589816320233472 [0;39m <==    Updates: 1
2023-03-25 22:08:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589816320233472 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 22:08:05.895 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:07.928 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:08.692 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:09.987 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:14.093 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:29.995 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:32.036 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20589942170324992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:08:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589942170324992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:08:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589942170324992 [0;39m ==> Parameters: 
2023-03-25 22:08:35.025 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20589942170324992 [0;39m <==    Updates: 1
2023-03-25 22:08:35.025 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20589942170324992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š11æ¯«ç§’
2023-03-25 22:08:38.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:39.765 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:41.810 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:08:56.132 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20590047006953472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:09:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590047006953472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:09:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590047006953472 [0;39m ==> Parameters: 
2023-03-25 22:09:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590047006953472 [0;39m <==    Updates: 0
2023-03-25 22:09:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20590047006953472 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-03-25 22:09:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590067986862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:09:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590067986862080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:09:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590067986862080 [0;39m ==> Parameters: 
2023-03-25 22:09:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590067986862080 [0;39m <==    Updates: 1
2023-03-25 22:09:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590067986862080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 22:09:07.736 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:08.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:09.791 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:11.842 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:20.230 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590193811787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:09:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590193811787776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:09:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590193811787776 [0;39m ==> Parameters: 
2023-03-25 22:09:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590193811787776 [0;39m <==    Updates: 1
2023-03-25 22:09:35.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590193811787776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 22:09:38.680 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:39.772 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:41.823 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:43.860 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:09:45.909 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20590298656804864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:10:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590298656804864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:10:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590298656804864 [0;39m ==> Parameters: 
2023-03-25 22:10:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590298656804864 [0;39m <==    Updates: 0
2023-03-25 22:10:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20590298656804864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:10:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590319645102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:10:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590319645102080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:10:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590319645102080 [0;39m ==> Parameters: 
2023-03-25 22:10:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590319645102080 [0;39m <==    Updates: 1
2023-03-25 22:10:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590319645102080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 22:10:08.679 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:11.977 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:14.375 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:35.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590445486804992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:10:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590445486804992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:10:35.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590445486804992 [0;39m ==> Parameters: 
2023-03-25 22:10:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590445486804992 [0;39m <==    Updates: 1
2023-03-25 22:10:35.016 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590445486804992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-03-25 22:10:38.466 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:38.666 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:42.568 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:10:44.610 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20590550340210688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:11:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590550340210688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:11:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590550340210688 [0;39m ==> Parameters: 
2023-03-25 22:11:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590550340210688 [0;39m <==    Updates: 0
2023-03-25 22:11:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20590550340210688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
2023-03-25 22:11:00.506 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:02.557 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:05.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590571299147776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:11:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590571299147776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:11:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590571299147776 [0;39m ==> Parameters: 
2023-03-25 22:11:05.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590571299147776 [0;39m <==    Updates: 1
2023-03-25 22:11:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590571299147776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š8æ¯«ç§’
2023-03-25 22:11:08.657 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:11.807 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:26.654 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:35.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590697115684864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:11:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590697115684864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:11:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590697115684864 [0;39m ==> Parameters: 
2023-03-25 22:11:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590697115684864 [0;39m <==    Updates: 1
2023-03-25 22:11:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590697115684864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-03-25 22:11:38.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:39.772 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:41.813 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:11:50.744 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:12:00.009 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m20590801985867776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-03-25 22:12:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590801985867776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-03-25 22:12:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590801985867776 [0;39m ==> Parameters: 
2023-03-25 22:12:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m20590801985867776 [0;39m <==    Updates: 0
2023-03-25 22:12:00.019 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m20590801985867776 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 22:12:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590822928027648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:12:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590822928027648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:12:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590822928027648 [0;39m ==> Parameters: 
2023-03-25 22:12:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590822928027648 [0;39m <==    Updates: 1
2023-03-25 22:12:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590822928027648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š9æ¯«ç§’
2023-03-25 22:12:07.738 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:12:08.687 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:12:11.829 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:12:13.873 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:12:15.910 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-03-25 22:12:31.690 INFO  com.jiawa.wiki.websocket.WebSocketServer          :41   [32m20563116941250560 [0;39m è¿žæŽ¥å…³é—­ï¼Œtokenï¼šLlo79pPd05ï¼Œsession idï¼š0ï¼å½“å‰è¿žæŽ¥æ•°ï¼š0
2023-03-25 22:12:35.012 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m20590948799090688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-03-25 22:12:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590948799090688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-03-25 22:12:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590948799090688 [0;39m ==> Parameters: 
2023-03-25 22:12:35.025 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m20590948799090688 [0;39m <==    Updates: 1
2023-03-25 22:12:35.025 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m20590948799090688 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š10æ¯«ç§’
