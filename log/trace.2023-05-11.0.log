2023-05-11 23:44:35.517 INFO  com.jiawa.wiki.WikiApplication                    :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_271 on LAPTOP-TLCI2GAA with PID 24316 (D:\work\jiawawiki\target\classes started by k in D:\work\jiawawiki)
2023-05-11 23:44:35.523 INFO  com.jiawa.wiki.WikiApplication                    :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2023-05-11 23:44:35.536 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2023-05-11 23:44:35.621 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2023-05-11 23:44:35.624 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2023-05-11 23:44:40.212 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2023-05-11 23:44:40.214 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2023-05-11 23:44:40.256 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
2023-05-11 23:44:40.766 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.apache.rocketmq.spring.autoconfigure.RocketMQAutoConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQAutoConfiguration$$EnhancerBySpringCGLIB$$52848039] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:40.779 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.747 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'defaultMQProducer' of type [org.apache.rocketmq.client.producer.DefaultMQProducer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.751 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonConfig' of type [com.jiawa.wiki.config.JacksonConfig$$EnhancerBySpringCGLIB$$f4bef53a] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.752 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.753 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.759 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties' of type [org.springframework.boot.autoconfigure.jackson.JacksonProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.759 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'standardJacksonObjectMapperBuilderCustomizer' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration$StandardJackson2ObjectMapperBuilderCustomizer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.762 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.766 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'parameterNamesModule' of type [com.fasterxml.jackson.module.paramnames.ParameterNamesModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.767 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration' of type [org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.807 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jsonComponentModule' of type [org.springframework.boot.jackson.JsonComponentModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.808 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'org.springframework.data.web.config.SpringDataJacksonConfiguration' of type [org.springframework.data.web.config.SpringDataJacksonConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.813 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonGeoModule' of type [org.springframework.data.geo.GeoModule] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.816 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonObjectMapperBuilder' of type [org.springframework.http.converter.json.Jackson2ObjectMapperBuilder] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:47.837 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'jacksonObjectMapper' of type [com.fasterxml.jackson.databind.ObjectMapper] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:54.226 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'rocketMQTemplate' of type [org.apache.rocketmq.spring.core.RocketMQTemplate] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:54.230 INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:350  [32m                  [0;39m Bean 'transactionHandlerRegistry' of type [org.apache.rocketmq.spring.config.TransactionHandlerRegistry] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2023-05-11 23:44:56.338 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2023-05-11 23:44:56.349 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2023-05-11 23:44:56.350 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2023-05-11 23:44:56.350 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2023-05-11 23:44:57.002 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:44:57.003 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:44:57.358 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2023-05-11 23:44:57.360 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 21735 ms
2023-05-11 23:45:09.314 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2023-05-11 23:45:11.584 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2023-05-11 23:45:11.700 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2023-05-11 23:45:19.240 INFO  o.a.r.s.support.DefaultRocketMQListenerContainer  :243  [32m                  [0;39m running container: DefaultRocketMQListenerContainer{consumerGroup='default', nameServer='127.0.0.1:9876', topic='VOTE_TOPIC', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING}
2023-05-11 23:45:19.241 INFO  o.a.r.s.a.ListenerContainerConfiguration          :107  [32m                  [0;39m Register the listener to container, listenerBeanName:voteTopicConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2023-05-11 23:45:19.267 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2023-05-11 23:45:19.283 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2023-05-11 23:45:19.344 INFO  com.jiawa.wiki.WikiApplication                    :61   [32m                  [0;39m Started WikiApplication in 44.742 seconds (JVM running for 56.764)
2023-05-11 23:45:19.347 INFO  com.jiawa.wiki.WikiApplication                    :26   [32m                  [0;39m å¯åŠ¨æˆåŠŸï¼ï¼
2023-05-11 23:45:19.347 INFO  com.jiawa.wiki.WikiApplication                    :27   [32m                  [0;39m åœ°å€: 	http://127.0.0.1:8880
2023-05-11 23:45:19.928 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:45:27.038 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:45:30.568 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:45:35.052 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37646582866382848 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:45:35.108 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m37646582866382848 [0;39m HikariPool-1 - Starting...
2023-05-11 23:45:39.569 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m37646582866382848 [0;39m HikariPool-1 - Start completed.
2023-05-11 23:45:39.584 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646582866382848 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:45:39.671 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646582866382848 [0;39m ==> Parameters: 
2023-05-11 23:45:39.718 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646582866382848 [0;39m <==    Updates: 1
2023-05-11 23:45:39.726 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37646582866382848 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4674æ¯«ç§’
2023-05-11 23:45:47.762 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:45:56.868 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:45:57.264 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:45:59.662 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37646687568793600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:46:00.019 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37646687568793600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:46:00.022 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37646687568793600 [0;39m ==> Parameters: 
2023-05-11 23:46:00.041 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37646687568793600 [0;39m <==    Updates: 5
2023-05-11 23:46:00.042 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37646687568793600 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š24æ¯«ç§’
2023-05-11 23:46:05.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37646708498370560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:46:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646708498370560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:46:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646708498370560 [0;39m ==> Parameters: 
2023-05-11 23:46:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646708498370560 [0;39m <==    Updates: 1
2023-05-11 23:46:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37646708498370560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-05-11 23:46:10.556 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:13.345 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:27.236 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:30.163 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37646834348462080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:46:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646834348462080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:46:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646834348462080 [0;39m ==> Parameters: 
2023-05-11 23:46:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646834348462080 [0;39m <==    Updates: 1
2023-05-11 23:46:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37646834348462080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-05-11 23:46:35.860 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:38.449 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:46:56.940 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:47:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37646939193479168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:47:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37646939193479168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:47:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37646939193479168 [0;39m ==> Parameters: 
2023-05-11 23:47:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37646939193479168 [0;39m <==    Updates: 0
2023-05-11 23:47:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37646939193479168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-05-11 23:47:02.738 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:47:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37646960173387776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:47:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646960173387776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:47:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646960173387776 [0;39m ==> Parameters: 
2023-05-11 23:47:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37646960173387776 [0;39m <==    Updates: 1
2023-05-11 23:47:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37646960173387776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:47:05.545 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:47:27.047 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:47:30.315 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:47:32.961 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:47:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647086006702080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:47:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647086006702080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:47:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647086006702080 [0;39m ==> Parameters: 
2023-05-11 23:47:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647086006702080 [0;39m <==    Updates: 1
2023-05-11 23:47:35.017 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647086006702080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š7æ¯«ç§’
2023-05-11 23:47:56.653 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37647190864302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:48:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647190864302080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:48:00.012 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647190864302080 [0;39m ==> Parameters: 
2023-05-11 23:48:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647190864302080 [0;39m <==    Updates: 0
2023-05-11 23:48:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37647190864302080 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:48:00.228 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647211802267648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:48:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647211802267648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:48:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647211802267648 [0;39m ==> Parameters: 
2023-05-11 23:48:05.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647211802267648 [0;39m <==    Updates: 1
2023-05-11 23:48:05.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647211802267648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:48:21.728 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:26.640 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:29.129 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:31.764 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:35.017 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647337694302208 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:48:35.018 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647337694302208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:48:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647337694302208 [0;39m ==> Parameters: 
2023-05-11 23:48:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647337694302208 [0;39m <==    Updates: 1
2023-05-11 23:48:35.020 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647337694302208 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:48:49.333 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:55.029 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:48:56.631 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:00.002 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37647442488987648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:49:00.003 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647442488987648 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:49:00.005 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647442488987648 [0;39m ==> Parameters: 
2023-05-11 23:49:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647442488987648 [0;39m <==    Updates: 0
2023-05-11 23:49:00.007 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37647442488987648 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-05-11 23:49:00.330 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:05.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647463498256384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:49:05.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647463498256384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:49:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647463498256384 [0;39m ==> Parameters: 
2023-05-11 23:49:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647463498256384 [0;39m <==    Updates: 1
2023-05-11 23:49:05.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647463498256384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:49:11.731 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:14.356 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:26.729 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:29.815 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647589344153600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:49:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647589344153600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:49:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647589344153600 [0;39m ==> Parameters: 
2023-05-11 23:49:35.020 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647589344153600 [0;39m <==    Updates: 1
2023-05-11 23:49:35.021 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647589344153600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-05-11 23:49:37.160 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:39.818 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:56.916 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:49:59.639 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37647694205947904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:50:00.020 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647694205947904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:50:00.021 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647694205947904 [0;39m ==> Parameters: 
2023-05-11 23:50:00.023 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647694205947904 [0;39m <==    Updates: 0
2023-05-11 23:50:00.023 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37647694205947904 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:50:02.359 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647715118747648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:50:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647715118747648 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:50:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647715118747648 [0;39m ==> Parameters: 
2023-05-11 23:50:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647715118747648 [0;39m <==    Updates: 1
2023-05-11 23:50:05.006 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647715118747648 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:50:05.129 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:26.737 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:29.626 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:32.361 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:35.003 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647840952061952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:50:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647840952061952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:50:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647840952061952 [0;39m ==> Parameters: 
2023-05-11 23:50:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647840952061952 [0;39m <==    Updates: 1
2023-05-11 23:50:35.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647840952061952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-05-11 23:50:56.279 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:56.372 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:50:58.856 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37647945818050560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:51:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647945818050560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:51:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647945818050560 [0;39m ==> Parameters: 
2023-05-11 23:51:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37647945818050560 [0;39m <==    Updates: 0
2023-05-11 23:51:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37647945818050560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:51:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37647966797959168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:51:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647966797959168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:51:05.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647966797959168 [0;39m ==> Parameters: 
2023-05-11 23:51:05.015 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37647966797959168 [0;39m <==    Updates: 1
2023-05-11 23:51:05.015 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37647966797959168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:51:20.759 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:24.850 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:26.286 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:28.922 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648092639662080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:51:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648092639662080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:51:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648092639662080 [0;39m ==> Parameters: 
2023-05-11 23:51:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648092639662080 [0;39m <==    Updates: 1
2023-05-11 23:51:35.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648092639662080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:51:44.845 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:46.885 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:56.273 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:51:58.406 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:00.008 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37648197484679168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:52:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648197484679168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:52:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648197484679168 [0;39m ==> Parameters: 
2023-05-11 23:52:00.011 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648197484679168 [0;39m <==    Updates: 0
2023-05-11 23:52:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37648197484679168 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:52:05.006 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648218452004864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:52:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648218452004864 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:52:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648218452004864 [0;39m ==> Parameters: 
2023-05-11 23:52:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648218452004864 [0;39m <==    Updates: 1
2023-05-11 23:52:05.010 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648218452004864 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:52:08.927 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:10.965 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:26.270 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:28.398 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:33.005 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648344276930560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:52:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648344276930560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:52:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648344276930560 [0;39m ==> Parameters: 
2023-05-11 23:52:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648344276930560 [0;39m <==    Updates: 1
2023-05-11 23:52:35.009 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648344276930560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:52:35.037 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:52:56.277 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37648449138724864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:53:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648449138724864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:53:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648449138724864 [0;39m ==> Parameters: 
2023-05-11 23:53:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648449138724864 [0;39m <==    Updates: 0
2023-05-11 23:53:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37648449138724864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:53:00.439 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:05.013 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648470139604992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:53:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648470139604992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:53:05.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648470139604992 [0;39m ==> Parameters: 
2023-05-11 23:53:05.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648470139604992 [0;39m <==    Updates: 1
2023-05-11 23:53:05.018 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648470139604992 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-05-11 23:53:24.521 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:26.281 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:28.594 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:35.015 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648595977113600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:53:35.016 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648595977113600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:53:35.017 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648595977113600 [0;39m ==> Parameters: 
2023-05-11 23:53:35.019 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648595977113600 [0;39m <==    Updates: 1
2023-05-11 23:53:35.019 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648595977113600 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:53:47.531 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:49.566 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:56.266 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:53:58.420 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37648700792770560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:54:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648700792770560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:54:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648700792770560 [0;39m ==> Parameters: 
2023-05-11 23:54:00.010 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648700792770560 [0;39m <==    Updates: 0
2023-05-11 23:54:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37648700792770560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:54:05.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648721760096256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:54:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648721760096256 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:54:05.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648721760096256 [0;39m ==> Parameters: 
2023-05-11 23:54:05.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648721760096256 [0;39m <==    Updates: 1
2023-05-11 23:54:05.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648721760096256 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-05-11 23:54:11.602 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:13.640 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:26.277 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:26.369 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:28.407 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:35.004 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648847585021952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:54:35.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648847585021952 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:54:35.005 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648847585021952 [0;39m ==> Parameters: 
2023-05-11 23:54:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648847585021952 [0;39m <==    Updates: 1
2023-05-11 23:54:35.007 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648847585021952 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:54:35.682 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:37.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:54.329 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:56.274 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:56.363 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:54:58.400 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:00.005 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37648952451010560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:55:00.006 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648952451010560 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:55:00.007 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648952451010560 [0;39m ==> Parameters: 
2023-05-11 23:55:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37648952451010560 [0;39m <==    Updates: 0
2023-05-11 23:55:00.010 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37648952451010560 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š5æ¯«ç§’
2023-05-11 23:55:00.439 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:02.472 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37648973430919168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:55:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648973430919168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:55:05.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648973430919168 [0;39m ==> Parameters: 
2023-05-11 23:55:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37648973430919168 [0;39m <==    Updates: 1
2023-05-11 23:55:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37648973430919168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:55:24.316 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:26.275 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:28.387 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:30.426 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649099251650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:55:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649099251650560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:55:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649099251650560 [0;39m ==> Parameters: 
2023-05-11 23:55:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649099251650560 [0;39m <==    Updates: 1
2023-05-11 23:55:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649099251650560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:55:52.470 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:54.510 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:56.281 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:56.544 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:55:58.578 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37649204142804992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:56:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649204142804992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:56:00.014 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649204142804992 [0;39m ==> Parameters: 
2023-05-11 23:56:00.017 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649204142804992 [0;39m <==    Updates: 0
2023-05-11 23:56:00.017 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37649204142804992 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:56:00.613 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649225089159168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:56:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649225089159168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:56:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649225089159168 [0;39m ==> Parameters: 
2023-05-11 23:56:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649225089159168 [0;39m <==    Updates: 1
2023-05-11 23:56:05.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649225089159168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:56:16.558 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:18.597 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:24.335 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:26.278 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:26.369 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:28.402 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:35.005 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649350909890560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:56:35.006 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649350909890560 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:56:35.007 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649350909890560 [0;39m ==> Parameters: 
2023-05-11 23:56:35.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649350909890560 [0;39m <==    Updates: 1
2023-05-11 23:56:35.008 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649350909890560 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:56:40.639 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:42.673 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:54.331 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:56.275 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:56:58.403 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:00.006 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37649455771684864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:57:00.008 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649455771684864 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:57:00.009 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649455771684864 [0;39m ==> Parameters: 
2023-05-11 23:57:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649455771684864 [0;39m <==    Updates: 0
2023-05-11 23:57:00.013 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37649455771684864 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š6æ¯«ç§’
2023-05-11 23:57:04.715 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:05.007 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649476747399168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:57:05.008 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649476747399168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:57:05.009 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649476747399168 [0;39m ==> Parameters: 
2023-05-11 23:57:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649476747399168 [0;39m <==    Updates: 1
2023-05-11 23:57:05.011 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649476747399168 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:57:06.755 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:24.370 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:26.283 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:26.406 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:28.445 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:30.476 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:32.513 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:35.009 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649602584907776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:57:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649602584907776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:57:35.010 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649602584907776 [0;39m ==> Parameters: 
2023-05-11 23:57:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649602584907776 [0;39m <==    Updates: 1
2023-05-11 23:57:35.012 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649602584907776 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:57:54.334 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:56.280 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:57:58.407 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:00.012 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37649707455090688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:58:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649707455090688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:58:00.013 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649707455090688 [0;39m ==> Parameters: 
2023-05-11 23:58:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649707455090688 [0;39m <==    Updates: 0
2023-05-11 23:58:00.016 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37649707455090688 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:58:00.445 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:05.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649728418222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:58:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649728418222080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:58:05.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649728418222080 [0;39m ==> Parameters: 
2023-05-11 23:58:05.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649728418222080 [0;39m <==    Updates: 1
2023-05-11 23:58:05.013 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649728418222080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:58:22.481 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:24.519 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:26.280 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:26.572 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:30.645 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:35.010 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649854247342080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:58:35.011 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649854247342080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:58:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649854247342080 [0;39m ==> Parameters: 
2023-05-11 23:58:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649854247342080 [0;39m <==    Updates: 1
2023-05-11 23:58:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649854247342080 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:58:46.561 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:48.599 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:56.283 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:56.360 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:58:58.396 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:00.014 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :32   [32m37649959121719296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§å¼€å§‹
2023-05-11 23:59:00.015 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649959121719296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-05-11 23:59:00.016 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649959121719296 [0;39m ==> Parameters: 
2023-05-11 23:59:00.018 DEBUG c.j.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m37649959121719296 [0;39m <==    Updates: 0
2023-05-11 23:59:00.018 INFO  com.jiawa.wiki.job.EbookSnapshotJob               :35   [32m37649959121719296 [0;39m ç”Ÿæˆä»Šæ—¥ç”µå­ä¹¦å¿«ç…§ç»“æŸï¼Œè€—æ—¶ï¼š4æ¯«ç§’
2023-05-11 23:59:05.002 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37649980038713344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:59:05.002 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649980038713344 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:59:05.003 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649980038713344 [0;39m ==> Parameters: 
2023-05-11 23:59:05.004 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37649980038713344 [0;39m <==    Updates: 1
2023-05-11 23:59:05.004 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37649980038713344 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š2æ¯«ç§’
2023-05-11 23:59:10.636 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:12.669 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:26.270 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:26.363 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:28.400 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:34.717 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:35.011 INFO  com.jiawa.wiki.job.DocJob                         :30   [32m37650105909776384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®å¼€å§‹
2023-05-11 23:59:35.012 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37650105909776384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-05-11 23:59:35.013 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37650105909776384 [0;39m ==> Parameters: 
2023-05-11 23:59:35.014 DEBUG c.jiawa.wiki.mapper.DocMapperCust.updateEbookInfo :137  [32m37650105909776384 [0;39m <==    Updates: 1
2023-05-11 23:59:35.014 INFO  com.jiawa.wiki.job.DocJob                         :33   [32m37650105909776384 [0;39m æ›´æ–°ç”µå­ä¹¦ä¸‹çš„æ–‡æ¡£æ•°æ®ç»“æŸï¼Œè€—æ—¶ï¼š3æ¯«ç§’
2023-05-11 23:59:36.756 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:54.327 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:56.288 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:56.363 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
2023-05-11 23:59:58.399 INFO  RocketmqRemoting                                  :95   [32m                  [0;39m closeChannel: close the connection to remote address[] result: true
